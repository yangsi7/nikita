{"at":"2025-12-10T12:57:01.627517","root":".","tree":[".","\u251c\u2500\u2500 docs/","\u2502   \u251c\u2500\u2500 architecture/","\u2502   \u251c\u2500\u2500 decisions/","\u2502   \u251c\u2500\u2500 game/","\u2502   \u251c\u2500\u2500 guides/","\u2502   \u251c\u2500\u2500 screenshots/","\u2502   \u251c\u2500\u2500 verification/","\u2502   \u2514\u2500\u2500 README.md","\u251c\u2500\u2500 docs-to-process/","\u251c\u2500\u2500 memory/","\u2502   \u2514\u2500\u2500 README.md","\u251c\u2500\u2500 nikita/ (116 files)","\u2502   \u251c\u2500\u2500 agents/ (10 files)","\u2502   \u2502   \u251c\u2500\u2500 text/ (8 files)","\u2502   \u2502   \u2514\u2500\u2500 tools/ (1 files)","\u2502   \u251c\u2500\u2500 api/ (16 files)","\u2502   \u2502   \u251c\u2500\u2500 dependencies/ (2 files)","\u2502   \u2502   \u251c\u2500\u2500 middleware/ (1 files)","\u2502   \u2502   \u251c\u2500\u2500 routes/ (5 files)"],"stats":{"total_files":224,"total_directories":149,"fully_parsed":{"python":185,"typescript":31},"listed_only":{"json":7,"css":1},"markdown_files":103},"f":{"nikita/agents/text/__init__.py":["p",["get_memory_client:18:async (user_id:str)>\"NikitaMemory\"::Lazy wrapper for get_memory_client to avoid import-time errors.","get_user_by_id:32:async (user_id:UUID)>\"User | None\"::","get_nikita_agent_for_user:53:async (user_id:UUID)>tuple[Agent[NikitaDeps, str], NikitaDeps]:get_memory_client,get_user_by_id:"],{"UserNotFoundError":["24",["__init__:27:(self, user_id:UUID):__init__:"]]}],"nikita/agents/text/agent.py":["p",["_create_nikita_agent:29:()>Agent[NikitaDeps, str]:note_user_fact,recall_memory:","get_nikita_agent:94:()>Agent[NikitaDeps, str]:_create_nikita_agent:","build_system_prompt:130:async (memory:\"NikitaMemory\", user:\"User\", user_message:str,)>str:_build_system_prompt_legacy:","_build_system_prompt_legacy:173:async (memory:\"NikitaMemory\", user:\"User\", user_message:str,)>str:build_system_prompt:","generate_response:208:async (deps:NikitaDeps, user_message:str,)>str:build_system_prompt:"],{"_AgentProxy":["107",["_real_agent:113:(self)>Agent[NikitaDeps, str]:get_nikita_agent:","__getattr__:118:(self, name:str)::"]]}],"nikita/agents/text/deps.py":["p",{"NikitaDeps":["17",["chapter:37:(self)>int::"]]}],"nikita/agents/text/facts.py":["p",{"ExtractedFact":["15",[]],"FactExtractor":["67",["__init__:85:(self, min_confidence:float = 0.5)::","extract_facts:99:async (self, user_message:str, nikita_response:str, existing_facts:list[str],)>list[ExtractedFact]:_call_llm_for_extraction,_deduplicate_facts:","_call_llm_for_extraction:132:async (self, user_message:str, nikita_response:str, existing_facts:list[str],)>list[ExtractedFact]::","_deduplicate_facts:156:(self, new_facts:list[ExtractedFact], existing_facts:list[str],)>list[ExtractedFact]::"]]}],"nikita/agents/text/handler.py":["p",["_get_nikita_agent_for_user:26:()::Lazy import to avoid triggering pydantic_ai import at module load.","_generate_response:32:()::Lazy import to avoid triggering pydantic_ai import at module load.","get_nikita_agent_for_user:39:async (user_id:UUID):_get_nikita_agent_for_user:Wrapper for lazy import.","generate_response:45:async (deps, message:str):_generate_response:Wrapper for lazy import.","store_pending_response:85:async (user_id:UUID, response:str, scheduled_at:datetime, response_id:UUID,)>None::"],{"ResponseDecision":["54",[]],"MessageHandler":["106",["__init__:135:(self, timer:Optional[ResponseTimer] = None, skip_decision:Optional[SkipDecision] = None, fact_extractor:Optional[FactExtractor] = None,)::","handle:152:async (self, user_id:UUID, message:str)>ResponseDecision:generate_response,get_nikita_agent_for_user,store_pending_response:"]]}],"nikita/agents/text/skip.py":["p",{"SkipDecision":["32",["__init__:53:(self)::Initialize the SkipDecision tracker.","should_skip:57:(self, chapter:int)>bool::","reset:89:(self)>None::Reset the skip tracker state."]]}],"nikita/agents/text/timing.py":["p",{"ResponseTimer":["33",["__init__:49:(self, jitter_factor:float = 0.1)::","calculate_delay:58:(self, chapter:int)>int::","calculate_delay_human_readable:95:(self, chapter:int)>str:calculate_delay:"]]}],"nikita/agents/text/tools.py":["p",["format_memory_results:17:(results:list[dict[str, Any]])>str::","recall_memory:57:async (ctx:RunContext[NikitaDeps], query:str)>str:format_memory_results:","note_user_fact:79:async (ctx:RunContext[NikitaDeps], fact:str, confidence:float)>str::"]],"nikita/api/dependencies/auth.py":["p",["get_current_user_id:19:async (credentials:HTTPAuthorizationCredentials = Depends(security),)>UUID::"]],"nikita/api/main.py":["p",["lifespan:19:async (app:FastAPI)>AsyncGenerator[None, None]::Application lifespan handler with proper DB initialization.","create_app:65:()>FastAPI:health,root:Create and configure the FastAPI application."]],"nikita/api/routes/admin.py":["p",["get_current_admin_user_id:46:async (session:Annotated[AsyncSession, Depends(get_async_session)],)>UUID::","list_users:66:async (admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)], page:int = 1, page_size:int = 50,)::List all users (paginated, admin only).","get_user_detail:100:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get full user detail (admin only).","get_user_metrics:128:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get user metrics (admin only).","get_user_engagement:149:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get user engagement state (admin only).","get_user_vices:183:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get user vice preferences (admin only).","get_user_conversations:206:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)], page:int = 1, page_size:int = 20,)::Get user conversations (admin only).","set_user_score:245:async (user_id:UUID, request:AdminSetScoreRequest, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Set user score (admin only).","set_user_chapter:275:async (user_id:UUID, request:AdminSetChapterRequest, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Set user chapter (admin only).","set_game_status:300:async (user_id:UUID, request:AdminSetGameStatusRequest, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Set game status (admin only).","set_engagement_state:327:async (user_id:UUID, request:AdminSetEngagementStateRequest, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Set engagement state (admin only).","reset_boss_attempts:367:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Reset boss attempts to 0 (admin only).","clear_engagement_history:390:async (user_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Clear engagement history (admin only).","list_prompts:420:async (admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)], page:int = 1, page_size:int = 50, user_id:UUID | None = None, template:str | None = None,)::","get_prompt_detail:440:async (prompt_id:UUID, admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get prompt detail (admin only).","get_system_health:455:async (admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get system health status (admin only).","get_admin_stats:489:async (admin_id:Annotated[UUID, Depends(get_current_admin_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get admin overview statistics."]],"nikita/api/routes/portal.py":["p",["get_user_stats:43:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::","get_user_metrics:90:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get 4 hidden metrics with weights.","get_engagement_state:110:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get engagement state and recent transitions.","get_vice_preferences:144:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get discovered vice preferences.","get_score_history:165:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)], days:int = 30,)::Get score history for charts.","get_daily_summaries:194:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)], limit:int = 30,)::Get daily summaries list.","get_conversations:220:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)], page:int = 1, page_size:int = 20,)::Get paginated conversation list.","get_conversation_detail:253:async (conversation_id:UUID, user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get full conversation detail (read-only).","get_decay_status:288:async (user_id:Annotated[UUID, Depends(get_current_user_id)], session:Annotated[AsyncSession, Depends(get_async_session)],)::Get decay warning and projection."]],"nikita/api/routes/tasks.py":["p",["_get_task_secret:19:()>str | None::Get task authentication secret from settings.","verify_task_secret:27:async (authorization:str | None = Header(None, alias=\"Authorization\"),)>None:_get_task_secret:","apply_daily_decay:54:async (user_repo:UserRepoDep, _:None = Depends(verify_task_secret),)::","deliver_pending_messages:77:async (_:None = Depends(verify_task_secret),)::","generate_daily_summaries:97:async (summary_repo:SummaryRepoDep, _:None = Depends(verify_task_secret),)::","cleanup_expired_registrations:118:async (_:None = Depends(verify_task_secret),)::","process_stale_conversations:148:async (_:None = Depends(verify_task_secret),)::"]],"nikita/api/routes/telegram.py":["p",["_get_bot_from_state:60:(request:Request)>TelegramBot::","get_telegram_auth:87:async (user_repo:UserRepoDep, pending_repo:PendingRegistrationRepoDep,)>TelegramAuth::","get_command_handler:112:async (user_repo:UserRepoDep, telegram_auth:TelegramAuthDep, bot:BotDep,)>CommandHandler::","get_message_handler:136:async (user_repo:UserRepoDep, bot:BotDep,)>MessageHandler::","get_registration_handler:167:async (telegram_auth:TelegramAuthDep, bot:BotDep,)>RegistrationHandler::","create_telegram_router:191:(bot:TelegramBot)>APIRouter:auth_confirm,receive_webhook,set_webhook:"],{"WebhookResponse":["35",[]],"SetWebhookRequest":["41",["validate_https:48:(cls, v:str)>str::Validate that URL uses HTTPS."]]}],"nikita/api/schemas/admin.py":["p",{"AdminUserListItem":["10",[]],"AdminUserDetailResponse":["24",[]],"AdminSetScoreRequest":["40",[]],"AdminSetChapterRequest":["47",[]],"AdminSetGameStatusRequest":["54",[]],"AdminSetEngagementStateRequest":["63",[]],"AdminResetResponse":["72",[]],"GeneratedPromptResponse":["79",[]],"GeneratedPromptsResponse":["92",[]],"AdminHealthResponse":["101",[]],"AdminStatsResponse":["111",[]]}],"nikita/api/schemas/conversation.py":["p",{"MessageRequest":["11",[]],"MessageResponse":["18",[]],"ConversationMessage":["27",[]],"ConversationResponse":["36",[]],"ConversationSummary":["52",[]]}],"nikita/api/schemas/game.py":["p",{"ScoreHistoryResponse":["11",[]],"DailySummaryResponse":["24",[]],"GameStateResponse":["40",[]],"BossEncounterResponse":["62",[]],"VicePreferenceResponse":["73",[]]}],"nikita/api/schemas/portal.py":["p",{"UserMetricsResponse":["10",[]],"UserStatsResponse":["27",[]],"EngagementTransition":["43",[]],"EngagementResponse":["52",[]],"VicePreferenceResponse":["64",[]],"DecayStatusResponse":["73",[]],"ScoreHistoryPoint":["84",[]],"ScoreHistoryResponse":["93",[]],"DailySummaryResponse":["100",[]],"ConversationMessage":["113",[]],"ConversationListItem":["121",[]],"ConversationDetailResponse":["133",[]],"ConversationsResponse":["148",[]],"UserSettingsResponse":["157",[]],"LinkCodeResponse":["165",[]],"SuccessResponse":["173",[]]}],"nikita/api/schemas/user.py":["p",{"UserCreate":["10",[]],"UserResponse":["18",[]],"UserStatsResponse":["32",[]],"ScorePointResponse":["44",[]],"UserMetricsResponse":["51",[]]}],"nikita/config/elevenlabs.py":["p",["get_elevenlabs_config:55:()>ElevenLabsConfig::Get cached ElevenLabs config instance.","get_agent_id:74:(chapter:int = 1, mood:str | None = None, is_boss:bool = False,)>str:get_agents_dict,get_elevenlabs_config:"],{"ElevenLabsConfig":["9",["get_agents_dict:38:(self)>dict[str, str]::Get all agent IDs as a dictionary."]]}],"nikita/config/experiments.py":["p",["deep_merge:35:(base:dict[str, Any], overlay:dict[str, Any])>dict[str, Any]:deep_merge:"],{"ConfigurationError":["29",[]],"ExperimentLoader":["67",["__init__:76:(self, base_path:Path | str | None = None)::","experiment_name:92:(self)>str | None::Get the current experiment name from env var.","load_experiment_config:96:(self)>dict[str, Any]:_load_experiment_with_inheritance:","_get_experiment_path:112:(self, name:str | None = None)>Path::","_load_experiment_with_inheritance:126:(self, name:str, visited:set[str])>dict[str, Any]:_get_experiment_path,_list_available_experiments,_load_experiment_with_inheritance,deep_merge:","_list_available_experiments:176:(self)>list[str]::"]]}],"nikita/config/loader.py":["p",["get_config:172:()>ConfigLoader::"],{"ConfigurationError":["26",[]],"ConfigLoader":["32",["__new__:44:(cls)>\"ConfigLoader\":__new__:Ensure only one instance exists (singleton pattern).","__init__:50:(self)>None:_load_all_configs:Load all YAML configs on first initialization.","_load_yaml:59:(self, filename:str)>dict[str, Any]::Load a YAML file from the config directory.","_load_all_configs:68:(self)>None:_load_yaml:Load and validate all configuration files.","get_chapter:102:(self, chapter_num:int)>ChapterDefinition::","get_boss_threshold:118:(self, chapter_num:int)>Decimal:get_chapter:","get_decay_rate:130:(self, chapter_num:int)>Decimal::","get_grace_period:143:(self, chapter_num:int)>timedelta::","get_daily_cap:157:(self, chapter_num:int)>Decimal::"]]}],"nikita/config/prompt_loader.py":["p",["get_prompt_loader:188:()>PromptLoader::"],{"MissingVariableError":["21",["__init__:24:(self, variable_name:str, template_path:str | None = None):__init__:"]],"PromptLoader":["33",["__init__:46:(self, base_path:Path | str | None = None)::","load:62:(self, path:str | Path)>str:_resolve_path:","render:91:(self, path:str | Path, **kwargs:Any)>str:_substitute_variables,load:","cache_clear:108:(self)>None::Clear all cached prompts.","_resolve_path:112:(self, path:str | Path)>Path::","_substitute_variables:138:(self, content:str, variables:dict[str, Any], template_path:str)>str:_get_nested_value,replace_match:","replace_match:153:(match:re.Match)>str:_get_nested_value:","_get_nested_value:165:(self, var_name:str, variables:dict[str, Any])>Any::"]]}],"nikita/config/schemas.py":["p",{"ScoreRange":["14",["validate_range:21:(self)>\"ScoreRange\"::"]],"GameSettings":["27",[]],"SessionSettings":["37",[]],"GameConfig":["44",[]],"DayRange":["56",["validate_range:63:(self)>\"DayRange\"::"]],"ChapterDefinition":["69",[]],"BossDefinition":["78",[]],"ChaptersConfig":["86",["validate_chapters:93:(self)>\"ChaptersConfig\"::"]],"MetricWeights":["128",["validate_weights_sum:137:(self)>\"MetricWeights\"::"]],"MetricStartingValues":["144",[]],"DeltaRange":["153",[]],"MetricsSettings":["160",[]],"QualityModifier":["168",[]],"EngagementMultipliers":["175",[]],"ScoringConfig":["186",[]],"DecaySchedule":["199",[]],"DecayConfig":["206",["validate_chapters:215:(self)>\"DecayConfig\"::"]],"EngagementStateDefinition":["233",[]],"CalibrationTolerance":["242",[]],"CalibrationSettings":["250",[]],"TransitionRules":["257",[]],"EngagementConfig":["266",["validate_states:275:(self)>\"EngagementConfig\"::"]],"ViceCategoryDefinition":["296",[]],"ViceIntensityLevel":["305",[]],"ViceDiscoverySettings":["312",[]],"VicesConfig":["320",["validate_categories:328:(self)>\"VicesConfig\"::"]],"AvailabilityWindow":["346",[]],"ChapterResponseTiming":["355",[]],"CronSchedules":["363",[]],"ScheduleConfig":["371",[]]}],"nikita/config/settings.py":["p",["get_settings:92:()>Settings::Get cached settings instance."],{"Settings":["10",[]]}],"nikita/context/post_processor.py":["p",["process_conversations:499:async (session:AsyncSession, conversation_ids:list[UUID],)>list[PipelineResult]:process_conversation:"],{"PipelineResult":["35",[]],"ExtractionResult":["52",[]],"PostProcessor":["74",["__init__:90:(self, session:AsyncSession, llm_model:str = \"claude-sonnet-4-5-20250929\",)>None::","_get_extraction_agent:109:(self)>Agent:_get_extraction_system_prompt:Get or create the extraction agent.","_get_extraction_system_prompt:118:(self)>str::Get system prompt for extraction agent."]]}],"nikita/context/session_detector.py":["p",["detect_stale_sessions:132:async (session:AsyncSession, timeout_minutes:int = TEXT_SESSION_TIMEOUT_MINUTES, limit:int = 50,)>list[UUID]:detect_and_queue:"],{"SessionDetector":["24",["__init__:38:(self, session:AsyncSession, timeout_minutes:int = TEXT_SESSION_TIMEOUT_MINUTES,)>None::","get_stale_sessions:52:async (self, limit:int = 50,)>list[UUID]::","mark_for_processing:84:async (self, conversation_id:UUID,)>bool::","detect_and_queue:104:async (self, limit:int = 50,)>list[UUID]:get_stale_sessions,mark_for_processing:"]]}],"nikita/context/template_generator.py":["p",["generate_system_prompt:504:async (session:AsyncSession, user_id:UUID,)>str:generate_prompt:"],{"TemplateContext":["33",[]],"TemplateGenerator":["62",["__init__:69:(self, session:AsyncSession)>None::","generate_prompt:82:async (self, user_id:UUID)>str:generate_system_prompt:","generate_prompt_legacy:110:async (self, user_id:UUID)>str:_layer1_core_identity,_layer2_current_moment,_layer3_relationship_state,_layer4_conversation_history,_layer5_knowledge_inner_life,_layer6_response_guidelines,_load_context,generate_prompt:","_load_context:138:async (self, user_id:UUID)>TemplateContext::","_layer1_core_identity:243:(self)>str::"]]}],"nikita/db/database.py":["p",["get_async_engine:21:()::","get_session_maker:53:()>async_sessionmaker[AsyncSession]:get_async_engine:","get_async_session:67:async ()>AsyncGenerator[AsyncSession, None]:get_session_maker:","_get_supabase_sync_client:84:()::Get cached Supabase sync client (for module-level use).","get_supabase_client:90:async ()>AsyncClient:_get_supabase_sync_client:Get Supabase async client.","get_pool_status:96:()>dict:get_async_engine:"]],"nikita/db/dependencies.py":["p",["get_user_repo:32:async (session:AsyncSessionDep,)>AsyncGenerator[UserRepository, None]::","get_metrics_repo:46:async (session:AsyncSessionDep,)>AsyncGenerator[UserMetricsRepository, None]::","get_conversation_repo:60:async (session:AsyncSessionDep,)>AsyncGenerator[ConversationRepository, None]::","get_score_history_repo:74:async (session:AsyncSessionDep,)>AsyncGenerator[ScoreHistoryRepository, None]::","get_vice_repo:88:async (session:AsyncSessionDep,)>AsyncGenerator[VicePreferenceRepository, None]::","get_summary_repo:102:async (session:AsyncSessionDep,)>AsyncGenerator[DailySummaryRepository, None]::","get_pending_registration_repo:116:async (session:AsyncSessionDep,)>AsyncGenerator[PendingRegistrationRepository, None]::"]],"nikita/db/migrations/env.py":["p",["get_url:36:()>str::Get database URL from settings.","run_migrations_offline:42:()>None:get_url:","do_run_migrations:65:(connection:Connection)>None::Run migrations with given connection.","run_async_migrations:73:async ()>None:get_url:","run_migrations_online:98:()>None:run_async_migrations:Run migrations in 'online' mode."]],"nikita/db/migrations/versions/20251128_0001_initial_schema.py":["p",["upgrade:28:()>None::Create initial schema.","downgrade:300:()>None::Drop all tables in reverse order (AC-T9.7: Reversible)."]],"nikita/db/migrations/versions/20251128_0002_rls_policies.py":["p",["upgrade:25:()>None::Enable RLS and create policies.","downgrade:125:()>None::Drop RLS policies and disable RLS."]],"nikita/db/migrations/versions/20251128_0003_fix_message_embeddings.py":["p",["upgrade:30:()>None::Add user_id column to message_embeddings and backfill from conversations.","downgrade:92:()>None::Remove user_id column from message_embeddings."]],"nikita/db/migrations/versions/20251128_0004_rls_performance.py":["p",["upgrade:27:()>None::Recreate RLS policies with (select auth.uid()) optimization.","downgrade:100:()>None::Restore original RLS policies without optimization."]],"nikita/db/migrations/versions/20251128_0005_consolidate_policies.py":["p",["upgrade:28:()>None::Remove any duplicate policies that may exist.","downgrade:84:()>None::No-op - we don't want to recreate duplicate policies."]],"nikita/db/migrations/versions/20251128_0006_extensions_pending_reg.py":["p",["upgrade:30:()>None::Move extensions and create pending_registrations table.","downgrade:128:()>None::Remove pending_registrations and move extensions back."]],"nikita/db/migrations/versions/20251205_0007_rate_limits_table.py":["p",["upgrade:30:()>None::Create rate_limits table and cleanup function.","downgrade:84:()>None::Remove rate_limits table and cleanup function."]],"nikita/db/models/base.py":["p",["utc_now:45:()>datetime::Get current UTC datetime."],{"Base":["11",[]],"TimestampMixin":["19",[]],"UUIDMixin":["35",[]]}],"nikita/db/models/context.py":["p",{"ConversationThread":["48",[]],"NikitaThought":["110",["is_active:170:(self)>bool::Check if thought is still active (not used, not expired)."]]}],"nikita/db/models/conversation.py":["p",{"Conversation":["30",["add_message:130:(self, role:str, content:str, analysis:dict[str, Any] | None = None,)>None::Add a message to the conversation.","message_count:142:(self)>int::Get total number of messages."]],"MessageEmbedding":["147",[]]}],"nikita/db/models/engagement.py":["p",{"EngagementState":["29",[]],"EngagementHistory":["102",[]]}],"nikita/db/models/game.py":["p",{"ScoreHistory":["19",[]],"DailySummary":["69",["score_change:124:(self)>Decimal | None::Calculate net score change for the day."]]}],"nikita/db/models/generated_prompt.py":["p",{"GeneratedPrompt":["19",[]]}],"nikita/db/models/pending_registration.py":["p",{"PendingRegistration":["16",["is_expired:63:(self)>bool::"]]}],"nikita/db/models/rate_limit.py":["p",{"RateLimit":["13",[]]}],"nikita/db/models/user.py":["p",{"User":["32",[]],"UserMetrics":["151",["calculate_composite_score:194:(self)>Decimal::"]],"UserVicePreference":["208",[]]}],"nikita/db/repositories/base.py":["p",{"BaseRepository":["18",["__init__:37:(self, session:AsyncSession, model_class:type[ModelT])>None::","get_by_telegram_id:32:async (self, telegram_id:int)>User | None::","session:48:(self)>AsyncSession:session:","get:58:async (self, id:UUID)>ModelT | None:get:","create:69:async (self, entity:ModelT)>ModelT::","update:83:async (self, entity:ModelT)>ModelT:create,get,session:","delete:99:async (self, entity:ModelT)>None:delete:","delete_by_id:108:async (self, id:UUID)>bool:delete,get:"]]}],"nikita/db/repositories/conversation_repository.py":["p",{"ConversationRepository":["18",["__init__:25:(self, session:AsyncSession)>None:__init__:Initialize ConversationRepository.","create_conversation:36:async (self, user_id:UUID, platform:str, started_at:datetime | None = None, is_boss_fight:bool = False, chapter_at_time:int | None = None,)>Conversation::","append_message:65:async (self, conversation_id:UUID, role:str, content:str, analysis:dict[str, Any] | None = None,)>Conversation::","get_recent:95:async (self, user_id:UUID, limit:int = 10,)>list[Conversation]::","search:118:async (self, user_id:UUID, query:str,)>list[Conversation]:search:","close_conversation:150:async (self, conversation_id:UUID, score_delta:Decimal | None = None,)>Conversation::","get_stale_active_conversations:183:async (self, timeout_minutes:int = 15, max_attempts:int = 3, limit:int = 50,)>list[Conversation]::","mark_processing:212:async (self, conversation_id:UUID,)>Conversation::","mark_processed:242:async (self, conversation_id:UUID, summary:str | None = None, emotional_tone:str | None = None, extracted_entities:dict[str, Any] | None = None,)>Conversation::","mark_failed:279:async (self, conversation_id:UUID,)>Conversation::","update_last_message_at:305:async (self, conversation_id:UUID,)>Conversation::","get_active_conversation:333:async (self, user_id:UUID,)>Conversation | None::","get_processed_conversations:358:async (self, user_id:UUID, days:int = 7, limit:int = 50,)>list[Conversation]::"]]}],"nikita/db/repositories/engagement_repository.py":["p",{"EngagementStateRepository":["16",["__init__:22:(self, session:AsyncSession)>None:__init__:Initialize EngagementStateRepository.","get_by_user_id:26:async (self, user_id:UUID)>EngagementState | None::","get_recent_transitions:41:async (self, user_id:UUID, limit:int = 10)>list[EngagementHistory]::"]]}],"nikita/db/repositories/generated_prompt_repository.py":["p",{"GeneratedPromptRepository":["14",["__init__:20:(self, session:AsyncSession)>None:__init__:Initialize GeneratedPromptRepository.","create_log:33:async (self, user_id:UUID, prompt_content:str, token_count:int, generation_time_ms:float, meta_prompt_template:str, conversation_id:UUID | None = None, context_snapshot:dict[str, Any] | None = None,)>GeneratedPrompt::","get_by_user_id:66:async (self, user_id:UUID, limit:int = 50)>list[GeneratedPrompt]::","get_by_template:87:async (self, template:str, limit:int = 50)>list[GeneratedPrompt]::"]]}],"nikita/db/repositories/metrics_repository.py":["p",{"UserMetricsRepository":["16",["__init__:22:(self, session:AsyncSession)>None:__init__:Initialize UserMetricsRepository.","get_by_user_id:26:async (self, user_id:UUID)>UserMetrics | None::","update_metrics:46:async (self, user_id:UUID, intimacy_delta:Decimal = Decimal(\"0\"), passion_delta:Decimal = Decimal(\"0\"), trust_delta:Decimal = Decimal(\"0\"), secureness_delta:Decimal = Decimal(\"0\"),)>UserMetrics:_clamp,get_by_user_id:","calculate_composite:77:async (self, user_id:UUID)>Decimal:get_by_user_id:","_clamp:96:(value:Decimal)>Decimal::Clamp value between 0 and 100."]]}],"nikita/db/repositories/pending_registration_repository.py":["p",{"PendingRegistrationRepository":["17",["__init__:29:(self, session:AsyncSession)>None::","session:38:(self)>AsyncSession::Access the database session.","store:47:async (self, telegram_id:int, email:str, expires_at:datetime | None = None,)>PendingRegistration::","get:84:async (self, telegram_id:int)>PendingRegistration | None::","get_email:102:async (self, telegram_id:int)>str | None:get:","delete:116:async (self, telegram_id:int)>bool:delete:","cleanup_expired:131:async (self)>int:delete:"]]}],"nikita/db/repositories/score_history_repository.py":["p",{"ScoreHistoryRepository":["18",["__init__:24:(self, session:AsyncSession)>None:__init__:Initialize ScoreHistoryRepository.","log_event:35:async (self, user_id:UUID, score:Decimal, chapter:int, event_type:str | None = None, event_details:dict[str, Any] | None = None,)>ScoreHistory::","get_history:63:async (self, user_id:UUID, limit:int = 50,)>list[ScoreHistory]::","get_daily_stats:86:async (self, user_id:UUID, target_date:date,)>dict[str, Any]::","get_events_by_type:140:async (self, user_id:UUID, event_type:str, limit:int = 50,)>list[ScoreHistory]::"]]}],"nikita/db/repositories/summary_repository.py":["p",{"DailySummaryRepository":["18",["__init__:24:(self, session:AsyncSession)>None:__init__:Initialize DailySummaryRepository.","create_summary:43:async (self, user_id:UUID, summary_date:date, score_start:Decimal | None = None, score_end:Decimal | None = None, decay_applied:Decimal | None = None, conversations_count:int = 0, nikita_summary_text:str | None = None, key_events:list[dict[str, Any]] | None = None, # Context engineering fields (spec 012) summary_text:str | None = None, key_moments:list[dict[str, Any]] | None = None, emotional_tone:str | None = None, engagement_score:Decimal | None = None,)>DailySummary::","get_by_date:85:async (self, user_id:UUID, summary_date:date,)>DailySummary | None::","get_range:108:async (self, user_id:UUID, start_date:date, end_date:date,)>list[DailySummary]::","update_summary:140:async (self, summary_id:UUID, score_end:Decimal | None = None, nikita_summary_text:str | None = None, key_events:list[dict[str, Any]] | None = None, # Context engineering fields (spec 012) summary_text:str | None = None, key_moments:list[dict[str, Any]] | None = None, emotional_tone:str | None = None, engagement_score:Decimal | None = None,)>DailySummary::","get_for_date:189:async (self, user_id:UUID, summary_date:date,)>DailySummary | None:get_by_date:","get_recent:205:async (self, user_id:UUID, limit:int = 7,)>list[DailySummary]::"]]}],"nikita/db/repositories/thought_repository.py":["p",{"NikitaThoughtRepository":["21",["__init__:28:(self, session:AsyncSession)>None:__init__:Initialize NikitaThoughtRepository.","create_thought:39:async (self, user_id:UUID, thought_type:str, content:str, source_conversation_id:UUID | None = None, expires_at:datetime | None = None,)>NikitaThought::","get_active_thoughts:73:async (self, user_id:UUID, thought_type:str | None = None, limit:int = 10,)>list[NikitaThought]::","get_thoughts_for_prompt:109:async (self, user_id:UUID, max_per_type:int = 3,)>dict[str, list[NikitaThought]]:get_active_thoughts:","mark_thought_used:135:async (self, thought_id:UUID,)>NikitaThought::","create_missing_him_thought:163:async (self, user_id:UUID, hours_since_last_message:float, source_conversation_id:UUID | None = None,)>NikitaThought | None:create_thought:","bulk_create_thoughts:206:async (self, user_id:UUID, thoughts_data:list[dict], source_conversation_id:UUID | None = None,)>list[NikitaThought]:create_thought:","expire_missing_him_thoughts:235:async (self, user_id:UUID,)>int:get_active_thoughts:","cleanup_expired_thoughts:262:async (self, user_id:UUID,)>int::"]]}],"nikita/db/repositories/thread_repository.py":["p",{"ConversationThreadRepository":["20",["__init__:27:(self, session:AsyncSession)>None:__init__:Initialize ConversationThreadRepository.","create_thread:37:async (self, user_id:UUID, thread_type:str, content:str, source_conversation_id:UUID | None = None,)>ConversationThread::","get_open_threads:70:async (self, user_id:UUID, thread_type:str | None = None, limit:int = 20,)>list[ConversationThread]::","get_threads_for_prompt:99:async (self, user_id:UUID, max_per_type:int = 5,)>dict[str, list[ConversationThread]]:get_open_threads:","resolve_thread:125:async (self, thread_id:UUID,)>ConversationThread::","expire_thread:152:async (self, thread_id:UUID,)>ConversationThread::","bulk_create_threads:181:async (self, user_id:UUID, threads_data:list[dict], source_conversation_id:UUID | None = None,)>list[ConversationThread]:create_thread:","bulk_resolve_threads:208:async (self, thread_ids:list[UUID],)>int:resolve_thread:"]]}],"nikita/db/repositories/user_repository.py":["p",{"UserRepository":["21",["__init__:30:(self, session:AsyncSession)>None:__init__:","get:38:async (self, user_id:UUID)>User | None::","get_by_telegram_id:55:async (self, telegram_id:int)>User | None::","create_with_metrics:77:async (self, user_id:UUID, telegram_id:int | None = None, phone:str | None = None,)>User::","update_score:126:async (self, user_id:UUID, delta:Decimal, event_type:str | None = None, event_details:dict[str, Any] | None = None,)>User:get:","apply_decay:171:async (self, user_id:UUID, decay_amount:Decimal,)>User:update_score:","advance_chapter:188:async (self, user_id:UUID)>User:get:","update_last_interaction:237:async (self, user_id:UUID, timestamp:datetime | None = None,)>User:get:","get_active_users_for_decay:265:async (self)>list[User]::","update_game_status:286:async (self, user_id:UUID, status:str,)>User:get:"]]}],"nikita/db/repositories/vice_repository.py":["p",{"VicePreferenceRepository":["17",["__init__:23:(self, session:AsyncSession)>None:__init__:Initialize VicePreferenceRepository.","get_active:27:async (self, user_id:UUID)>list[UserVicePreference]::","get_by_category:48:async (self, user_id:UUID, category:str,)>UserVicePreference | None::","update_intensity:70:async (self, preference_id:UUID, delta:int,)>UserVicePreference::","discover:101:async (self, user_id:UUID, category:str, initial_intensity:int = 1,)>UserVicePreference:get_by_category:","update_engagement:131:async (self, preference_id:UUID, delta:Decimal,)>UserVicePreference::"]]}],"nikita/db/transactions.py":["p",["is_deadlock_error:40:(error:Exception)>bool::","atomic:67:(isolation_level:IsolationLevel = DEFAULT_ISOLATION_LEVEL, max_retries:int = DEFAULT_MAX_RETRIES, base_delay:float = DEFAULT_BASE_DELAY,)>Callable[[Callable[P, T]], Callable[P, T]]:atomic,decorator,is_deadlock_error,transfer_funds,wrapper:","run_in_transaction:162:async (session:AsyncSession, func:Callable[..., Any], *args:Any, isolation_level:IsolationLevel = DEFAULT_ISOLATION_LEVEL, **kwargs:Any,)>Any:_wrapped,atomic:"]],"nikita/engine/constants.py":["p",["_load_chapter_behaviors:44:()>dict[int, str]::Load chapter behaviors from prompt files.","_get_chapter_behaviors:68:()>dict[int, str]:_load_chapter_behaviors:","_deprecation_warning:108:(name:str, alternative:str)>None::Emit deprecation warning for old constants."],{"_ChapterBehaviorsProxy":["74",["__getitem__:77:(self, key:int)>str:_load_chapter_behaviors:","__iter__:80:(self):_load_chapter_behaviors:","__len__:83:(self):_load_chapter_behaviors:","get:86:(self, key:int, default:str | None = None)>str | None:_load_chapter_behaviors,get:","keys:90:(self):_load_chapter_behaviors,keys:","values:93:(self):_load_chapter_behaviors,values:","items:96:(self):_load_chapter_behaviors,items:"]]}],"nikita/engine/decay/calculator.py":["p",{"UserLike":["18",[]],"DecayCalculator":["28",["__init__:45:(self, *, max_decay_per_cycle:Decimal = Decimal(\"20.0\"),)>None::","is_overdue:54:(self, user:UserLike)>bool::","calculate_decay:74:(self, user:UserLike)>DecayResult | None:is_overdue:"]]}],"nikita/engine/decay/models.py":["p",{"DecayResult":["14",["validate_score_relationship:57:(self)>\"DecayResult\"::Validate that score_after <= score_before (decay doesn't increase score)."]]}],"nikita/engine/decay/processor.py":["p",{"DecayProcessor":["24",["__init__:44:(self, session:AsyncSession, user_repository:\"UserRepository\", score_history_repository:\"ScoreHistoryRepository\", *, batch_size:int = 100, max_decay_per_cycle:Decimal = Decimal(\"20.0\"),)>None::","should_skip_user:60:(self, user:Any)>bool::","process_user:73:async (self, user:Any)>DecayResult | None:_handle_game_over,_log_decay_event,should_skip_user:","process_all:103:async (self)>dict[str, int]:process_user:","_handle_game_over:131:async (self, user:Any, result:DecayResult)>None::","_log_decay_event:155:async (self, user:Any, result:DecayResult)>None::"]]}],"nikita/engine/engagement/calculator.py":["p",["_clamp:73:(value:Decimal, min_val:Decimal = Decimal(\"0\"), max_val:Decimal = Decimal(\"1\"))>Decimal::Clamp a value between min and max.","map_score_to_state:306:(score:Decimal, is_clingy:bool = False, is_neglecting:bool = False,)>EngagementState::"],{"OptimalFrequencyCalculator":["78",["get_optimal:85:(self, chapter:int, day_of_week:int)>int::","get_tolerance_band:101:(self, chapter:int)>Decimal::","get_bounds:112:(self, chapter:int, day_of_week:int)>tuple[int, int]:get_optimal,get_tolerance_band:"]],"CalibrationCalculator":["131",["_frequency_component:146:(self, actual_messages:int, optimal_messages:int,)>Decimal:_clamp:","_timing_component:171:(self, avg_response_seconds:int,)>Decimal:_clamp:","_content_component:210:(self, avg_message_length:int, needy_score:Decimal, distracted_score:Decimal,)>Decimal:_clamp:","compute:252:(self, actual_messages:int, optimal_messages:int, avg_response_seconds:int, avg_message_length:int, needy_score:Decimal, distracted_score:Decimal,)>CalibrationResult:_clamp,_content_component,_frequency_component,_timing_component,map_score_to_state:"]]}],"nikita/engine/engagement/detection.py":["p",["_clamp:48:(value:Decimal, min_val:Decimal = Decimal(\"0\"), max_val:Decimal = Decimal(\"1\"))>Decimal::Clamp a value between min and max.","_get_cache_key:384:(messages:list[str])>str::Generate cache key from messages.","_call_neediness_llm:389:async (messages:list[str])>Decimal::","_call_distraction_llm:402:async (messages:list[str])>Decimal::","analyze_neediness:414:async (messages:list[str], session_id:str | None = None,)>Decimal:_call_neediness_llm,_clamp,_get_cache_key:","analyze_distraction:455:async (messages:list[str], session_id:str | None = None,)>Decimal:_call_distraction_llm,_clamp,_get_cache_key:","clear_analysis_cache:493:()>None::"],{"ClinginessDetector":["53",["_frequency_signal:71:(self, messages_per_day:int, optimal_frequency:int, chapter:int,)>Decimal:_clamp:","_double_text_signal:99:(self, consecutive_messages:int, total_exchanges:int,)>Decimal:_clamp:","_response_time_signal:122:(self, avg_response_seconds:int,)>Decimal:_clamp:","_length_ratio_signal:147:(self, user_avg_length:int, nikita_avg_length:int,)>Decimal:_clamp:","detect:180:(self, messages_per_day:int, optimal_frequency:int, chapter:int, consecutive_messages:int, total_exchanges:int, avg_response_seconds:int, user_avg_length:int, nikita_avg_length:int, needy_score:Decimal,)>ClinginessResult:_clamp,_double_text_signal,_frequency_signal,_length_ratio_signal,_response_time_signal:"]],"NeglectDetector":["223",["_frequency_signal:241:(self, messages_per_day:int, optimal_frequency:int, chapter:int,)>Decimal:_clamp:","_response_time_signal:265:(self, avg_response_seconds:int,)>Decimal:_clamp:","_short_message_signal:287:(self, avg_message_length:int,)>Decimal:_clamp:","_abrupt_ending_signal:312:(self, abrupt_endings:int, total_conversations:int,)>Decimal:_clamp:","detect:336:(self, messages_per_day:int, optimal_frequency:int, chapter:int, avg_response_seconds:int, avg_message_length:int, abrupt_endings:int, total_conversations:int, distracted_score:Decimal,)>NeglectResult:_abrupt_ending_signal,_clamp,_frequency_signal,_response_time_signal,_short_message_signal:"]]}],"nikita/engine/engagement/models.py":["p",{"EngagementSnapshot":["15",["multiplier:49:(self)>Decimal::Get the scoring multiplier for current state."]],"ClinginessResult":["56",[]],"NeglectResult":["79",[]],"CalibrationResult":["102",[]],"StateTransition":["135",[]]}],"nikita/engine/engagement/recovery.py":["p",{"RecoveryAction":["48",[]],"RecoveryCheckResult":["56",[]],"GameOverResult":["64",[]],"RecoveryManager":["93",["get_recovery_action:102:(self, state:EngagementState)>RecoveryAction | None::","check_recovery_complete:123:(self, state:EngagementState, recovery_started_at:datetime, messages_since_recovery:int, avg_message_length:int = 0,)>RecoveryCheckResult:_check_clingy_recovery,_check_distant_recovery,_check_out_of_zone_recovery:","_check_clingy_recovery:173:(self, messages:int)>RecoveryCheckResult::Check if clingy recovery is complete (gave space).","_check_distant_recovery:185:(self, messages:int, avg_length:int)>RecoveryCheckResult::Check if distant recovery is complete (engaged meaningfully).","_check_out_of_zone_recovery:202:(self, messages:int, avg_length:int)>RecoveryCheckResult::Check if out of zone recovery is complete.","check_point_of_no_return:224:(self, state:EngagementState, consecutive_days:int,)>GameOverResult:_get_game_over_reason:","_get_game_over_reason:260:(self, state:EngagementState)>str::Get game over reason string for state."]]}],"nikita/engine/engagement/state_machine.py":["p",{"EngagementStateMachine":["54",["__init__:64:(self, initial_state:EngagementState = EngagementState.CALIBRATING,)>None::","current_state:83:(self)>EngagementState::Get current engagement state.","current_multiplier:88:(self)>Decimal::Get scoring multiplier for current state.","update:99:(self, calibration_result:CalibrationResult, is_clingy:bool = False, is_neglecting:bool = False, is_new_day:bool = False, recovery_complete:bool = False,)>StateTransition | None:_apply_transition,_evaluate_transition,_update_counters:","_update_counters:134:(self, score:Decimal, is_clingy:bool, is_neglecting:bool, is_new_day:bool,)>None::Update consecutive counters based on current metrics.","_evaluate_transition:177:(self, score:Decimal, is_clingy:bool, is_neglecting:bool, recovery_complete:bool,)>EngagementState::Evaluate which state to transition to based on rules.","_apply_transition:233:(self, from_state:EngagementState, to_state:EngagementState, score:Decimal,)>StateTransition:_get_transition_reason,_reset_counters:Apply state transition and record in history.","_get_transition_reason:257:(self, from_state:EngagementState, to_state:EngagementState,)>str::Get human-readable reason for transition.","_reset_counters:288:(self)>None::Reset all consecutive counters.","on_chapter_change:298:(self, new_chapter:int)>StateTransition:_reset_counters:","get_history:323:(self)>list[StateTransition]::"]]}],"nikita/engine/scoring/analyzer.py":["p",["_create_score_analyzer_agent:57:()>Agent[None, ResponseAnalysis]::Create the score analyzer agent."],{"ScoreAnalyzer":["66",["__init__:73:(self)::Initialize the score analyzer.","agent:79:(self)>Agent[None, ResponseAnalysis]:_create_score_analyzer_agent:Lazy-load the Pydantic AI agent.","analyze:90:async (self, user_message:str, nikita_response:str, context:ConversationContext,)>ResponseAnalysis:_call_llm,_neutral_analysis:","analyze_batch:114:async (self, exchanges:list[tuple[str, str]], context:ConversationContext,)>ResponseAnalysis:_build_batch_prompt,_call_llm_raw,_neutral_analysis:","_call_llm:145:async (self, user_message:str, nikita_response:str, context:ConversationContext,)>ResponseAnalysis | None:_build_analysis_prompt,_call_llm_raw:","_call_llm_raw:159:async (self, prompt:str)>ResponseAnalysis | None::","_build_analysis_prompt:180:(self, user_message:str, nikita_response:str, context:ConversationContext,)>str::"]]}],"nikita/engine/scoring/calculator.py":["p",{"ScoreResult":["33",["delta:49:(self)>Decimal::Net score change."]],"ScoreCalculator":["54",["__init__:64:(self)::Initialize calculator with standard weights.","apply_multiplier:72:(self, deltas:MetricDeltas, engagement_state:EngagementState,)>MetricDeltas:adjust:","adjust:87:(delta:Decimal)>Decimal::","calculate_composite:99:(self, metrics:dict[str, Decimal])>Decimal::","update_metrics:123:(self, current:dict[str, Decimal], deltas:MetricDeltas,)>dict[str, Decimal]:clamp:","clamp:134:(value:Decimal)>Decimal::","calculate:150:(self, current_metrics:dict[str, Decimal], analysis:ResponseAnalysis, engagement_state:EngagementState, chapter:int,)>ScoreResult:_detect_events,apply_multiplier,calculate_composite,update_metrics:","_detect_events:194:(self, score_before:Decimal, score_after:Decimal, chapter:int,)>list[ScoreChangeEvent]::"]]}],"nikita/engine/scoring/models.py":["p",{"MetricDeltas":["16",["validate_delta_bounds:42:(cls, v:Decimal, info)>Decimal::Ensure delta is within [-10, +10] bounds.","total:51:(self)>Decimal::Sum of all deltas.","is_positive:56:(self)>bool::Whether total delta is positive (> 0)."]],"ResponseAnalysis":["61",["validate_confidence_bounds:88:(cls, v:Decimal)>Decimal::Ensure confidence is within [0, 1] bounds."]],"ConversationContext":["97",[]],"ScoreChangeEvent":["141",[]]}],"nikita/engine/scoring/service.py":["p",{"ScoringService":["37",["__init__:47:(self)::Initialize the scoring service with analyzer and calculator.","score_interaction:61:async (self, user_id:UUID, user_message:str, nikita_response:str, context:ConversationContext, current_metrics:dict[str, Decimal], engagement_state:EngagementState, session:\"AsyncSession | None\" = None,)>ScoreResult:_log_history:","score_batch:117:async (self, user_id:UUID, exchanges:list[tuple[str, str]], context:ConversationContext, current_metrics:dict[str, Decimal], engagement_state:EngagementState, session:\"AsyncSession | None\" = None,)>ScoreResult:_log_history:","analyze_only:162:async (self, user_message:str, nikita_response:str, context:ConversationContext,)>ResponseAnalysis::","_log_history:191:async (self, user_id:UUID, result:ScoreResult, context:ConversationContext, session:\"AsyncSession\", event_type:str = \"conversation\",)>None::"]]}],"nikita/memory/graphiti_client.py":["p",["get_memory_client:289:async (user_id:str)>NikitaMemory:initialize:"],{"NikitaMemory":["25",["__init__:35:(self, user_id:str)::","initialize:62:async (self)>None::","_get_group_id:79:(self, graph_type:str)>str::Get the group ID for a specific graph type.","add_episode:89:async (self, content:str, source:str, graph_type:str = \"relationship\", metadata:dict[str, Any] | None = None,)>None:_get_group_id,add_episode:","search_memory:117:async (self, query:str, graph_types:list[str] | None = None, limit:int = 10,)>list[dict[str, Any]]:_get_group_id:","get_context_for_prompt:155:async (self, user_message:str, max_memories:int = 5,)>str:search_memory:","add_user_fact:202:async (self, fact:str, confidence:float = 0.8, source_message:str | None = None,)>None:add_episode:","get_user_facts:222:async (self, limit:int = 50)>list[str]:_get_group_id:","add_relationship_episode:254:async (self, description:str, episode_type:str = \"general\",)>None:add_episode:","add_nikita_event:273:async (self, description:str, event_type:str = \"life_event\",)>None:add_episode:"]]}],"nikita/meta_prompts/models.py":["p",{"ViceProfile":["14",["get_top_vices:41:(self, n:int = 3)>list[tuple[str, int]]::","to_dict:64:(self)>dict[str, int]::Convert to dictionary."]],"MetaPromptContext":["79",["get_score_interpretation:133:(self)>str::Interpret the relationship score.","get_chapter_behavior_summary:147:(self)>str::Get a brief description of expected chapter behavior."]],"GeneratedPrompt":["160",["__post_init__:179:(self)::Calculate token count estimate."]]}],"nikita/meta_prompts/service.py":["p",{"MetaPromptService":["28",["__init__:39:(self, session:\"AsyncSession\"):_load_templates:","_load_templates:58:(self)>None::Load all meta-prompt templates from disk.","_count_tokens:72:(self, text:str)>int::","_log_prompt:94:async (self, user_id:UUID, prompt_content:str, generation_time_ms:float, meta_prompt_template:str, conversation_id:UUID | None = None, context_snapshot:dict[str, Any] | None = None,)>None:_count_tokens:","_load_context:118:async (self, user_id:UUID)>MetaPromptContext:_compute_nikita_activity,_compute_nikita_energy,_compute_nikita_mood,_get_chapter_name:","_compute_nikita_activity:207:(self, time_of_day:str, day_of_week:str)>str::Compute what Nikita is likely doing based on time.","_compute_nikita_mood:226:(self, chapter:int, hours_since:float)>str::Compute Nikita's mood based on chapter and time since contact.","_compute_nikita_energy:251:(self, time_of_day:str)>str::Compute energy level based on time of day.","_get_chapter_name:262:(self, chapter:int)>str::Get the name of a chapter.","_format_template:273:(self, template_name:str, context:MetaPromptContext)>str::","generate_system_prompt:344:async (self, user_id:UUID, context:MetaPromptContext | None = None, conversation_id:UUID | None = None,)>GeneratedPrompt:_format_template,_load_context,_log_prompt:","detect_vices:397:async (self, user_message:str, recent_context:list[str], current_profile:ViceProfile,)>dict::","extract_entities:435:async (self, conversation:str, user_id:UUID, context:MetaPromptContext | None = None,)>dict:_load_context:","simulate_thoughts:478:async (self, user_id:UUID, context:MetaPromptContext | None = None,)>dict:_load_context:"]]}],"nikita/platforms/telegram/auth.py":["p",{"TelegramAuth":["21",["__init__:36:(self, supabase_client:AsyncClient, user_repository:UserRepository, pending_registration_repository:PendingRegistrationRepository,)::","register_user:53:async (self, telegram_id:int, email:str, registration_source:str = \"telegram\", # \"telegram\" or \"portal\")>dict[str, Any]::","verify_magic_link:128:async (self, telegram_id:int, otp_token:str,)>Any:register_user:","link_telegram:186:async (self, user_id:UUID, telegram_id:int,)>None::","get_pending_email:212:async (self, telegram_id:int)>str | None::"]]}],"nikita/platforms/telegram/bot.py":["p",["escape_html:14:(text:str)>str::"],{"TelegramBot":["34",["__init__:37:(self)::Initialize bot with settings and HTTP client.","send_message:53:async (self, chat_id:int, text:str, parse_mode:str = \"HTML\", escape:bool = True,)>dict:escape_html:","send_chat_action:99:async (self, chat_id:int, action:str = \"typing\",)>dict::","set_webhook:130:async (self, url:str, secret_token:str | None = None)>dict::","close:166:async (self)::Close the HTTP client connection."]]}],"nikita/platforms/telegram/commands.py":["p",{"CommandHandler":["15",["__init__:35:(self, user_repository:UserRepository, telegram_auth:TelegramAuth, bot:TelegramBot,)::","handle:47:async (self, message:dict)>None::","_handle_start:68:async (self, message:dict)>None::","_handle_help:101:async (self, message:dict)>None::","_handle_status:122:async (self, message:dict)>None:_get_chapter_name,_get_score_hint:","_handle_call:155:async (self, message:dict)>None::","_handle_unknown:171:async (self, message:dict)>None::","_get_chapter_name:190:(chapter:int)>str::","_get_score_hint:209:(score:float)>str::"]]}],"nikita/platforms/telegram/delivery.py":["p",{"ResponseDelivery":["15",["__init__:28:(self, bot:TelegramBot)::","queue:42:async (self, user_id:UUID, chat_id:int, response:str, delay_seconds:int,)>None:_send_now,_wait_with_typing:","_wait_with_typing:65:async (self, chat_id:int, delay_seconds:int)>None::","_send_now:84:async (self, chat_id:int, response:str)>None:_split_message:","_split_message:108:(self, text:str)>list[str]::"]]}],"nikita/platforms/telegram/message_handler.py":["p",{"MessageHandler":["21",["__init__:35:(self, user_repository:UserRepository, text_agent_handler:TextAgentMessageHandler, response_delivery:ResponseDelivery, bot:TelegramBot, rate_limiter:Optional[RateLimiter] = None,)::","handle:51:async (self, message:TelegramMessage)>None:_send_error_response,_send_rate_limit_response,handle:","_send_rate_limit_response:130:async (self, chat_id:int, result)>None::","_send_error_response:152:async (self, chat_id:int)>None::"]]}],"nikita/platforms/telegram/models.py":["p",{"TelegramUser":["10",[]],"TelegramChat":["23",[]],"TelegramMessage":["32",[]],"TelegramUpdate":["51",[]]}],"nikita/platforms/telegram/rate_limiter.py":["p",["get_shared_cache:74:()>InMemoryCache::Get shared InMemoryCache instance (singleton)."],{"InMemoryCache":["28",["__init__:36:(self)::","incr:41:async (self, key:str)>int:_cleanup_expired,get:Increment counter and return new value.","expire:48:async (self, key:str, seconds:int)>None::Set expiration time for a key.","get:53:async (self, key:str)>int:_cleanup_expired,get:Get current value (returns 0 if not exists or expired).","_cleanup_expired:59:(self)>None::Remove expired keys (called within lock)."]],"RateLimitResult":["83",[]],"RateLimiter":["104",["__init__:120:(self, cache:Any):expire,get,incr:","check:129:async (self, user_id:UUID)>RateLimitResult:_get_day_key,_get_minute_key,_seconds_until_midnight,expire,incr:","get_remaining:193:async (self, user_id:UUID)>dict:_get_day_key,_get_minute_key,get:","_get_minute_key:221:(self, user_id:UUID)>str::Generate cache key for per-minute limit.","_get_day_key:225:(self, user_id:UUID)>str::Generate cache key for per-day limit.","_seconds_until_midnight:230:(self)>int::Calculate seconds until midnight UTC (when daily limit resets)."]],"DatabaseRateLimiter":["243",["__init__:260:(self, session:\"AsyncSession\")::","check:269:async (self, user_id:UUID)>RateLimitResult:_get_day_window,_get_minute_window,_seconds_until_midnight:","get_remaining:371:async (self, user_id:UUID)>dict:_get_day_window,_get_minute_window:","_get_minute_window:415:(self)>str::","_get_day_window:424:(self)>str::","_seconds_until_midnight:433:(self)>int::Calculate seconds until midnight UTC (when daily limit resets)."]]}],"nikita/platforms/telegram/registration_handler.py":["p",{"RegistrationHandler":["13",["__init__:27:(self, telegram_auth:TelegramAuth, bot:TelegramBot,)::","handle_email_input:42:async (self, telegram_id:int, chat_id:int, email:str,)>None:is_valid_email:","is_valid_email:109:(self, text:str)>bool::"]]}],"nikita/prompts/nikita_persona.py":["p",["get_nikita_persona:155:()>str::"]],"portal/sr/app/auth/callback/route.ts":["t",["GET:19:async (request:NextRequest)::"]],"portal/sr/app/conversations/page.tsx":["t",["ConversationsPage:13:()::","handleLogout:20:async ()::"]],"portal/sr/app/dashboard/page.tsx":["t",["DashboardPage:16:()::","handleLogout:22:async ()::"]],"portal/sr/app/history/page.tsx":["t",["HistoryPage:14:()::","handleLogout:31:async ()::"]],"portal/sr/app/layout.tsx":["t",["RootLayout:21:({ children, }:Readonly<{ children:React.ReactNode }>)::"]],"portal/sr/app/page.tsx":["t",["LoginForm:17:()::","LoginPage:211:()::","exchangeCode:31:async ()::","validateEmail:79:(email:string):boolean::","handleSubmit:85:async (e:React.FormEvent):validateEmail:"]],"portal/sr/app/providers.tsx":["t",["Providers:6:({ children }:{ children:ReactNode })::"]],"portal/sr/components/dashboard/ChapterCard.tsx":["t",["ChapterCard:28:({ chapter, bossAttempts, gameStatus, relationshipScore, }:ChapterCardProps):getStatusBadge:","getStatusBadge:52:()::"]],"portal/sr/components/dashboard/DecayWarning.tsx":["t",["DecayWarning:20:({ hoursSinceLastInteraction, nextDecayIn, decayRate, chapter, }:DecayWarningProps):getMessage,getSeverity,getStyles:","getSeverity:27:():'info' | 'warning' | 'critical'::","getMessage:36:():string::","getStyles:58:()::"]],"portal/sr/components/dashboard/EngagementCard.tsx":["t",["EngagementCard:68:({ state, multiplier, consecutiveInZone, consecutiveClingyDays, consecutiveDistantDays, }:EngagementCardProps):getAdvice:","getAdvice:78:():string::"]],"portal/sr/components/dashboard/MetricsGrid.tsx":["t",["MetricItem:21:({ name, value, weight, description }:MetricItemProps):getColor,getProgressColor:","MetricsGrid:55:({ chapter, metrics }:MetricsGridProps)::","getColor:23:(val:number):string::","getProgressColor:29:(val:number):string::"]],"portal/sr/components/dashboard/ScoreCard.tsx":["t",["ScoreCard:10:({ score, previousScore, chapter }:ScoreCardProps):getBadgeVariant,getScoreColor,getStrokeColor:","getScoreColor:22:(score:number):string::","getStrokeColor:29:(score:number):string::","getBadgeVariant:36:()::"]],"portal/sr/components/dashboard/VicesCard.tsx":["t",["ViceItem:78:({ vice }:{ vice:Vice })::","VicesCard:102:({ vices }:VicesCardProps)::"]],"portal/sr/components/history/ConversationDetail.tsx":["t",["ConversationDetail:9:({ conversation }:ConversationDetailProps)::"]],"portal/sr/components/history/ConversationList.tsx":["t",["ConversationItem:10:({ conversation, onClick, }:{ conversation:Conversation onClick?:()::","ConversationList:69:({ conversations, onSelectConversation }:ConversationListProps)::"]],"portal/sr/components/history/DailySummaryCard.tsx":["t",["DailySummaryCard:31:({ summary }:DailySummaryCardProps)::"]],"portal/sr/components/history/ScoreHistoryGraph.tsx":["t",["CustomTooltip:34:({ active, payload }:CustomTooltipProps)::","ScoreHistoryGraph:51:({ history, currentChapter }:ScoreHistoryGraphProps)::"]],"portal/sr/components/layout/Navigation.tsx":["t",["Navigation:13:()::"]],"portal/sr/components/ui/badge.tsx":["t",["Badge:26:({ className, variant, asChild = false, ...props }:React.ComponentProps<'span'> & VariantProps<typeof badgeVariants> & { asChild?:boolean })::"]],"portal/sr/components/ui/button.tsx":["t",["Button:37:({ className, variant, size, asChild = false, ...props }:React.ComponentProps<'button'> & VariantProps<typeof buttonVariants> & { asChild?:boolean })::"]],"portal/sr/components/ui/card.tsx":["t",["Card:5:({ className, ...props }:React.ComponentProps<'div'>)::","CardHeader:18:({ className, ...props }:React.ComponentProps<'div'>)::","CardTitle:31:({ className, ...props }:React.ComponentProps<'div'>)::","CardDescription:41:({ className, ...props }:React.ComponentProps<'div'>)::","CardAction:51:({ className, ...props }:React.ComponentProps<'div'>)::","CardContent:61:({ className, ...props }:React.ComponentProps<'div'>)::","CardFooter:65:({ className, ...props }:React.ComponentProps<'div'>)::"]],"portal/sr/components/ui/input.tsx":["t",["Input:5:({ className, type, ...props }:React.ComponentProps<'input'>)::"]],"portal/sr/components/ui/progress.tsx":["t",["Progress:8:({ className, value, ...props }:React.ComponentProps<typeof ProgressPrimitive.Root>)::"]],"portal/sr/hooks/use-dashboard-data.ts":["t",["useUserStats:7:()::","useEngagement:16:()::","useVices:25:()::","useConversations:34:(limit = 10)::","useDailySummary:43:(date:string)::"]],"portal/sr/proxy.ts":["t",["proxy:13:async (request:NextRequest):createServerClient,setAll:"]],"t/agents/text/test_agent.py":["p",{"TestNikitaAgentConfiguration":["16",["test_agent_module_importable:19:(self)::Agent module should be importable without API key.","test_ac_1_3_1_model_name_constant:27:(self)::AC-1.3.1: MODEL_NAME is anthropic:claude-sonnet-4-5-20250929.","test_ac_1_3_2_uses_nikita_deps:38:(self)::AC-1.3.2: Agent has deps_type=NikitaDeps."]],"TestNikitaAgentSystemPrompt":["47",["test_ac_1_3_3_system_prompt_includes_persona:51:async (self)::AC-1.3.3: System prompt includes NIKITA_PERSONA.","test_ac_1_3_3_system_prompt_includes_chapter_behavior:69:async (self)::AC-1.3.3: System prompt includes CHAPTER_BEHAVIORS.","test_ac_1_3_3_system_prompt_includes_memory_context:86:async (self)::AC-1.3.3: System prompt includes memory context.","test_system_prompt_varies_by_chapter:102:async (self)::System prompt should change based on chapter."]],"TestNikitaAgentInvocation":["122",["test_ac_1_3_4_agent_has_run_method:129:(self)::AC-1.3.4: Agent should have a run method.","test_agent_run_is_async:141:(self)::Agent.run should be an async method."]],"TestGenerateResponse":["151",["test_generate_response_exists:154:(self)::generate_response function should exist.","test_generate_response_is_async:161:async (self)::generate_response should be async."]]}],"t/agents/text/test_chapter_behavior.py":["p",{"TestChapterBehaviorInjection":["17",["test_ac_3_2_1_ch1_prompt_contains_eager_behavior:21:async (self)::AC-3.2.1: Ch1 prompts should contain excited/eager behaviors (NEW DESIGN).","test_ac_3_2_1_ch1_response_rate_in_prompt:39:async (self)::AC-3.2.1: Ch1 prompt should mention 95% response rate (NEW DESIGN).","test_ac_3_2_2_ch3_prompt_contains_vulnerable_behavior:55:async (self)::AC-3.2.2: Ch3 prompts should contain emotionally vulnerable behaviors.","test_ac_3_2_2_ch3_response_rate_in_prompt:74:async (self)::AC-3.2.2: Ch3 prompt should mention 88% response rate.","test_ac_3_2_3_ch5_prompt_contains_stable_behavior:89:async (self)::AC-3.2.3: Ch5 prompts should contain stable/authentic behaviors.","test_ac_3_2_3_ch5_response_rate_in_prompt:107:async (self)::AC-3.2.3: Ch5 prompt should mention 82% response rate.","test_ac_3_2_4_prompts_differ_by_chapter:122:async (self)::AC-3.2.4: Different chapters should produce different prompts.","test_ac_3_2_4_prompt_has_current_chapter_behavior_label:140:async (self)::AC-3.2.4: Prompt should have labeled CURRENT CHAPTER BEHAVIOR section.","test_chapter_names_match_constants:155:async (self)::Chapter names in behavior should match CHAPTER_NAMES constant."]],"TestChapterBehaviorProgression":["173",["test_response_rate_decreases_through_chapters:177:async (self)::Response rate should decrease through chapters (NEW DESIGN).","test_emotional_openness_increases_through_chapters:201:async (self)::Emotional openness indicators should increase through chapters.","test_ch1_has_calibration_keywords:226:async (self)::Chapter 1 should focus on calibration/not overwhelming (NEW DESIGN).","test_ch5_has_stability_keywords:245:async (self)::Chapter 5 should focus on stability/security."]],"TestDefaultChapterBehavior":["264",["test_invalid_chapter_falls_back_to_ch1:268:async (self)::Invalid chapter numbers should fall back to Chapter 1 behavior.","test_chapter_6_falls_back_to_ch1:285:async (self)::Chapter 6 (non-existent) should fall back to default behavior."]]}],"t/agents/text/test_deps.py":["p",{"TestNikitaDepsStructure":["16",["test_is_dataclass:19:(self)::NikitaDeps should be a dataclass.","test_ac_1_2_1_has_memory_field:25:(self)::AC-1.2.1: NikitaDeps contains memory: NikitaMemory.","test_ac_1_2_2_has_user_field:32:(self)::AC-1.2.2: NikitaDeps contains user: User.","test_ac_1_2_3_has_settings_field:39:(self)::AC-1.2.3: NikitaDeps contains settings: Settings.","test_ac_1_2_5_type_hints_complete:46:(self)::AC-1.2.5: Type hints complete for Pydantic AI compatibility."]],"TestNikitaDepsProperties":["54",["test_ac_1_2_4_chapter_property:57:(self)::AC-1.2.4: chapter property returns user.chapter.","test_chapter_property_follows_user_changes:75:(self)::Chapter property should reflect user.chapter changes."]],"TestNikitaDepsInstantiation":["96",["test_can_instantiate_with_mocks:99:(self)::Should be able to create NikitaDeps with mock objects.","test_requires_all_fields:117:(self)::Should require all fields to instantiate."]]}],"t/agents/text/test_factory.py":["p",{"TestGetNikitaAgentForUser":["16",["test_function_exists:19:(self)::Factory function should exist and be importable.","test_ac_1_4_1_accepts_user_id:26:async (self)::AC-1.4.1: Function accepts user_id: UUID parameter.","test_function_is_async:35:async (self)::Factory function should be async.","test_ac_1_4_4_returns_tuple_with_deps:43:async (self)::AC-1.4.4: Function returns tuple (Agent, NikitaDeps).","test_ac_1_4_2_loads_user:77:async (self)::AC-1.4.2: Function loads user from database.","test_ac_1_4_3_initializes_memory:98:async (self)::AC-1.4.3: Function initializes NikitaMemory for user.","test_ac_1_4_5_handles_user_not_found:119:async (self)::AC-1.4.5: Function handles user not found with appropriate error."]]}],"t/agents/text/test_facts.py":["p",{"TestFactsModule":["17",["test_facts_module_importable:20:(self)::Facts module should be importable.","test_extracted_fact_dataclass:27:(self)::ExtractedFact should be a dataclass with required fields.","test_extracted_fact_has_fact_type:41:(self)::ExtractedFact should have fact_type field (explicit/implicit)."]],"TestFactExtractor":["63",["test_fact_extractor_class_exists:66:(self)::FactExtractor class should exist.","test_ac_6_1_1_extract_facts_method_exists:72:(self)::AC-6.1.1: extract_facts async method should exist.","test_extract_facts_signature:83:(self)::extract_facts should accept user_message, nikita_response, existing_facts.","test_ac_6_1_4_returns_list_of_extracted_facts:97:async (self)::AC-6.1.4: Should return list[ExtractedFact].","test_extracted_fact_has_required_fields:125:async (self)::Each ExtractedFact should have fact, confidence, source."]],"TestExplicitFacts":["153",["test_ac_6_1_2_extracts_explicit_facts:157:async (self)::AC-6.1.2: Should identify explicit facts user states directly.","test_explicit_facts_have_high_confidence:189:async (self)::Explicit facts should have high confidence (>0.8)."]],"TestImplicitFacts":["216",["test_ac_6_1_3_extracts_implicit_facts:220:async (self)::AC-6.1.3: Should identify implicit facts inferred from context.","test_implicit_facts_have_lower_confidence:246:async (self)::Implicit facts should have lower confidence (<0.9)."]],"TestFactDeduplication":["273",["test_ac_6_1_5_avoids_extracting_known_facts:277:async (self)::AC-6.1.5: Should not extract facts that already exist.","test_deduplication_is_case_insensitive:315:async (self)::Deduplication should work regardless of case."]],"TestEmptyResults":["343",["test_returns_empty_list_when_no_facts:347:async (self)::Should return empty list when no facts found.","test_handles_small_talk_gracefully:363:async (self)::Small talk should not generate facts."]]}],"t/agents/text/test_handler.py":["p",{"TestMessageHandlerStructure":["18",["test_handler_module_importable:21:(self)::Handler module should be importable.","test_ac_4_2_5_response_decision_exists:28:(self)::AC-4.2.5: ResponseDecision dataclass should exist.","test_response_decision_has_delay_seconds:34:(self)::ResponseDecision should have delay_seconds field.","test_response_decision_has_scheduled_at:48:(self)::ResponseDecision should have scheduled_at field."]],"TestMessageHandler":["63",["test_message_handler_class_exists:66:(self)::MessageHandler class should exist.","test_ac_4_2_1_handle_method_exists:72:(self)::AC-4.2.1: MessageHandler.handle(user_id, message) should exist.","test_handle_method_signature:83:(self)::Handle method should accept user_id and message parameters.","test_ac_4_2_2_handler_generates_response:96:async (self)::AC-4.2.2: Handler should generate response via agent.","test_ac_4_2_3_handler_calculates_delay:133:async (self)::AC-4.2.3: Handler should calculate delay via ResponseTimer.","test_ac_4_2_5_handler_returns_response_decision:171:async (self)::AC-4.2.5: Handler should return ResponseDecision with delay_seconds."]],"TestResponseDecisionScheduling":["215",["test_scheduled_at_is_future:218:(self)::scheduled_at should be in the future based on delay.","test_handler_calculates_correct_scheduled_time:235:async (self)::Handler should calculate scheduled_at based on now + delay."]],"TestPendingResponseStorage":["281",["test_ac_4_2_4_handler_stores_pending_response:285:async (self)::AC-4.2.4: Handler should store pending response with scheduled delivery time.","test_response_decision_has_response_id:329:(self)::ResponseDecision should have response_id for tracking."]]}],"t/agents/text/test_handler_facts.py":["p",{"TestResponseDecisionFacts":["16",["test_ac_6_3_4_response_decision_has_facts_extracted:19:(self)::AC-6.3.4: ResponseDecision should have facts_extracted list.","test_facts_extracted_default_empty_list:31:(self)::facts_extracted should default to empty list.","test_facts_extracted_can_contain_facts:43:(self)::facts_extracted should be able to contain ExtractedFact objects."]],"TestHandlerFactExtraction":["68",["test_ac_6_3_1_handler_calls_fact_extractor:72:async (self)::AC-6.3.1: Handler calls FactExtractor after agent generates response.","test_fact_extractor_receives_correct_arguments:118:async (self)::FactExtractor should receive user_message, nikita_response, and existing_facts.","test_ac_6_3_2_extracted_facts_stored_via_memory:169:async (self)::AC-6.3.2: Extracted facts stored via memory.add_user_fact().","test_ac_6_3_4_response_includes_extracted_facts:234:async (self)::AC-6.3.4: ResponseDecision includes facts_extracted list.","test_no_fact_extraction_when_skipped:290:async (self)::Should not extract facts when message is skipped."]],"TestHandlerWithDefaultFactExtractor":["327",["test_handler_creates_fact_extractor_if_none:330:(self)::Handler should create FactExtractor if none provided.","test_handler_uses_provided_fact_extractor:340:(self)::Handler should use provided FactExtractor."]],"TestFactExtractionWithEmptyResults":["351",["test_empty_facts_handled_gracefully:355:async (self)::Handler should handle empty fact extraction results gracefully."]]}],"t/agents/text/test_handler_skip.py":["p",{"TestSkipDecisionIntegration":["20",["test_response_decision_has_should_respond:23:(self)::ResponseDecision should have should_respond field.","test_response_decision_should_respond_default_true:38:(self)::ResponseDecision.should_respond should default to True.","test_ac_5_2_5_response_decision_false_when_skipped:51:(self)::AC-5.2.5: ResponseDecision.should_respond = False when skipped.","test_response_decision_has_skip_reason:66:(self)::ResponseDecision should have skip_reason field."]],"TestHandlerSkipDecision":["82",["test_ac_5_2_1_handler_checks_skip_before_agent:86:async (self)::AC-5.2.1: Handler checks SkipDecision.should_skip() before agent.run().","test_handler_skips_agent_when_should_skip_true:128:async (self)::When should_skip returns True, handler should not call agent.","test_ac_5_2_5_skipped_response_decision:165:async (self)::AC-5.2.5: When skipped, ResponseDecision.should_respond = False."]],"TestSkipLogging":["196",["test_ac_5_2_2_skipped_messages_logged:200:async (self, caplog)::AC-5.2.2: Skipped messages should be logged with reason.","test_skip_reason_in_response_decision:231:async (self)::Skip reason should be included in ResponseDecision."]],"TestConsecutiveSkipState":["261",["test_ac_5_2_3_skip_state_stored:265:async (self)::AC-5.2.3: Skip state stored so consecutive messages don't all skip.","test_ac_5_2_4_next_message_after_skip_processes:292:async (self)::AC-5.2.4: Next message after skip processes normally."]],"TestSkipDoesNotStore":["345",["test_skipped_message_not_stored:349:async (self)::Skipped messages should not call store_pending_response."]],"TestHandlerWithDefaultSkip":["380",["test_handler_creates_skip_decision_if_none:383:(self)::Handler should create SkipDecision if none provided.","test_handler_uses_provided_skip_decision:393:(self)::Handler should use provided SkipDecision."]]}],"t/agents/text/test_nikita_persona.py":["p",{"TestNikitaPersona":["15",["test_ac_1_1_1_backstory_elements:18:(self)::AC-1.1.1: Persona includes complete backstory.","test_ac_1_1_2_communication_style_rules:32:(self)::AC-1.1.2: Communication style rules defined.","test_ac_1_1_3_interests_listed:43:(self)::AC-1.1.3: Interests listed.","test_ac_1_1_4_values_defined:53:(self)::AC-1.1.4: Values defined.","test_ac_1_1_5_negative_examples_section:63:(self)::AC-1.1.5: Negative examples section exists.","test_ac_1_1_6_at_least_10_example_responses:72:(self)::AC-1.1.6: At least 10 example responses.","test_persona_is_string:84:(self)::Persona should be a string for prompt injection.","test_persona_has_prompt_format_markers:91:(self)::Persona should be structured for LLM consumption."]],"TestGetPersonaPrompt":["101",["test_get_persona_returns_string:104:(self)::Function should return the persona string.","test_get_persona_matches_constant:112:(self)::Function should return the NIKITA_PERSONA constant."]]}],"t/agents/text/test_skip.py":["p",{"TestSkipRates":["15",["test_skip_module_importable:18:(self)::Skip module should be importable.","test_ac_5_1_1_skip_rates_is_dict:25:(self)::AC-5.1.1: SKIP_RATES should be a dict mapping chapter to (min, max).","test_ac_5_1_2_ch1_skip_rate:44:(self)::AC-5.1.2: Ch1 rate should be 25-40% skip.","test_ac_5_1_3_ch5_skip_rate:54:(self)::AC-5.1.3: Ch5 rate should be 0-5% skip.","test_skip_rates_decrease_through_chapters:64:(self)::Skip rates should generally decrease as chapters progress."]],"TestSkipDecision":["76",["test_skip_decision_class_exists:79:(self)::SkipDecision class should exist.","test_ac_5_1_4_should_skip_returns_bool:85:(self)::AC-5.1.4: should_skip(chapter) should return bool.","test_should_skip_accepts_chapter_parameter:94:(self)::should_skip should accept chapter parameter.","test_ac_5_1_5_skip_is_randomized:104:(self)::AC-5.1.5: Skip probability should be randomized within range.","test_ch1_skip_rate_within_expected_range:117:(self)::Ch1 should skip 25-40% of messages.","test_ch5_skip_rate_within_expected_range:130:(self)::Ch5 should skip 0-5% of messages.","test_skip_rate_varies_by_chapter:143:(self)::Skip rates should vary significantly between chapters.","test_invalid_chapter_uses_default:159:(self)::Invalid chapter should use a default skip rate."]],"TestSkipRatesByChapter":["173",["test_ch2_skip_rate:176:(self)::Ch2 should have rate 15-25%.","test_ch3_skip_rate:184:(self)::Ch3 should have rate 5-15%.","test_ch4_skip_rate:192:(self)::Ch4 should have rate 2-10%."]],"TestSkipConsecutiveMessages":["201",["test_skip_decision_tracks_last_skip:204:(self)::SkipDecision should track if last message was skipped.","test_consecutive_skips_less_likely:213:(self)::After a skip, next message should be less likely to skip."]]}],"t/agents/text/test_timing.py":["p",{"TestTimingRanges":["16",["test_timing_module_importable:19:(self)::Timing module should be importable.","test_ac_4_1_1_timing_ranges_is_dict:26:(self)::AC-4.1.1: TIMING_RANGES should be a dict mapping chapter to (min, max).","test_ac_4_1_2_ch1_range:45:(self)::AC-4.1.2: Ch1 range should be 600-28800s (10min-8h).","test_ac_4_1_3_ch5_range:56:(self)::AC-4.1.3: Ch5 range should be 300-1800s (5min-30min).","test_ranges_for_all_chapters:67:(self)::All 5 chapters should have timing ranges defined."]],"TestResponseTimer":["75",["test_response_timer_class_exists:78:(self)::ResponseTimer class should exist.","test_ac_4_1_4_calculate_delay_returns_int:84:(self)::AC-4.1.4: calculate_delay(chapter) should return int seconds.","test_calculate_delay_within_chapter_range:94:(self)::calculate_delay should return values within the chapter's range.","test_ac_4_1_5_distribution_not_uniform:109:(self)::AC-4.1.5: Distribution should be gaussian (clustered around mean).","test_ac_4_1_6_jitter_prevents_exact_patterns:134:(self)::AC-4.1.6: Random jitter should prevent exact repetition.","test_invalid_chapter_uses_default:147:(self)::Invalid chapter should fall back to a default range."]],"TestTimingProgression":["163",["test_timing_reduces_through_chapters:166:(self)::Response timing ranges should reduce as chapters progress.","test_average_delay_decreases_through_chapters:177:(self)::Average delays should decrease through chapters."]],"TestTimingRangesByChapter":["195",["test_ch2_timing_range:198:(self)::Ch2 should have range 300-14400s (5min-4h).","test_ch3_timing_range:209:(self)::Ch3 should have range 300-7200s (5min-2h).","test_ch4_timing_range:220:(self)::Ch4 should have range 300-3600s (5min-1h)."]]}],"t/agents/text/test_tools.py":["p",{"TestRecallMemoryTool":["23",["test_tools_module_importable:26:(self)::Tools module should be importable.","test_ac_2_2_1_tool_is_decorated:32:(self)::AC-2.2.1: Tool should be decorated with @agent.tool(retries=2).","test_ac_2_2_1_tool_registered_with_agent:45:(self)::AC-2.2.1: Tool is registered with the agent with retries=2.","test_ac_2_2_2_accepts_query_parameter:60:(self)::AC-2.2.2: Tool accepts query: str parameter.","test_ac_2_2_3_calls_search_memory:73:async (self)::AC-2.2.3: Tool calls memory.search_memory(query, limit=5).","test_ac_2_2_4_returns_formatted_results:98:async (self)::AC-2.2.4: Tool returns formatted string of results.","test_ac_2_2_5_handles_empty_results:141:async (self)::AC-2.2.5: Tool handles empty results gracefully."]],"TestFormatMemoryResults":["164",["test_format_function_exists:167:(self)::format_memory_results helper should exist.","test_format_with_multiple_results:173:(self)::Should format multiple memory results nicely.","test_format_empty_results:202:(self)::Should return appropriate message for empty results.","test_format_single_result:211:(self)::Should format a single result correctly.","test_format_handles_missing_created_at:230:(self)::Should handle results with missing created_at."]],"TestNoteUserFactTool":["250",["test_note_user_fact_exists:253:(self)::note_user_fact function should exist in tools module.","test_ac_6_2_1_tool_is_callable:259:(self)::AC-6.2.1: Tool should be callable (decorated with @agent.tool).","test_ac_6_2_1_tool_registered_with_agent:270:(self)::AC-6.2.1: Tool is registered with the agent.","test_ac_6_2_2_accepts_fact_and_confidence_parameters:285:(self)::AC-6.2.2: Tool accepts fact: str and confidence: float parameters.","test_ac_6_2_3_calls_add_user_fact:299:async (self)::AC-6.2.3: Tool calls memory.add_user_fact(fact, confidence).","test_ac_6_2_4_returns_confirmation_string:324:async (self)::AC-6.2.4: Tool returns confirmation string.","test_tool_handles_high_confidence_fact:347:async (self)::Tool should handle high confidence facts (explicit).","test_tool_handles_low_confidence_fact:367:async (self)::Tool should handle lower confidence facts (implicit)."]]}],"t/api/routes/test_tasks.py":["p",{"TestTaskRouteAuth":["15",["app:19:(self)::Create test FastAPI app with task routes.","client:26:(self, app)::Create test client.","test_decay_endpoint_exists:30:(self, client)::Verify POST /decay endpoint exists.","test_deliver_endpoint_exists:37:(self, client)::Verify POST /deliver endpoint exists.","test_summary_endpoint_exists:43:(self, client)::Verify POST /summary endpoint exists.","test_cleanup_endpoint_exists:49:(self, client)::Verify POST /cleanup endpoint exists.","test_auth_required_when_secret_configured:75:(self, client)::Verify endpoints require auth when secret is configured.","test_auth_succeeds_with_valid_bearer:86:(self, client)::Verify auth succeeds with correct bearer token.","test_auth_fails_with_wrong_bearer:98:(self, client)::Verify auth fails with incorrect bearer token."]],"TestDecayEndpoint":["111",["app:115:(self)::Create test FastAPI app.","client:122:(self, app)::Create test client.","test_decay_returns_expected_format:126:(self, client)::Verify /decay returns expected response format."]],"TestDeliverEndpoint":["139",["app:143:(self)::Create test FastAPI app.","client:150:(self, app)::Create test client.","test_deliver_returns_expected_format:154:(self, client)::Verify /deliver returns expected response format."]],"TestSummaryEndpoint":["167",["app:171:(self)::Create test FastAPI app.","client:178:(self, app)::Create test client.","test_summary_returns_expected_format:182:(self, client)::Verify /summary returns expected response format."]],"TestCleanupEndpoint":["195",["app:199:(self)::Create test FastAPI app.","client:206:(self, app)::Create test client.","test_cleanup_returns_expected_format:210:(self, client)::Verify /cleanup returns expected response format on success.","test_cleanup_handles_errors_gracefully:242:(self, client)::Verify /cleanup handles errors gracefully."]]}],"t/api/routes/test_telegram.py":["p",{"TestTelegramWebhook":["18",["mock_bot:22:(self)::Mock TelegramBot.","mock_command_handler:30:(self)::Mock CommandHandler.","mock_message_handler:37:(self)::Mock MessageHandler.","app:44:(self, mock_bot, mock_command_handler, mock_message_handler)::Create test FastAPI app with dependency overrides.","client:67:(self, app)::Create test client.","test_ac_fr001_001_webhook_receives_updates:71:(self, client)::","test_ac_t006_1_command_routed_to_command_handler:95:(self, client, mock_command_handler)::","test_ac_t006_2_text_routed_to_message_handler:120:(self, client, mock_message_handler)::","test_ac_t006_3_empty_update_handled_gracefully:143:(self, client)::","test_ac_t006_4_returns_200_quickly:156:(self, client)::","test_webhook_returns_ok_status:177:(self, client)::","test_edited_message_ignored:197:(self, client, mock_message_handler)::","test_callback_query_ignored:216:(self, client, mock_command_handler)::"]],"TestSetWebhook":["234",["mock_bot:238:(self)::Mock TelegramBot.","app:245:(self, mock_bot)::Create test FastAPI app with mocked bot.","client:257:(self, app)::Create test client.","test_set_webhook_endpoint_exists:261:(self, client, mock_bot)::","test_set_webhook_calls_bot:272:(self, client, mock_bot)::","test_set_webhook_requires_https:292:(self, client, mock_bot)::"]]}],"t/config/test_enums.py":["p",{"TestChapterEnum":["9",["test_chapter_has_five_values:12:(self)::Chapter enum should have exactly 5 chapters.","test_chapter_values_are_1_to_5:18:(self)::Chapter values should be integers 1-5.","test_chapter_is_int_enum:28:(self)::Chapter should be an IntEnum for numeric operations.","test_chapter_name_display:36:(self)::Chapter should have display name property."]],"TestGameStatusEnum":["44",["test_game_status_has_four_values:47:(self)::GameStatus enum should have 4 states.","test_game_status_values:53:(self)::GameStatus should have expected string values.","test_game_status_is_playable:62:(self)::GameStatus should have is_playable property."]],"TestEngagementStateEnum":["72",["test_engagement_state_has_six_values:75:(self)::EngagementState should have exactly 6 states.","test_engagement_state_values:81:(self)::EngagementState should have expected values.","test_engagement_state_is_healthy:96:(self)::EngagementState should have is_healthy property."]],"TestMoodEnum":["111",["test_mood_has_values:114:(self)::Mood enum should have mood states."]],"TestTimeOfDayEnum":["124",["test_time_of_day_has_five_periods:127:(self)::TimeOfDay should have 5 periods.","test_time_of_day_values:133:(self)::TimeOfDay should have expected values."]],"TestViceCategoryEnum":["144",["test_vice_category_has_eight_values:147:(self)::ViceCategory should have exactly 8 categories.","test_vice_category_values:153:(self)::ViceCategory should have all 8 categories."]],"TestViceIntensityEnum":["171",["test_vice_intensity_has_three_levels:174:(self)::ViceIntensity should have 3 levels.","test_vice_intensity_values:180:(self)::ViceIntensity should have low/medium/high."]],"TestMetricEnum":["189",["test_metric_has_four_values:192:(self)::Metric should have exactly 4 metrics.","test_metric_values:198:(self)::Metric should have the 4 relationship metrics."]]}],"t/config/test_experiments.py":["p",{"TestExperimentImports":["26",["test_configuration_error_importable:29:(self)::AC-5.4.1: ConfigurationError exception should be importable.","test_experiment_loader_importable:34:(self)::ExperimentLoader class should be importable.","test_deep_merge_importable:39:(self)::deep_merge utility should be importable."]],"TestExperimentEnvVar":["45",["test_ac_5_1_1_reads_env_var:48:(self)::AC-5.1.1: Reads NIKITA_EXPERIMENT env var at startup.","test_ac_5_1_3_none_when_not_set:56:(self)::AC-5.1.3: If not set, uses base config only."]],"TestExperimentLoading":["69",["experiment_dir:73:(self)::Create temporary experiment directory with test files."]],"TestDeepMerge":["146",["test_ac_5_2_1_overlay_base_config:149:(self)::AC-5.2.1: Experiment YAML overlays base config.","test_ac_5_2_2_nested_dicts_merged:161:(self)::AC-5.2.2: Nested dicts merged recursively.","test_ac_5_2_3_lists_replaced:186:(self)::AC-5.2.3: Lists replaced (not appended).","test_ac_5_2_4_scalars_overwritten:198:(self)::AC-5.2.4: Scalars overwritten."]],"TestExperimentInheritance":["212",["inheritance_dir:216:(self)::Create directory with parent/child experiments."]],"TestCircularInheritance":["276",["circular_dir:280:(self)::Create directory with circular experiments."]],"TestInvalidExperiment":["315",["valid_exp_dir:319:(self)::Create directory with known experiments.","test_ac_5_4_1_unknown_experiment_raises_error:331:(self, valid_exp_dir)::AC-5.4.1: ConfigurationError raised for unknown experiment.","test_ac_5_4_2_error_lists_available:341:(self, valid_exp_dir)::AC-5.4.2: Error message lists available experiments.","test_ac_5_4_3_fails_fast_at_startup:355:(self, valid_exp_dir)::AC-5.4.3: Fails fast at startup, not runtime."]],"TestNoExperiment":["368",["test_no_experiment_returns_empty_overlay:371:(self)::When NIKITA_EXPERIMENT not set, return empty overlay."]]}],"t/config/test_loader.py":["p",{"TestConfigLoaderSingleton":["12",["test_get_config_returns_config_loader:15:(self)::get_config() should return a ConfigLoader instance.","test_get_config_returns_same_instance:22:(self)::get_config() should return the same instance (singleton).","test_config_loader_loads_all_yaml_files:30:(self)::ConfigLoader should load all YAML config files."]],"TestConfigLoaderGameAccess":["45",["test_get_starting_score:48:(self)::Should return starting score from game.yaml.","test_get_max_boss_attempts:55:(self)::Should return max boss attempts from game.yaml."]],"TestConfigLoaderChapterAccess":["63",["test_get_chapter_returns_chapter_config:66:(self)::get_chapter(n) should return chapter configuration.","test_get_boss_threshold:75:(self)::get_boss_threshold(chapter) should return correct threshold."]],"TestConfigLoaderDecayAccess":["87",["test_get_decay_rate:90:(self)::get_decay_rate(chapter) should return Decimal rate.","test_get_grace_period:98:(self)::get_grace_period(chapter) should return timedelta."]],"TestConfigLoaderMetricAccess":["107",["test_get_metric_weights:110:(self)::Should return metric weights that sum to 1.0."]],"TestConfigLoaderPerformance":["120",["test_initial_load_under_100ms:123:(self)::Initial config load should complete in < 100ms.","test_subsequent_access_under_1ms:137:(self)::Subsequent config access should be < 1ms (cached)."]],"TestConfigLoaderYAMLIntegration":["153",["test_loads_game_yaml:156:(self)::Should successfully load config_data/game.yaml.","test_loads_chapters_yaml:163:(self)::Should successfully load config_data/chapters.yaml.","test_loads_scoring_yaml:171:(self)::Should successfully load config_data/scoring.yaml.","test_loads_decay_yaml:178:(self)::Should successfully load config_data/decay.yaml.","test_loads_engagement_yaml:186:(self)::Should successfully load config_data/engagement.yaml.","test_loads_vices_yaml:193:(self)::Should successfully load config_data/vices.yaml.","test_loads_schedule_yaml:200:(self)::Should successfully load config_data/schedule.yaml."]],"TestConfigLoaderErrorHandling":["208",["test_raises_on_invalid_chapter:211:(self)::get_chapter() should raise for invalid chapter number.","test_raises_on_missing_config_file:219:(self)::Should raise ConfigurationError if YAML file missing."]]}],"t/config/test_prompt_loader.py":["p",{"TestPromptLoaderImports":["28",["test_ac_4_1_1_prompt_loader_class_exists:31:(self)::AC-4.1.1: PromptLoader class exists in prompt_loader.py.","test_missing_variable_error_importable:36:(self)::AC-4.3.1: MissingVariableError exception defined.","test_get_prompt_loader_importable:41:(self)::Convenience function should be importable."]],"TestPromptLoaderLoad":["47",["temp_prompt_file:51:(self)::Create a temporary .prompt file for testing.","test_ac_4_1_2_load_reads_prompt_file:61:(self, temp_prompt_file)::AC-4.1.2: load(path) method reads .prompt files.","test_ac_4_1_3_load_returns_string:70:(self, temp_prompt_file)::AC-4.1.3: Returns string content.","test_load_nonexistent_file_raises_error:80:(self)::Loading nonexistent file should raise FileNotFoundError.","test_load_preserves_newlines:88:(self, temp_prompt_file)::Load should preserve newlines in content."]],"TestPromptLoaderRender":["98",["template_prompt_file:102:(self)::Create a template .prompt file with variables.","nested_template_file:113:(self)::Create a template with nested variables.","test_ac_4_2_1_variable_substitution:123:(self, template_prompt_file)::AC-4.2.1: {{variable}} syntax replaced with values.","test_ac_4_2_2_render_accepts_kwargs:138:(self, template_prompt_file)::AC-4.2.2: render(path, **kwargs) method accepts variables.","test_ac_4_2_3_nested_variables:151:(self, nested_template_file)::AC-4.2.3: Nested variables work {{user.name}}.","test_render_with_no_variables:165:(self)::Render file with no variables returns content unchanged."]],"TestMissingVariableError":["184",["incomplete_template:188:(self)::Create template with variables that won't be provided.","test_ac_4_3_1_exception_defined:198:(self)::AC-4.3.1: MissingVariableError exception defined.","test_ac_4_3_2_raised_for_unreplaced_variable:205:(self, incomplete_template)::AC-4.3.2: Raised when template has unreplaced {{var}}.","test_ac_4_3_3_error_includes_variable_name:214:(self, incomplete_template)::AC-4.3.3: Error message includes missing variable name."]],"TestPromptCaching":["226",["cacheable_prompt:230:(self)::Create a prompt file for cache testing.","test_ac_4_4_1_prompts_cached:240:(self, cacheable_prompt)::AC-4.4.1: Prompts cached after first load.","test_ac_4_4_3_subsequent_loads_fast:259:(self, cacheable_prompt)::AC-4.4.3: Subsequent loads < 1ms."]],"TestCacheClear":["278",["clearable_prompt:282:(self)::Create a prompt file for cache clear testing.","test_ac_4_5_1_cache_clear_exists:292:(self)::AC-4.5.1: cache_clear() method exists.","test_ac_4_5_2_clears_cached_prompts:300:(self, clearable_prompt)::AC-4.5.2: Clears all cached prompts.","test_ac_4_5_3_next_load_reads_disk:324:(self, clearable_prompt)::AC-4.5.3: Next load reads from disk."]],"TestPromptLoaderSingleton":["344",["test_get_prompt_loader_returns_same_instance:347:(self)::get_prompt_loader should return cached instance."]]}],"t/config/test_schemas.py":["p",{"TestGameConfigSchema":["10",["test_game_config_validates_game_yaml:13:(self)::GameConfig should validate the game.yaml structure.","test_game_config_rejects_invalid_starting_score:34:(self)::GameConfig should reject starting_score outside 0-100.","test_game_config_rejects_zero_boss_attempts:51:(self)::GameConfig should reject max_boss_attempts <= 0."]],"TestChaptersConfigSchema":["69",["test_chapters_config_validates_five_chapters:72:(self)::ChaptersConfig should validate exactly 5 chapters.","test_chapters_config_rejects_non_increasing_thresholds:95:(self)::ChaptersConfig should reject non-monotonically increasing boss thresholds.","test_chapters_config_rejects_overlapping_day_ranges:112:(self)::ChaptersConfig should reject overlapping day ranges."]],"TestScoringConfigSchema":["130",["test_scoring_config_validates_weights_sum_to_one:133:(self)::ScoringConfig metric weights must sum to 1.0.","test_scoring_config_rejects_invalid_weights_sum:169:(self)::ScoringConfig should reject weights that don't sum to 1.0."]],"TestDecayConfigSchema":["198",["test_decay_config_validates_all_chapters:201:(self)::DecayConfig should have values for all 5 chapters.","test_decay_config_rejects_missing_chapter:215:(self)::DecayConfig should reject missing chapter definitions."]],"TestEngagementConfigSchema":["229",["test_engagement_config_validates_six_states:232:(self)::EngagementConfig should have exactly 6 states."]],"TestVicesConfigSchema":["261",["test_vices_config_validates_eight_categories:264:(self)::VicesConfig should have exactly 8 vice categories."]]}],"t/context/test_post_processor.py":["p",["mock_meta_prompt_service:38:():_mock_generator:"],{"TestPostProcessorBasics":["67",["mock_session:71:(self)>AsyncMock::Create a mock AsyncSession.","mock_conversation:77:(self)>MagicMock::Create a mock Conversation with messages.","mock_extraction_response:95:(self)>str::Create a mock LLM extraction response.","test_process_conversation_full_pipeline_success:128:async (self, mock_session:AsyncMock, mock_conversation:MagicMock, mock_meta_prompt_service,):mock_meta_prompt_service:AC-1: process_conversation() runs all 8 stages on success.","test_process_conversation_not_found_fails:192:async (self, mock_session:AsyncMock)::AC-2: process_conversation() fails gracefully when not found.","test_process_conversation_no_messages_fails:211:async (self, mock_session:AsyncMock)::AC-3: process_conversation() fails when conversation has no messages.","test_stage_ingestion_loads_conversation:233:async (self, mock_session:AsyncMock, mock_conversation:MagicMock)::AC-4: _stage_ingestion() returns conversation when found."]],"TestExtractionStage":["249",["mock_session:253:(self)>AsyncMock::","mock_conversation:258:(self)>MagicMock::","test_stage_extraction_parses_llm_response:274:async (self, mock_session:AsyncMock, mock_conversation:MagicMock, mock_meta_prompt_service):mock_meta_prompt_service:AC-5: _stage_extraction() correctly parses structured JSON response.","test_stage_extraction_handles_parse_error:307:async (self, mock_session:AsyncMock, mock_conversation:MagicMock, mock_meta_prompt_service):mock_meta_prompt_service:AC-6: _stage_extraction() returns defaults when extraction returns empty data.","test_format_messages:327:(self, mock_session:AsyncMock)::Test _format_messages correctly formats conversation."]],"TestThreadAndThoughtCreation":["346",["mock_session:350:(self)>AsyncMock::","mock_conversation:355:(self)>MagicMock::","test_stage_create_threads_creates_from_extraction:367:async (self, mock_session:AsyncMock, mock_conversation:MagicMock)::AC-7: _stage_create_threads() creates threads from extraction data.","test_stage_create_threads_resolves_existing:400:async (self, mock_session:AsyncMock, mock_conversation:MagicMock)::AC-7b: _stage_create_threads() resolves marked thread IDs.","test_stage_create_thoughts_creates_from_extraction:428:async (self, mock_session:AsyncMock, mock_conversation:MagicMock)::AC-8: _stage_create_thoughts() creates thoughts from extraction data."]],"TestSummaryRollups":["454",["mock_session:458:(self)>AsyncMock::","mock_conversation:463:(self)>MagicMock::","mock_extraction_result:470:(self)::Create a mock ExtractionResult.","test_stage_summary_rollups_creates_new:496:async (self, mock_session:AsyncMock, mock_conversation:MagicMock, mock_extraction_result,)::AC-9: _stage_summary_rollups() creates new daily summary when none exists.","test_stage_summary_rollups_updates_existing:528:async (self, mock_session:AsyncMock, mock_conversation:MagicMock, mock_extraction_result,)::AC-10: _stage_summary_rollups() updates existing daily summary."]],"TestPipelineStatusMarking":["561",["mock_session:565:(self)>AsyncMock::","test_pipeline_marks_processed_on_success:573:async (self, mock_session:AsyncMock, mock_meta_prompt_service):mock_meta_prompt_service:AC-11: Pipeline calls mark_processed on successful completion.","test_pipeline_marks_failed_on_error:633:async (self, mock_session:AsyncMock)::AC-12: Pipeline calls mark_failed when an error occurs."]],"TestConvenienceFunction":["667",["mock_session:671:(self)>AsyncMock::","test_convenience_function_processes_multiple:681:async (self, mock_session:AsyncMock)::AC-13: process_conversations() processes list of conversation IDs."]],"TestPipelineDataclasses":["732",["test_pipeline_result_defaults:735:(self)::Test PipelineResult has correct defaults.","test_extraction_result_structure:752:(self)::Test ExtractionResult structure."]]}],"t/context/test_session_detector.py":["p",{"TestSessionDetector":["25",["mock_session:29:(self)>AsyncMock::Create a mock AsyncSession.","test_get_stale_sessions_returns_ids:41:async (self, mock_session:AsyncMock)::AC-1: get_stale_sessions() returns UUIDs of stale conversations.","test_get_stale_sessions_respects_timeout:68:async (self, mock_session:AsyncMock)::AC-2: get_stale_sessions() passes timeout to repository.","test_get_stale_sessions_respects_limit:93:async (self, mock_session:AsyncMock)::AC-3: get_stale_sessions() passes limit to repository.","test_get_stale_sessions_skips_high_attempts:111:async (self, mock_session:AsyncMock)::AC-3b: get_stale_sessions() uses max_attempts=3.","test_mark_for_processing_returns_true:131:async (self, mock_session:AsyncMock)::AC-4: mark_for_processing() returns True on success.","test_mark_for_processing_not_found_returns_false:153:async (self, mock_session:AsyncMock)::AC-5: mark_for_processing() returns False when conversation not found.","test_detect_and_queue_marks_all_found:173:async (self, mock_session:AsyncMock):mock_get_stale,mock_mark:AC-6: detect_and_queue() detects and marks all stale sessions.","mock_get_stale:182:async (limit)::","mock_mark:218:async (conv_id)::","test_detect_and_queue_empty_when_none_stale:197:async (self, mock_session:AsyncMock)::AC-6b: detect_and_queue() returns empty list when no stale sessions.","test_detect_and_queue_skips_failed_marks:209:async (self, mock_session:AsyncMock):mock_mark:AC-6c: detect_and_queue() skips conversations that fail to mark.","test_convenience_function_detect_stale_sessions:236:async (self, mock_session:AsyncMock)::AC-7: detect_stale_sessions() convenience function works."]]}],"t/context/test_template_generator.py":["p",["mock_meta_prompt_service:134:():_mock_generator:"],{"TestTemplateGeneratorBasics":["156",["mock_session:160:(self)>AsyncMock::Create a mock AsyncSession.","mock_user:166:(self)>MagicMock::Create a mock User with default values.","test_generate_prompt_returns_string:185:async (self, mock_session:AsyncMock, mock_user:MagicMock, mock_meta_prompt_service):mock_meta_prompt_service:AC-1: generate_prompt() returns a string.","test_generate_prompt_user_not_found_raises:207:async (self, mock_session:AsyncMock)::","test_generate_prompt_contains_all_6_layers:237:async (self, mock_session:AsyncMock, mock_user:MagicMock, mock_meta_prompt_service):mock_meta_prompt_service:AC-3: generate_prompt() contains all 6 layers."]],"TestLayer1CoreIdentity":["259",["mock_session:263:(self)>AsyncMock::","test_layer1_core_identity_content:270:(self, mock_session:AsyncMock)::AC-4: Layer 1 contains core personality traits."]],"TestLayer2CurrentMoment":["294",["mock_session:298:(self)>AsyncMock::","base_user:303:(self)>MagicMock::","_create_context:317:(self, user:MagicMock, hour:int, hours_since_last:float,)::Helper to create TemplateContext with specific time settings.","test_layer2_time_of_day_variations:353:(self, mock_session:AsyncMock, base_user:MagicMock, hour:int, expected_context:str, expected_activity:str,):_create_context:AC-5: Layer 2 content varies by time of day.","test_layer2_gap_mood_variations:390:(self, mock_session:AsyncMock, base_user:MagicMock, hours_gap:float, expected_mood:str,):_create_context:AC-6: Layer 2 mood varies by gap since last interaction."]],"TestLayer3RelationshipState":["408",["mock_session:412:(self)>AsyncMock::","_create_context:421:(self, chapter:int, score:Decimal, game_status:str = \"active\",)::Helper to create TemplateContext with specific relationship settings.","test_layer3_chapter_variations:459:(self, mock_session:AsyncMock, chapter:int, chapter_name:str,):_create_context:AC-7a: Layer 3 shows correct chapter name and behaviors.","test_layer3_score_trend_variations:494:(self, mock_session:AsyncMock, score:Decimal, expected_text:str,):_create_context:AC-7b: Layer 3 shows score-based trend text.","test_layer3_boss_fight_status:511:(self, mock_session:AsyncMock):_create_context:AC-7c: Layer 3 shows boss fight note when in boss_fight.","test_layer3_game_over_status:528:(self, mock_session:AsyncMock):_create_context:AC-7d: Layer 3 shows game over note when ended."]],"TestLayer4ConversationHistory":["546",["mock_session:550:(self)>AsyncMock::","_create_context_with_history:560:(self, last_summary:str | None = None, today_summaries:list[str] | None = None, week_summaries:dict[str, str] | None = None, open_threads:dict[str, list[str]] | None = None,)::Helper to create TemplateContext with conversation history.","test_layer4_with_last_conversation:587:(self, mock_session:AsyncMock):_create_context_with_history:AC-8a: Layer 4 shows last conversation summary.","test_layer4_with_today_summaries:607:(self, mock_session:AsyncMock):_create_context_with_history:AC-8b: Layer 4 shows today's conversation summaries.","test_layer4_with_week_summaries:631:(self, mock_session:AsyncMock):_create_context_with_history:AC-8c: Layer 4 shows this week's summaries by day.","test_layer4_with_open_threads:655:(self, mock_session:AsyncMock):_create_context_with_history:AC-8d: Layer 4 shows open conversation threads."]],"TestLayer5KnowledgeInnerLife":["681",["mock_session:685:(self)>AsyncMock::","_create_context_with_knowledge:693:(self, user_facts:list[str] | None = None, active_thoughts:dict[str, list[str]] | None = None,)::Helper to create TemplateContext with knowledge and thoughts.","test_layer5_with_user_facts:718:(self, mock_session:AsyncMock):_create_context_with_knowledge:AC-9a: Layer 5 shows known facts about the user.","test_layer5_with_active_thoughts:744:(self, mock_session:AsyncMock):_create_context_with_knowledge:AC-9b: Layer 5 shows Nikita's active thoughts.","test_layer5_with_missing_him_thought:771:(self, mock_session:AsyncMock):_create_context_with_knowledge:AC-9c: Layer 5 shows missing_him thoughts appropriately."]],"TestLayer6ResponseGuidelines":["794",["mock_session:798:(self)>AsyncMock::","_create_context:807:(self, hour:int, hours_gap:float, chapter:int = 2,)::Helper to create TemplateContext for Layer 6 tests.","test_layer6_time_based_adjustments:845:(self, mock_session:AsyncMock, hour:int, expected_adjustment:str,):_create_context:AC-10a: Layer 6 adjusts for time of day.","test_layer6_gap_based_adjustments:877:(self, mock_session:AsyncMock, hours_gap:float, expected_adjustment:str,):_create_context:AC-10b: Layer 6 adjusts for gap since last interaction."]],"TestFullPromptVisualVerification":["895",["mock_session:899:(self)>AsyncMock::","rich_user:904:(self)>MagicMock::Create a user with rich context for full visual test.","sample_summaries:918:(self)>list[MagicMock]::Create sample daily summaries.","sample_conversations:947:(self)>list[MagicMock]::Create sample processed conversations.","sample_threads:971:(self)>dict[str, list[MagicMock]]::Create sample open threads.","sample_thoughts:989:(self)>dict[str, list[MagicMock]]::Create sample active thoughts.","test_full_prompt_generation_visual:1019:async (self, mock_session:AsyncMock, rich_user:MagicMock, sample_summaries:list[MagicMock], sample_conversations:list[MagicMock], sample_threads:dict[str, list[MagicMock]], sample_thoughts:dict[str, list[MagicMock]], mock_meta_prompt_service,):mock_meta_prompt_service:","test_convenience_function_generate_system_prompt:1071:async (self, mock_session:AsyncMock, rich_user:MagicMock,)::AC-11b: Convenience function works correctly."]],"TestEdgeCases":["1091",["mock_session:1095:(self)>AsyncMock::","basic_user:1100:(self)>MagicMock::","test_user_with_no_last_interaction:1112:async (self, mock_session:AsyncMock, basic_user:MagicMock, mock_meta_prompt_service):mock_meta_prompt_service:Edge case: User has never interacted before.","test_empty_context_still_generates_valid_prompt:1132:async (self, mock_session:AsyncMock, mock_meta_prompt_service):mock_meta_prompt_service:Edge case: All optional context is empty."]]}],"t/db/integration/conftest.py":["p",["test_database_url:29:()>str::","engine:41:(test_database_url:str)::Create async engine for tests.","session_maker:51:(engine)>async_sessionmaker[AsyncSession]::Create session maker for tests.","session:61:async (session_maker)>AsyncGenerator[AsyncSession, None]:session_maker:","clean_session:75:async (session_maker)>AsyncGenerator[AsyncSession, None]:session_maker:","test_user_id:86:()>str::Generate a unique test user ID.","test_telegram_id:92:()>int::Generate a unique test Telegram ID."]],"t/db/integration/test_fulltext_search.py":["p",{"TestJSONBTextSearch":["29",["user:36:async (self, session:AsyncSession)>User::Create a test user.","conv_repo:45:async (self, session:AsyncSession)>ConversationRepository::Create ConversationRepository.","test_search_finds_message_content:52:async (self, conv_repo:ConversationRepository, user:User)::Search finds conversations containing specific text.","test_search_returns_empty_for_no_match:81:async (self, conv_repo:ConversationRepository, user:User)::Search returns empty list when no matches.","test_search_is_case_insensitive:104:async (self, conv_repo:ConversationRepository, user:User)::Search should work regardless of case (JSONB cast to text).","test_search_only_returns_user_conversations:126:async (self, session:AsyncSession)::Search should only return conversations for the specified user."]],"TestSearchVectorSetup":["169",["test_conversations_table_can_be_searched:177:async (self, session:AsyncSession)::Verify conversations table supports text search.","test_jsonb_to_text_cast_works:197:async (self, session:AsyncSession)::Verify PostgreSQL can cast JSONB to text for searching."]]}],"t/db/integration/test_migrations.py":["p",{"TestMigrationStatus":["24",["test_alembic_version_table_exists:28:async (self, session:AsyncSession)::Verify alembic_version table exists.","test_has_current_migration_version:48:async (self, session:AsyncSession)::Verify a migration version is recorded."]],"TestSchemaIntegrity":["62",["test_users_table_structure:69:async (self, session:AsyncSession)::Verify users table has expected columns.","test_user_metrics_table_structure:93:async (self, session:AsyncSession)::Verify user_metrics table has expected columns.","test_conversations_table_structure:115:async (self, session:AsyncSession)::Verify conversations table has expected columns.","test_score_history_table_structure:137:async (self, session:AsyncSession)::Verify score_history table has expected columns."]],"TestIndexesExist":["159",["test_users_telegram_id_index:163:async (self, session:AsyncSession)::Verify index on users.telegram_id exists.","test_score_history_user_id_index:181:async (self, session:AsyncSession)::Verify index on score_history.user_id exists."]],"TestForeignKeyConstraints":["199",["test_user_metrics_references_users:203:async (self, session:AsyncSession)::Verify user_metrics.user_id references users.id.","test_conversations_references_users:234:async (self, session:AsyncSession)::Verify conversations.user_id references users.id."]],"TestMigrationReversibility":["259",["test_migration_files_have_downgrade:269:(self)::Verify migration files have downgrade functions.","test_migration_files_are_ordered:290:(self)::Verify migration files have proper ordering."]]}],"t/db/integration/test_repositories_integration.py":["p",{"TestUserRepositoryIntegration":["38",["user_repo:42:async (self, session:AsyncSession)>UserRepository::Create UserRepository with test session.","test_create_user_with_metrics:49:async (self, user_repo:UserRepository, test_telegram_id:int)::AC-T14.1: Create user with metrics using real database.","test_get_by_telegram_id:66:async (self, user_repo:UserRepository, test_telegram_id:int)::AC-T14.1: Get user by Telegram ID.","test_update_score_atomically:83:async (self, user_repo:UserRepository, test_telegram_id:int)::AC-T14.3: Update score is atomic."]],"TestConversationRepositoryIntegration":["108",["user:112:async (self, session:AsyncSession)>User::Create a test user.","conv_repo:121:async (self, session:AsyncSession)>ConversationRepository::Create ConversationRepository with test session.","test_create_conversation:128:async (self, conv_repo:ConversationRepository, user:User)::AC-T14.1: Create conversation with real database.","test_append_message_to_jsonb:144:async (self, conv_repo:ConversationRepository, user:User)::AC-T14.1: Append message updates JSONB array.","test_get_recent_conversations:165:async (self, conv_repo:ConversationRepository, user:User)::AC-T14.1: Get recent conversations ordered by time."]],"TestTransactionAtomicity":["179",["test_rollback_on_error:186:async (self, session:AsyncSession, test_telegram_id:int)::Verify transaction rollback on error.","test_multiple_operations_in_transaction:211:async (self, session:AsyncSession, test_telegram_id:int)::Verify multiple operations are atomic."]],"TestMetricsIntegration":["243",["user:247:async (self, session:AsyncSession)>User::Create a test user with metrics.","test_update_metrics_with_clamping:258:async (self, session:AsyncSession, user:User)::AC-T14.3: Metrics updates are atomic with clamping.","test_calculate_composite_score:277:async (self, session:AsyncSession, user:User)::AC-T14.3: Composite score calculation."]],"TestVicePreferenceIntegration":["288",["user:292:async (self, session:AsyncSession)>User::Create a test user.","test_discover_and_update_intensity:303:async (self, session:AsyncSession, user:User)::AC-T14.3: Vice discovery and update are atomic."]],"TestDailySummaryIntegration":["322",["user:326:async (self, session:AsyncSession)>User::Create a test user.","test_create_and_get_summary:337:async (self, session:AsyncSession, user:User)::AC-T14.1: Create and retrieve daily summary.","test_get_range:357:async (self, session:AsyncSession, user:User)::AC-T14.1: Get summaries in date range."]]}],"t/db/integration/test_rls_policies.py":["p",{"TestRLSPoliciesExist":["28",["test_rls_enabled_on_users_table:35:async (self, session:AsyncSession)::Verify RLS is enabled on users table.","test_rls_enabled_on_user_metrics_table:56:async (self, session:AsyncSession)::Verify RLS is enabled on user_metrics table.","test_rls_enabled_on_conversations_table:77:async (self, session:AsyncSession)::Verify RLS is enabled on conversations table.","test_rls_enabled_on_score_history_table:98:async (self, session:AsyncSession)::Verify RLS is enabled on score_history table."]],"TestRLSPolicyRules":["119",["test_users_table_has_user_isolation_policy:123:async (self, session:AsyncSession)::Verify users table has user isolation policy.","test_user_metrics_has_user_isolation_policy:148:async (self, session:AsyncSession)::Verify user_metrics table has user isolation policy."]],"TestRLSServiceRoleBypass":["165",["test_service_role_can_create_user:175:async (self, session:AsyncSession, test_telegram_id:int)::Service role can create users (bypasses RLS).","test_service_role_can_read_all_users:189:async (self, session:AsyncSession)::Service role can read all users (bypasses RLS)."]],"TestRLSUserIsolation":["201",["test_user_cannot_see_other_users_data:212:async (self, session:AsyncSession)::"]]}],"t/db/repositories/test_base.py":["p",{"MockModel":["21",[]],"TestBaseRepository":["33",["mock_session:37:(self)>AsyncMock::Create a mock AsyncSession.","test_base_repository_accepts_async_session:51:(self, mock_session:AsyncMock)::AC-T1.1: BaseRepository class accepts AsyncSession in __init__.","test_base_repository_requires_session:61:(self)::AC-T1.1: BaseRepository requires session parameter.","test_base_repository_session_property:71:(self, mock_session:AsyncMock)::AC-T1.2: BaseRepository exposes session property for subclasses.","test_session_property_readonly:80:(self, mock_session:AsyncMock)::AC-T1.2: Session property should be read-only.","test_get_method_returns_entity:94:async (self, mock_session:AsyncMock)::AC-T1.3: get(id) returns entity by primary key.","test_get_method_returns_none_for_missing:109:async (self, mock_session:AsyncMock)::AC-T1.3: get(id) returns None if entity not found.","test_create_method_adds_entity:121:async (self, mock_session:AsyncMock)::AC-T1.3: create(entity) adds and returns entity.","test_update_method_flushes_changes:136:async (self, mock_session:AsyncMock)::AC-T1.3: update(entity) flushes entity changes.","test_delete_method_removes_entity:150:async (self, mock_session:AsyncMock)::AC-T1.3: delete(entity) removes entity from session.","test_delete_by_id_method:163:async (self, mock_session:AsyncMock)::AC-T1.3: delete_by_id(id) gets and deletes entity.","test_delete_by_id_returns_false_for_missing:181:async (self, mock_session:AsyncMock)::AC-T1.3: delete_by_id(id) returns False if entity not found."]],"TestBaseRepositorySubclassing":["194",["mock_session:198:(self)>AsyncMock::Create a mock AsyncSession.","test_subclass_can_access_session:202:(self, mock_session:AsyncMock):custom_method:Verify subclasses can access session via property.","custom_method:207:(self)::","test_subclass_inherits_crud:214:(self, mock_session:AsyncMock)::Verify subclasses inherit CRUD methods."]]}],"t/db/repositories/test_conversation_repository.py":["p",{"TestConversationRepository":["25",["mock_session:29:(self)>AsyncMock::Create a mock AsyncSession.","sample_conversation:40:(self)>Conversation::Create a sample Conversation entity.","test_create_conversation_basic:59:async (self, mock_session:AsyncMock)::AC-T4.1: create_conversation creates a new conversation.","test_create_conversation_with_boss_fight:80:async (self, mock_session:AsyncMock)::AC-T4.1: create_conversation with boss_fight flag.","test_create_conversation_defaults_started_at:102:async (self, mock_session:AsyncMock)::AC-T4.1: create_conversation defaults started_at to now.","test_append_message_adds_to_messages:125:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.2: append_message adds message to JSONB messages array.","test_append_message_without_analysis:147:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.2: append_message works without analysis parameter.","test_append_message_raises_if_not_found:163:async (self, mock_session:AsyncMock)::AC-T4.2: append_message raises ValueError if conversation not found.","test_get_recent_returns_conversations:182:async (self, mock_session:AsyncMock)::AC-T4.3: get_recent returns list of recent conversations.","test_get_recent_respects_limit:200:async (self, mock_session:AsyncMock)::AC-T4.3: get_recent respects the limit parameter.","test_get_recent_default_limit:217:async (self, mock_session:AsyncMock)::AC-T4.3: get_recent uses default limit of 10.","test_search_finds_conversations:236:async (self, mock_session:AsyncMock)::AC-T4.4: search finds conversations matching query.","test_search_returns_empty_for_no_match:254:async (self, mock_session:AsyncMock)::AC-T4.4: search returns empty list for no matches.","test_close_conversation_sets_ended_at:275:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.5: close_conversation sets ended_at timestamp.","test_close_conversation_with_score_delta:292:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.5: close_conversation sets score_delta when provided.","test_close_conversation_raises_if_not_found:307:async (self, mock_session:AsyncMock)::AC-T4.5: close_conversation raises ValueError if not found."]],"TestConversationRepositoryJSONB":["317",["mock_session:321:(self)>AsyncMock::Create a mock AsyncSession.","test_messages_start_as_empty_list:332:async (self, mock_session:AsyncMock)::Verify new conversations have empty messages array.","test_multiple_messages_can_be_appended:345:async (self, mock_session:AsyncMock)::Verify multiple messages can be appended sequentially."]]}],"t/db/repositories/test_metrics_repository.py":["p",{"TestUserMetricsRepository":["22",["mock_session:26:(self)>AsyncMock::Create a mock AsyncSession.","sample_metrics:35:(self)>UserMetrics::Create a sample UserMetrics entity.","test_get_by_user_id_returns_metrics:54:async (self, mock_session:AsyncMock, sample_metrics:UserMetrics)::AC-T3.1: get_by_user_id returns UserMetrics for user.","test_get_by_user_id_returns_none_if_not_found:71:async (self, mock_session:AsyncMock)::AC-T3.1: get_by_user_id returns None if user not found.","test_update_metrics_applies_deltas:88:async (self, mock_session:AsyncMock):__init__:AC-T3.2: update_metrics applies deltas to metrics.","__init__:134:(self)::","test_update_metrics_clamps_to_bounds:129:async (self, mock_session:AsyncMock):__init__:AC-T3.2: update_metrics clamps values to 0-100.","test_update_metrics_raises_if_not_found:161:async (self, mock_session:AsyncMock)::AC-T3.2: update_metrics raises ValueError if user not found.","test_calculate_composite_returns_score:178:async (self, mock_session:AsyncMock, sample_metrics:UserMetrics)::AC-T3.3: calculate_composite returns calculated score.","test_calculate_composite_raises_if_not_found:194:async (self, mock_session:AsyncMock)::AC-T3.3: calculate_composite raises ValueError if not found."]],"TestUserMetricsRepositoryHelpers":["206",["test_clamp_values:209:(self)::Verify _clamp helper clamps values correctly."]]}],"t/db/repositories/test_pending_registration_repository.py":["p",{"TestPendingRegistrationRepository":["17",["mock_session:21:(self)::Create a mock async session.","repository:27:(self, mock_session)::Create repository with mocked session.","test_ac_t046_2_store_creates_pending_registration:34:async (self, repository, mock_session)::","test_get_returns_registration_if_exists:68:async (self, repository, mock_session)::","test_get_returns_none_if_not_found:93:async (self, repository, mock_session)::","test_get_email_returns_email_string:113:async (self, repository, mock_session)::","test_get_email_returns_none_if_not_found:137:async (self, repository, mock_session)::","test_delete_removes_registration:155:async (self, repository, mock_session)::","test_delete_returns_false_if_not_found:176:async (self, repository, mock_session)::","test_ac_t046_5_cleanup_expired_deletes_old_registrations:194:async (self, repository, mock_session)::","test_store_with_custom_expiry:215:async (self, repository, mock_session)::"]]}],"t/db/repositories/test_score_history_repository.py":["p",{"TestScoreHistoryRepository":["23",["mock_session:27:(self)>AsyncMock::Create a mock AsyncSession.","sample_history_entries:37:(self)>list[ScoreHistory]::Create sample ScoreHistory entries for testing.","test_log_event_creates_record:57:async (self, mock_session:AsyncMock)::AC-T5.1: log_event creates a new history record.","test_log_event_without_optional_fields:82:async (self, mock_session:AsyncMock)::AC-T5.1: log_event works without optional event_type and event_details.","test_log_event_sets_recorded_at:98:async (self, mock_session:AsyncMock)::AC-T5.1: log_event automatically sets recorded_at timestamp.","test_log_event_supports_all_event_types:116:async (self, mock_session:AsyncMock)::AC-T5.1: log_event supports all event types.","test_get_history_returns_entries:141:async (self, mock_session:AsyncMock, sample_history_entries:list[ScoreHistory])::AC-T5.2: get_history returns list of history entries.","test_get_history_respects_limit:158:async (self, mock_session:AsyncMock)::AC-T5.2: get_history respects limit parameter.","test_get_history_default_limit:174:async (self, mock_session:AsyncMock)::AC-T5.2: get_history uses default limit of 50.","test_get_history_returns_empty_for_new_user:192:async (self, mock_session:AsyncMock)::AC-T5.2: get_history returns empty list for user with no history.","test_get_daily_stats_returns_stats:209:async (self, mock_session:AsyncMock)::AC-T5.3: get_daily_stats returns aggregated stats.","test_get_daily_stats_returns_empty_for_no_events:245:async (self, mock_session:AsyncMock)::AC-T5.3: get_daily_stats returns empty stats for no events.","test_get_daily_stats_handles_unknown_event_type:269:async (self, mock_session:AsyncMock)::AC-T5.3: get_daily_stats handles events without event_type."]],"TestScoreHistoryRepositoryExtras":["290",["mock_session:294:(self)>AsyncMock::Create a mock AsyncSession.","test_get_events_by_type:304:async (self, mock_session:AsyncMock)::Verify get_events_by_type filters by event type."]]}],"t/db/repositories/test_summary_repository.py":["p",{"TestDailySummaryRepository":["24",["mock_session:28:(self)>AsyncMock::Create a mock AsyncSession.","sample_summaries:39:(self)>list[DailySummary]::Create sample DailySummary entries.","test_create_summary_basic:63:async (self, mock_session:AsyncMock)::AC-T6.4: create_summary creates a new summary record.","test_create_summary_with_all_fields:82:async (self, mock_session:AsyncMock)::AC-T6.4: create_summary with all optional fields.","test_create_summary_sets_created_at:112:async (self, mock_session:AsyncMock)::AC-T6.4: create_summary sets created_at timestamp.","test_get_by_date_returns_summary:134:async (self, mock_session:AsyncMock, sample_summaries:list[DailySummary])::AC-T6.5: get_by_date returns summary for specific date.","test_get_by_date_returns_none_if_not_found:152:async (self, mock_session:AsyncMock)::AC-T6.5: get_by_date returns None if no summary for date.","test_get_range_returns_summaries:169:async (self, mock_session:AsyncMock, sample_summaries:list[DailySummary])::AC-T6.6: get_range returns list of summaries in range.","test_get_range_returns_empty_for_no_summaries:190:async (self, mock_session:AsyncMock)::AC-T6.6: get_range returns empty list if no summaries in range.","test_get_range_single_day:208:async (self, mock_session:AsyncMock)::AC-T6.6: get_range works for single day range."]],"TestDailySummaryRepositoryExtras":["225",["mock_session:229:(self)>AsyncMock::Create a mock AsyncSession.","test_update_summary_updates_fields:240:async (self, mock_session:AsyncMock):__init__:Verify update_summary updates specified fields.","__init__:274:(self)::","test_update_summary_partial_update:269:async (self, mock_session:AsyncMock):__init__:Verify update_summary allows partial updates.","test_update_summary_raises_if_not_found:295:async (self, mock_session:AsyncMock)::Verify update_summary raises ValueError if not found.","test_get_recent_returns_summaries:305:async (self, mock_session:AsyncMock)::Verify get_recent returns recent summaries.","test_get_recent_default_limit:323:async (self, mock_session:AsyncMock)::Verify get_recent uses default limit of 7."]],"TestDailySummaryRepositoryContextEngineering":["339",["mock_session:343:(self)>AsyncMock::Create a mock AsyncSession.","test_create_summary_with_context_fields:354:async (self, mock_session:AsyncMock)::AC-CE1: create_summary with context engineering fields.","test_update_summary_context_fields:379:async (self, mock_session:AsyncMock):__init__:AC-CE2: update_summary can update context engineering fields.","__init__:384:(self)::","test_get_range_returns_ordered_by_date:417:async (self, mock_session:AsyncMock)::AC-CE3: get_range returns summaries ordered by date ascending.","test_get_recent_returns_newest_first:443:async (self, mock_session:AsyncMock)::AC-CE4: get_recent returns summaries ordered by date descending."]]}],"t/db/repositories/test_thought_repository.py":["p",{"TestNikitaThoughtRepository":["26",["mock_session:30:(self)>AsyncMock::Create a mock AsyncSession.","test_create_thought_valid_types:46:async (self, mock_session:AsyncMock, thought_type:str):mock_create:AC-1: create_thought() creates all valid thought types.","mock_create:53:async (entity)::","test_create_thought_invalid_type_raises:73:async (self, mock_session:AsyncMock)::AC-2: create_thought() raises ValueError for invalid thought types.","test_get_active_thoughts_excludes_used:90:async (self, mock_session:AsyncMock)::AC-3a: get_active_thoughts() excludes thoughts that have used_at set.","test_get_active_thoughts_excludes_expired:116:async (self, mock_session:AsyncMock)::AC-3b: get_active_thoughts() excludes thoughts with past expires_at.","test_get_thoughts_for_prompt_groups_by_type:146:async (self, mock_session:AsyncMock):mock_get_active_thoughts:AC-4: get_thoughts_for_prompt() returns dict grouped by thought type.","mock_get_active_thoughts:169:async (user_id, thought_type=None, limit=3)::","test_mark_thought_used_sets_timestamp:188:async (self, mock_session:AsyncMock)::AC-5: mark_thought_used() sets used_at to current time.","test_mark_thought_used_not_found_raises:212:async (self, mock_session:AsyncMock)::AC-5b: mark_thought_used() raises ValueError if not found.","test_create_missing_him_thought_under_24h_returns_none:226:async (self, mock_session:AsyncMock)::AC-6a: create_missing_him_thought() returns None if < 24 hours.","test_create_missing_him_thought_24h:240:async (self, mock_session:AsyncMock):mock_create_thought:AC-6b: create_missing_him_thought() creates thought at 24-48h gap.","mock_create_thought:344:async (user_id, thought_type, content, source_conversation_id=None, expires_at=None)::","test_create_missing_him_thought_48h:270:async (self, mock_session:AsyncMock):mock_create_thought:AC-6c: create_missing_him_thought() creates stronger thought at 48-72h gap.","test_create_missing_him_thought_72h:299:async (self, mock_session:AsyncMock):mock_create_thought:AC-6d: create_missing_him_thought() creates strongest thought at 72h+ gap.","test_bulk_create_thoughts_creates_all:331:async (self, mock_session:AsyncMock):mock_create_thought:AC-7: bulk_create_thoughts() creates all thoughts.","test_expire_missing_him_thoughts_marks_used:370:async (self, mock_session:AsyncMock):mock_get_active:AC-7b: expire_missing_him_thoughts() marks all missing_him thoughts as used.","mock_get_active:394:async (user_id, thought_type=None, limit=100)::","test_cleanup_expired_thoughts_deletes:410:async (self, mock_session:AsyncMock)::AC-8: cleanup_expired_thoughts() deletes expired thoughts."]]}],"t/db/repositories/test_thread_repository.py":["p",{"TestConversationThreadRepository":["24",["mock_session:28:(self)>AsyncMock::Create a mock AsyncSession.","test_create_thread_valid_types:44:async (self, mock_session:AsyncMock, thread_type:str):mock_create:AC-1: create_thread() creates all valid thread types.","mock_create:52:async (entity)::","test_create_thread_invalid_type_raises:72:async (self, mock_session:AsyncMock)::AC-2: create_thread() raises ValueError for invalid thread types.","test_get_open_threads_returns_only_open:89:async (self, mock_session:AsyncMock)::AC-3: get_open_threads() returns only threads with status='open'.","test_get_open_threads_filters_by_type:116:async (self, mock_session:AsyncMock)::AC-3b: get_open_threads() can filter by thread_type.","test_get_threads_for_prompt_groups_by_type:144:async (self, mock_session:AsyncMock):mock_get_open_threads:AC-4: get_threads_for_prompt() returns dict grouped by thread type.","mock_get_open_threads:173:async (user_id, thread_type=None, limit=5)::","test_resolve_thread_sets_status_and_timestamp:196:async (self, mock_session:AsyncMock)::AC-5: resolve_thread() sets status='resolved' and resolved_at timestamp.","test_resolve_thread_not_found_raises:222:async (self, mock_session:AsyncMock)::AC-5b: resolve_thread() raises ValueError if thread not found.","test_expire_thread_sets_expired_status:233:async (self, mock_session:AsyncMock)::AC-5c: expire_thread() sets status='expired' and resolved_at.","test_bulk_create_threads_creates_all:259:async (self, mock_session:AsyncMock):mock_create_thread:AC-6: bulk_create_threads() creates all threads.","mock_create_thread:272:async (user_id, thread_type, content, source_conversation_id=None)::","test_bulk_resolve_threads_resolves_found:298:async (self, mock_session:AsyncMock):mock_resolve_thread:AC-6b: bulk_resolve_threads() resolves found threads and skips missing.","mock_resolve_thread:308:async (thread_id)::"]]}],"t/db/repositories/test_user_repository.py":["p",{"TestUserRepository":["22",["mock_session:26:(self)>AsyncMock::Create a mock AsyncSession.","test_get_returns_user_with_metrics:43:async (self, mock_session:AsyncMock)::AC-T2.1: get(user_id) returns User with eager-loaded metrics.","test_get_returns_none_for_missing:64:async (self, mock_session:AsyncMock)::AC-T2.1: get(user_id) returns None if user not found.","test_get_by_telegram_id_returns_user:81:async (self, mock_session:AsyncMock)::AC-T2.2: get_by_telegram_id(telegram_id) returns User.","test_get_by_telegram_id_returns_none:100:async (self, mock_session:AsyncMock)::AC-T2.2: get_by_telegram_id returns None if not found.","test_create_creates_user_and_metrics:117:async (self, mock_session:AsyncMock)::AC-T2.3: create() creates User + UserMetrics atomically.","test_create_sets_default_metrics:135:async (self, mock_session:AsyncMock)::AC-T2.3: create() sets default metrics values (50.00).","test_update_score_updates_user_and_logs:152:async (self, mock_session:AsyncMock)::AC-T2.4: update_score updates user score and logs to history.","test_update_score_clamps_to_100:179:async (self, mock_session:AsyncMock)::AC-T2.4: update_score clamps score to max 100.","test_update_score_clamps_to_0:197:async (self, mock_session:AsyncMock)::AC-T2.4: update_score clamps score to min 0.","test_apply_decay_reduces_score:218:async (self, mock_session:AsyncMock)::AC-T2.5: apply_decay reduces score by decay amount.","test_apply_decay_logs_event:236:async (self, mock_session:AsyncMock)::AC-T2.5: apply_decay logs decay event to score_history.","test_advance_chapter_increments:264:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter increments chapter by 1.","test_advance_chapter_caps_at_5:282:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter does not exceed chapter 5.","test_advance_chapter_logs_event:300:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter logs chapter_advance event.","test_advance_chapter_resets_boss_attempts:319:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter resets boss_attempts to 0.","test_update_last_interaction_updates_timestamp:342:async (self, mock_session:AsyncMock)::AC-T3.1/T3.2: update_last_interaction updates last_interaction_at.","test_update_last_interaction_uses_current_time_if_none:364:async (self, mock_session:AsyncMock)::AC-T3.1: update_last_interaction uses current time if not specified.","test_update_last_interaction_raises_for_missing_user:386:async (self, mock_session:AsyncMock)::AC-T3.1: update_last_interaction raises ValueError if user not found."]]}],"t/db/repositories/test_vice_repository.py":["p",{"TestVicePreferenceRepository":["23",["mock_session:27:(self)>AsyncMock::Create a mock AsyncSession.","sample_preferences:38:(self)>list[UserVicePreference]::Create sample UserVicePreference entries.","test_get_active_returns_preferences:60:async (self, mock_session:AsyncMock, sample_preferences:list[UserVicePreference])::AC-T6.1: get_active returns list of active preferences.","test_get_active_returns_empty_for_new_user:79:async (self, mock_session:AsyncMock)::AC-T6.1: get_active returns empty list for user with no preferences.","test_get_by_category_returns_preference:95:async (self, mock_session:AsyncMock, sample_preferences:list[UserVicePreference])::AC-T6.1: get_by_category returns preference for category.","test_get_by_category_returns_none_if_not_found:113:async (self, mock_session:AsyncMock)::AC-T6.1: get_by_category returns None if not found.","test_update_intensity_applies_positive_delta:130:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity applies positive delta.","__init__:197:(self)::","test_update_intensity_applies_negative_delta:152:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity applies negative delta.","test_update_intensity_clamps_to_max_5:172:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity clamps to maximum of 5.","test_update_intensity_clamps_to_min_1:192:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity clamps to minimum of 1.","test_update_intensity_raises_if_not_found:212:async (self, mock_session:AsyncMock)::AC-T6.2: update_intensity raises ValueError if not found.","test_discover_creates_new_preference:227:async (self, mock_session:AsyncMock)::AC-T6.3: discover creates new preference if not exists.","test_discover_returns_existing_preference:250:async (self, mock_session:AsyncMock, sample_preferences:list[UserVicePreference])::AC-T6.3: discover returns existing preference if already exists.","test_discover_with_custom_intensity:269:async (self, mock_session:AsyncMock)::AC-T6.3: discover with custom initial_intensity."]],"TestVicePreferenceRepositoryExtras":["284",["mock_session:288:(self)>AsyncMock::Create a mock AsyncSession.","test_update_engagement_applies_delta:299:async (self, mock_session:AsyncMock):__init__:Verify update_engagement applies delta to engagement_score.","__init__:325:(self)::","test_update_engagement_clamps_to_zero:320:async (self, mock_session:AsyncMock):__init__:Verify update_engagement doesn't go below zero.","test_update_engagement_raises_if_not_found:340:async (self, mock_session:AsyncMock)::Verify update_engagement raises ValueError if not found."]]}],"t/engine/decay/test_calculator.py":["p",["create_mock_user:25:(*, chapter:int = 1, relationship_score:Decimal = Decimal(\"50.0\"), last_interaction_at:datetime | None = None, game_status:str = \"active\",)>MagicMock::Create a mock user with specified attributes."],{"TestDecayCalculatorIsOverdue":["36",["test_is_overdue_no_interaction_returns_true:39:(self):create_mock_user:User with no last_interaction_at is considered overdue.","test_is_overdue_within_grace_returns_false:46:(self):create_mock_user:User within grace period is NOT overdue.","test_is_overdue_past_grace_returns_true:55:(self):create_mock_user:User past grace period IS overdue.","test_is_overdue_just_inside_grace_returns_false:64:(self):create_mock_user:User just inside grace period is NOT overdue.","test_is_overdue_respects_chapter_grace_periods:84:(self, chapter:int, grace_hours:int):create_mock_user:Each chapter has correct grace period from GRACE_PERIODS."]],"TestDecayCalculatorCalculateDecay":["99",["test_calculate_decay_within_grace_returns_none:102:(self):create_mock_user:No decay if user is within grace period.","test_calculate_decay_past_grace_returns_decay_result:116:(self):create_mock_user:Returns DecayResult when user is past grace.","test_calculate_decay_correct_amount_ch1:134:(self):create_mock_user:Ch1: 2h overdue \u00d7 0.8%/h = 1.6% decay.","test_calculate_decay_correct_amount_ch1_10h_overdue:155:(self):create_mock_user:Ch1: 10h overdue \u00d7 0.8%/h = 8.0% decay.","test_calculate_decay_uses_chapter_specific_rates:185:(self, chapter:int, rate:Decimal):create_mock_user:Each chapter uses correct decay rate from DECAY_RATES.","test_calculate_decay_capped_at_max:206:(self):create_mock_user:Decay capped at MAX_DECAY_PER_CYCLE (default 20%).","test_calculate_decay_configurable_max:226:(self):create_mock_user:Max decay can be configured.","test_calculate_decay_floor_at_zero:246:(self):create_mock_user:Score floors at 0 when decay exceeds score.","test_calculate_decay_game_over_triggered_at_zero:267:(self):create_mock_user:game_over_triggered is True when score reaches 0.","test_calculate_decay_no_game_over_when_score_above_zero:285:(self):create_mock_user:game_over_triggered is False when score remains above 0.","test_calculate_decay_includes_hours_overdue:304:(self):create_mock_user:DecayResult includes hours_overdue for audit trail.","test_calculate_decay_includes_timestamp:322:(self):create_mock_user:DecayResult includes calculation timestamp.","test_calculate_decay_sets_decay_reason:342:(self):create_mock_user:DecayResult includes decay_reason='inactivity'."]],"TestDecayCalculatorDefaultMaxDecay":["359",["test_default_max_decay_is_20:362:(self)::Default MAX_DECAY_PER_CYCLE is 20%.","test_custom_max_decay_accepted:368:(self)::Custom max_decay_per_cycle is accepted."]]}],"t/engine/decay/test_models.py":["p",{"TestDecayResult":["17",["test_valid_decay_result:20:(self)::Test creating a valid DecayResult with all required fields.","test_decay_result_with_game_over:40:(self)::Test DecayResult when game_over is triggered.","test_decay_result_with_decay_reason:55:(self)::Test DecayResult with optional decay_reason field.","test_decay_amount_must_be_positive:69:(self)::Test that decay_amount must be positive (or zero).","test_score_after_cannot_exceed_score_before:96:(self)::Test score_after should not be greater than score_before.","test_score_after_cannot_be_negative:110:(self)::Test score_after must be >= 0 (floor at 0).","test_chapter_bounds:123:(self)::Test chapter must be 1-5.","test_hours_overdue_non_negative:162:(self)::Test hours_overdue must be >= 0.","test_timestamp_required:175:(self)::Test timestamp is a required field.","test_decimal_precision:189:(self)::Test that decimal fields support precision."]]}],"t/engine/decay/test_processor.py":["p",["create_mock_user:29:(*, user_id=None, chapter:int = 1, relationship_score:Decimal = Decimal(\"50.0\"), last_interaction_at:datetime | None = None, game_status:str = \"active\",)>MagicMock::Create a mock user with specified attributes."],{"TestDecayProcessorShouldSkipUser":["40",["test_skip_boss_fight_status:44:async (self):create_mock_user:AC-T7.2: Skip users in boss_fight status.","test_skip_game_over_status:58:async (self):create_mock_user:AC-T7.2: Skip users in game_over status.","test_skip_won_status:72:async (self):create_mock_user:AC-T7.2: Skip users in won status.","test_process_active_status:86:async (self):create_mock_user:AC-T5.2: Process users with active status."]],"TestDecayProcessorProcessUser":["100",["test_process_user_applies_decay_when_overdue:104:async (self):create_mock_user:AC-T5.4: Apply decay to users past grace period.","test_process_user_returns_none_when_within_grace:134:async (self):create_mock_user:AC-T5.4: No decay for users within grace period.","test_process_user_logs_decay_event:162:async (self):create_mock_user:AC-T6.1: Log decay event to score_history.","test_process_user_skips_boss_fight:193:async (self):create_mock_user:AC-T7.1/T7.2: Skip users in boss_fight status."]],"TestDecayProcessorProcessAll":["221",["test_process_all_returns_summary:225:async (self):create_mock_user:AC-T5.5: Return summary with processed, decayed, game_overs counts.","test_process_all_filters_inactive_statuses:267:async (self)::AC-T5.2: Filter out boss_fight, game_over, won statuses.","test_process_all_tracks_game_overs:290:async (self):create_mock_user:AC-T5.5: Track game_overs count in summary."]],"TestDecayProcessorBatchSize":["328",["test_default_batch_size:332:async (self)::AC-T5.3: Default batch size is reasonable.","test_configurable_batch_size:345:async (self)::AC-T5.3: Batch size is configurable."]],"TestDecayProcessorNoCatchUp":["359",["test_no_catch_up_decay_after_boss_resolved:363:async (self):create_mock_user:AC-T7.3: No catch-up on missed decay after boss resolved."]]}],"t/engine/engagement/test_calculator.py":["p",{"TestOptimalFrequencyCalculatorClass":["17",["test_ac_3_1_1_class_exists_in_calculator_module:20:(self)::AC-3.1.1: OptimalFrequencyCalculator class in calculator.py.","test_calculator_has_get_optimal_method:26:(self)::OptimalFrequencyCalculator has get_optimal() method."]],"TestBaseOptimalFrequency":["35",["test_ac_3_1_2_base_optimal_chapter_1:38:(self)::AC-3.1.2: Chapter 1 base optimal = 15 messages/day.","test_ac_3_1_2_base_optimal_chapter_2:48:(self)::AC-3.1.2: Chapter 2 base optimal = 12 messages/day.","test_ac_3_1_2_base_optimal_chapter_3:57:(self)::AC-3.1.2: Chapter 3 base optimal = 10 messages/day.","test_ac_3_1_2_base_optimal_chapter_4:66:(self)::AC-3.1.2: Chapter 4 base optimal = 8 messages/day.","test_ac_3_1_2_base_optimal_chapter_5:74:(self)::AC-3.1.2: Chapter 5 base optimal = 6 messages/day."]],"TestDayModifier":["83",["test_ac_3_1_3_day_modifier_monday:86:(self)::AC-3.1.3: Monday modifier = 0.9.","test_ac_3_1_3_day_modifier_saturday:96:(self)::AC-3.1.3: Saturday modifier = 1.2.","test_ac_3_1_3_day_modifier_sunday:106:(self)::AC-3.1.3: Sunday modifier = 1.1."]],"TestGetOptimalMethod":["116",["test_ac_3_1_4_returns_messages_per_day:119:(self)::AC-3.1.4: get_optimal(chapter, day_of_week) returns messages/day."]],"TestToleranceBand":["130",["test_ac_3_1_5_tolerance_chapter_1:133:(self)::AC-3.1.5: Chapter 1 tolerance = \u00b110%.","test_ac_3_1_5_tolerance_chapter_2:142:(self)::AC-3.1.5: Chapter 2 tolerance = \u00b115%.","test_ac_3_1_5_tolerance_chapter_3:151:(self)::AC-3.1.5: Chapter 3 tolerance = \u00b120%.","test_ac_3_1_5_tolerance_chapter_4:160:(self)::AC-3.1.5: Chapter 4 tolerance = \u00b125%.","test_ac_3_1_5_tolerance_chapter_5:169:(self)::AC-3.1.5: Chapter 5 tolerance = \u00b130%."]],"TestGetBounds":["179",["test_ac_3_1_6_returns_lower_upper_tuple:182:(self)::AC-3.1.6: get_bounds(chapter, day_of_week) returns (lower, upper).","test_bounds_reflect_tolerance:193:(self)::Bounds reflect tolerance percentage."]],"TestCalibrationCalculatorClass":["214",["test_ac_3_2_1_class_exists_in_calculator_module:217:(self)::AC-3.2.1: CalibrationCalculator class in calculator.py.","test_calculator_has_compute_method:223:(self)::CalibrationCalculator has compute() method."]],"TestFrequencyComponent":["232",["test_ac_3_2_2_frequency_component_method_exists:235:(self)::AC-3.2.2: _frequency_component() method exists.","test_frequency_component_perfect_match:242:(self)::Perfect frequency match returns 1.0.","test_frequency_component_half_optimal:254:(self)::Half of optimal returns 0.5.","test_frequency_component_double_optimal:266:(self)::Double optimal returns 0.0 (capped deviation)."]],"TestTimingComponent":["279",["test_ac_3_2_3_timing_component_method_exists:282:(self)::AC-3.2.3: _timing_component() method exists.","test_timing_component_good_timing:289:(self)::Good response timing returns high score.","test_timing_component_too_fast:300:(self)::Too-fast timing returns medium score (slightly clingy).","test_timing_component_too_slow:311:(self)::Too-slow timing returns low score (neglecting)."]],"TestContentComponent":["323",["test_ac_3_2_4_content_component_method_exists:326:(self)::AC-3.2.4: _content_component() method exists.","test_content_component_good_quality:333:(self)::Good conversation quality returns high score.","test_content_component_poor_quality:346:(self)::Poor conversation quality returns low score."]],"TestComputeMethod":["360",["test_ac_3_2_5_compute_returns_calibration_result:363:(self)::AC-3.2.5: compute(player_metrics) returns CalibrationResult.","test_ac_3_2_6_score_clamped_0_to_1:385:(self)::AC-3.2.6: Score clamped to [0, 1] range."]],"TestComponentWeights":["415",["test_weights_sum_to_1:418:(self)::Component weights: 40% frequency + 30% timing + 30% content = 100%."]],"TestStateMapping":["435",["test_ac_3_3_1_map_score_to_state_exists:438:(self)::AC-3.3.1: map_score_to_state() function defined.","test_ac_3_3_2_high_score_in_zone:445:(self)::AC-3.3.2: Score >= 0.8 \u2192 IN_ZONE candidate.","test_ac_3_3_3_medium_score_drifting:457:(self)::AC-3.3.3: Score 0.5-0.8 \u2192 DRIFTING candidate.","test_ac_3_3_4_low_score_clingy:469:(self)::AC-3.3.4: Score 0.3-0.5 with clingy \u2192 CLINGY.","test_ac_3_3_4_low_score_distant:481:(self)::AC-3.3.4: Score 0.3-0.5 with neglecting \u2192 DISTANT.","test_ac_3_3_5_very_low_score_out_of_zone:493:(self)::AC-3.3.5: Score < 0.3 \u2192 OUT_OF_ZONE candidate.","test_neutral_low_score_drifting:505:(self)::Low score without clinginess or neglect \u2192 DRIFTING."]],"TestCalibrationResultSuggestedState":["519",["test_calibration_result_includes_suggested_state:522:(self)::CalibrationResult includes correct suggested_state.","test_poor_metrics_suggest_out_of_zone:540:(self)::Poor metrics should suggest OUT_OF_ZONE."]]}],"t/engine/engagement/test_detection.py":["p",{"TestClinginessDetectorClass":["19",["test_ac_2_1_1_class_exists_in_detection_module:22:(self)::AC-2.1.1: ClinginessDetector class in detection.py.","test_clinginess_detector_has_detect_method:28:(self)::ClinginessDetector has detect() method."]],"TestClinginessFrequencySignal":["37",["test_ac_2_1_2_frequency_signal_method_exists:40:(self)::AC-2.1.2: _frequency_signal() compares to clinginess_threshold.","test_frequency_signal_returns_decimal:47:(self)::Frequency signal returns Decimal 0-1.","test_frequency_signal_high_when_excessive:61:(self)::High frequency (2x+ optimal) returns high signal.","test_frequency_signal_low_when_normal:74:(self)::Normal frequency returns low signal."]],"TestClinginessDoubleTextSignal":["88",["test_ac_2_1_3_double_text_signal_method_exists:91:(self)::AC-2.1.3: _double_text_signal() detects multiple messages before response.","test_double_text_high_with_many_consecutive:98:(self)::Many consecutive messages without response = high signal.","test_double_text_low_with_normal_pattern:110:(self)::Normal back-and-forth = low signal."]],"TestClinginessResponseTimeSignal":["123",["test_ac_2_1_4_response_time_signal_method_exists:126:(self)::AC-2.1.4: _response_time_signal() flags < 30 second responses.","test_response_time_high_when_instant:133:(self)::Instant responses (< 30s) = high signal.","test_response_time_low_when_normal:144:(self)::Normal response times (5+ minutes) = low signal."]],"TestClinginessLengthRatioSignal":["156",["test_ac_2_1_5_length_ratio_signal_method_exists:159:(self)::AC-2.1.5: _length_ratio_signal() compares to Nikita's average.","test_length_ratio_high_when_excessive:166:(self)::Long messages compared to Nikita = high signal.","test_length_ratio_low_when_balanced:178:(self)::Balanced message lengths = low signal."]],"TestClinginessDetectMethod":["190",["test_ac_2_1_6_detect_returns_clinginess_result:193:(self)::AC-2.1.6: detect() returns ClinginessResult with score and signals.","test_ac_2_1_7_score_weights_applied:216:(self)::AC-2.1.7: Score weights: frequency=0.35, double_text=0.20, response=0.15, len...","test_ac_2_1_8_is_clingy_threshold_0_7:241:(self)::AC-2.1.8: is_clingy = True when score > 0.7."]],"TestNeglectDetectorClass":["281",["test_ac_2_2_1_class_exists_in_detection_module:284:(self)::AC-2.2.1: NeglectDetector class in detection.py.","test_neglect_detector_has_detect_method:290:(self)::NeglectDetector has detect() method."]],"TestNeglectFrequencySignal":["299",["test_ac_2_2_2_frequency_signal_method_exists:302:(self)::AC-2.2.2: _frequency_signal() compares to neglect_threshold.","test_frequency_signal_high_when_too_low:309:(self)::Low frequency (< half optimal) = high signal.","test_frequency_signal_low_when_normal:322:(self)::Normal frequency = low signal."]],"TestNeglectResponseTimeSignal":["335",["test_ac_2_2_3_response_time_signal_method_exists:338:(self)::AC-2.2.3: _response_time_signal() flags > 4 hour responses.","test_response_time_high_when_slow:345:(self)::Slow responses (> 4 hours) = high signal.","test_response_time_low_when_normal:356:(self)::Normal response times = low signal."]],"TestNeglectShortMessageSignal":["367",["test_ac_2_2_4_short_message_signal_method_exists:370:(self)::AC-2.2.4: _short_message_signal() flags < 20 char average.","test_short_message_high_when_terse:377:(self)::Very short messages (< 20 chars) = high signal.","test_short_message_low_when_normal:387:(self)::Normal length messages = low signal."]],"TestNeglectAbruptEndingSignal":["398",["test_ac_2_2_5_abrupt_ending_signal_method_exists:401:(self)::AC-2.2.5: _abrupt_ending_signal() detects conversation endings.","test_abrupt_ending_high_with_many:408:(self)::Many abrupt endings = high signal.","test_abrupt_ending_low_when_rare:420:(self)::Few abrupt endings = low signal."]],"TestNeglectDetectMethod":["432",["test_ac_2_2_6_detect_returns_neglect_result:435:(self)::AC-2.2.6: detect() returns NeglectResult with score and signals.","test_ac_2_2_7_score_weights_applied:457:(self)::AC-2.2.7: Score weights: frequency=0.35, slow=0.20, short=0.15, endings=0.10,...","test_ac_2_2_8_is_neglecting_threshold_0_6:480:(self)::AC-2.2.8: is_neglecting = True when score > 0.6."]],"TestLLMAnalysisFunctions":["518",["test_ac_2_3_1_analyze_neediness_function_exists:521:(self)::AC-2.3.1: analyze_neediness() function defined.","test_ac_2_3_2_uses_pydantic_ai_structured_output:528:(self)::AC-2.3.2: Uses Pydantic AI structured output.","test_ac_2_3_3_returns_score_0_to_1:539:async (self)::AC-2.3.3: Returns score 0-1 for needy language patterns.","test_ac_2_3_4_analyze_distraction_function_exists:555:(self)::AC-2.3.4: analyze_distraction() function defined.","test_ac_2_3_5_distraction_returns_score_0_to_1:563:async (self)::AC-2.3.5: Returns score 0-1 for distracted patterns.","test_ac_2_3_6_results_cached_per_session:580:async (self):mock_llm:AC-2.3.6: Results cached per session to reduce API calls.","mock_llm:592:async (*args, **kwargs)::"]],"TestNeedyLanguagePatterns":["615",["test_high_neediness_for_desperate_messages:619:async (self)::Desperate/clingy messages score high.","test_low_neediness_for_confident_messages:640:async (self)::Confident/casual messages score low."]],"TestDistractedLanguagePatterns":["659",["test_high_distraction_for_dismissive_messages:663:async (self)::Dismissive/terse messages score high.","test_low_distraction_for_engaged_messages:683:async (self)::Engaged/thoughtful messages score low."]]}],"t/engine/engagement/test_integration.py":["p",{"TestFullMessageFlow":["29",["test_new_user_calibrating_flow:32:(self)::New user starts in CALIBRATING with 0.9x multiplier.","test_user_reaches_in_zone_after_good_scores:61:(self)::User transitions to IN_ZONE after 3 consecutive high scores.","test_clingy_detection_affects_state:90:(self)::Clingy behavior triggers state change with multiplier reduction.","test_neglect_detection_affects_state:136:(self)::Neglect behavior triggers DISTANT state."]],"TestChapterTransitionFlow":["182",["test_chapter_change_resets_engagement:185:(self)::Chapter change resets engagement to CALIBRATING.","test_chapter_change_from_clingy_resets:202:(self)::Even CLINGY state resets on chapter change.","test_optimal_frequency_changes_per_chapter:214:(self)::Optimal frequency decreases as chapters progress."]],"TestRecoveryFlow":["226",["test_full_clingy_recovery_flow:229:(self)::Complete flow: CLINGY \u2192 recovery action \u2192 check \u2192 transition.","test_out_of_zone_recovery_to_calibrating:268:(self)::OUT_OF_ZONE recovers back to CALIBRATING."]],"TestMultiDaySimulation":["305",["test_week_of_good_engagement:308:(self)::Simulate a week of good engagement - reach IN_ZONE.","test_week_of_clingy_behavior_triggers_game_over_warning:340:(self)::5 consecutive clingy days triggers warning (7 = game over).","test_gradual_score_decline_simulation:359:(self)::Simulate gradual decline: IN_ZONE \u2192 DRIFTING \u2192 recovery.","test_transition_history_captures_journey:408:(self)::Verify transition history captures full journey."]],"TestMapScoreToState":["451",["test_high_score_maps_to_in_zone:459:(self)::High score without clingy/neglect \u2192 IN_ZONE.","test_clingy_flag_with_low_score_maps_to_clingy:468:(self)::Clingy flag with score 0.3-0.5 \u2192 CLINGY.","test_neglecting_flag_with_low_score_maps_to_distant:477:(self)::Neglecting flag with score 0.3-0.5 \u2192 DISTANT.","test_mid_score_maps_to_drifting:486:(self)::Mid score without flags \u2192 DRIFTING.","test_very_low_score_maps_to_out_of_zone:495:(self)::Very low score \u2192 OUT_OF_ZONE."]]}],"t/engine/engagement/test_models.py":["p",{"TestEngagementStateEnum":["11",["test_ac_1_2_1_enum_has_six_values:14:(self)::AC-1.2.1: EngagementState enum with 6 values.","test_ac_1_2_2_calibrating_state:20:(self)::AC-1.2.2: CALIBRATING state exists with correct value.","test_ac_1_2_3_in_zone_state:26:(self)::AC-1.2.3: IN_ZONE state exists with correct value.","test_ac_1_2_4_drifting_state:32:(self)::AC-1.2.4: DRIFTING state exists with correct value.","test_ac_1_2_5_clingy_state:38:(self)::AC-1.2.5: CLINGY state exists with correct value.","test_ac_1_2_6_distant_state:44:(self)::AC-1.2.6: DISTANT state exists with correct value.","test_ac_1_2_7_out_of_zone_state:50:(self)::AC-1.2.7: OUT_OF_ZONE state exists with correct value.","test_ac_1_2_8_get_multiplier_returns_correct_values:56:(self)::AC-1.2.8: get_multiplier() method returns correct value per state.","test_is_healthy_property:74:(self)::Test is_healthy property for engagement states."]],"TestEngagementModuleStructure":["89",["test_ac_1_1_1_module_directory_exists:92:(self)::AC-1.1.1: nikita/engine/engagement/ directory exists.","test_ac_1_1_2_module_exports_key_classes:98:(self)::AC-1.1.2: Module exports EngagementEngine, EngagementState.","test_ac_1_1_3_models_file_exists:105:(self)::AC-1.1.3: models.py file created with base imports.","test_ac_1_1_4_module_importable_without_errors:111:(self)::AC-1.1.4: Module importable without errors."]],"TestEngagementPydanticModels":["119",["test_engagement_snapshot_model_exists:122:(self)::EngagementSnapshot Pydantic model exists.","test_engagement_snapshot_fields:128:(self)::EngagementSnapshot has required fields.","test_clinginess_result_model_exists:147:(self)::ClinginessResult Pydantic model exists.","test_clinginess_result_fields:153:(self)::ClinginessResult has required fields.","test_neglect_result_model_exists:173:(self)::NeglectResult Pydantic model exists.","test_neglect_result_fields:179:(self)::NeglectResult has required fields."]],"TestClinginessThreshold":["200",["test_clinginess_threshold_at_0_7:203:(self)::Clinginess threshold is 0.7."]],"TestNeglectThreshold":["224",["test_neglect_threshold_at_0_6:227:(self)::Neglect threshold is 0.6."]]}],"t/engine/engagement/test_recovery.py":["p",{"TestRecoveryManagerClass":["21",["test_ac_5_1_1_class_exists_in_recovery_module:24:(self)::AC-5.1.1: RecoveryManager class in recovery.py.","test_recovery_manager_has_get_recovery_action_method:30:(self)::RecoveryManager has get_recovery_action() method."]],"TestGetRecoveryAction":["39",["test_ac_5_1_2_get_recovery_action_returns_required_action:42:(self)::AC-5.1.2: get_recovery_action(state) returns required action.","test_ac_5_1_3_clingy_recovery_give_space_24h:53:(self)::AC-5.1.3: CLINGY recovery: Give space for 24 hours.","test_ac_5_1_4_distant_recovery_engage_12h:63:(self)::AC-5.1.4: DISTANT recovery: Engage meaningfully within 12 hours.","test_out_of_zone_recovery_action:73:(self)::OUT_OF_ZONE has specific recovery action.","test_healthy_states_have_no_recovery:83:(self)::Healthy states (CALIBRATING, IN_ZONE) return None."]],"TestCheckRecoveryComplete":["96",["test_ac_5_1_5_check_recovery_complete_method_exists:99:(self)::AC-5.1.5: check_recovery_complete(user_id) validates action taken.","test_clingy_recovery_complete_after_24h_silence:107:(self)::CLINGY recovery complete after 24h without excessive messaging.","test_clingy_recovery_not_complete_if_still_messaging_too_much:122:(self)::CLINGY recovery not complete if still messaging excessively.","test_distant_recovery_complete_with_meaningful_engagement:137:(self)::DISTANT recovery complete with meaningful engagement in 12h.","test_distant_recovery_not_complete_with_terse_messages:153:(self)::DISTANT recovery not complete with only terse messages.","test_ac_5_1_6_grace_period_enforced:169:(self)::AC-5.1.6: Grace period enforced before state reset."]],"TestCheckPointOfNoReturn":["191",["test_ac_5_2_1_check_point_of_no_return_method_exists:194:(self)::AC-5.2.1: check_point_of_no_return(user_id) method.","test_ac_5_2_2_clingy_7_days_game_over:202:(self)::AC-5.2.2: Clingy: 7 consecutive days \u2192 GAME_OVER.","test_clingy_6_days_not_game_over:217:(self)::6 consecutive clingy days is not game over yet.","test_ac_5_2_3_distant_10_days_game_over:230:(self)::AC-5.2.3: Distant: 10 consecutive days \u2192 GAME_OVER.","test_distant_9_days_not_game_over:245:(self)::9 consecutive distant days is not game over yet.","test_out_of_zone_extends_game_over_threshold:258:(self)::OUT_OF_ZONE state has its own game over trigger.","test_healthy_states_never_game_over:273:(self)::Healthy states never trigger game over."]],"TestGameOverResult":["293",["test_ac_5_2_4_game_over_triggers_status:296:(self)::AC-5.2.4: Game over triggers game_status = 'game_over'.","test_ac_5_2_5_game_over_reason_stored:309:(self)::AC-5.2.5: Game over reason stored."]],"TestRecoveryIntegration":["327",["test_full_clingy_recovery_flow:330:(self)::Full flow: CLINGY \u2192 recovery action \u2192 check complete \u2192 reset.","test_full_distant_recovery_flow:348:(self)::Full flow: DISTANT \u2192 recovery action \u2192 check complete \u2192 reset.","test_approaching_game_over_warning:367:(self)::Check if approaching game over (5 of 7 clingy days)."]]}],"t/engine/engagement/test_state_machine.py":["p",{"TestEngagementStateMachineClass":["21",["test_ac_4_1_1_class_exists_in_state_machine_module:24:(self)::AC-4.1.1: EngagementStateMachine class in state_machine.py.","test_state_machine_has_update_method:30:(self)::EngagementStateMachine has update() method."]],"TestCurrentStateProperty":["39",["test_ac_4_1_3_current_state_property:42:(self)::AC-4.1.3: current_state property returns EngagementState.","test_default_state_is_calibrating:50:(self)::Default state is CALIBRATING."]],"TestCurrentMultiplierProperty":["58",["test_ac_4_1_4_current_multiplier_property:61:(self)::AC-4.1.4: current_multiplier property returns Decimal.","test_calibrating_multiplier_is_0_9:69:(self)::CALIBRATING state has multiplier 0.9."]],"TestUpdateMethod":["77",["test_ac_4_1_5_update_evaluates_transitions:80:(self)::AC-4.1.5: update(calibration_result) evaluates transitions.","test_update_returns_transition_when_state_changes:100:(self)::update() returns StateTransition when state changes."]],"TestCalibratingToInZone":["131",["test_ac_4_2_1_calibrating_to_in_zone_after_3_consecutive:134:(self)::AC-4.2.1: CALIBRATING \u2192 IN_ZONE: score >= 0.8 for 3+ consecutive."]],"TestCalibratingToDrifting":["158",["test_ac_4_2_2_calibrating_to_drifting_after_2_low_scores:161:(self)::AC-4.2.2: CALIBRATING \u2192 DRIFTING: score < 0.5 for 2+ consecutive."]],"TestInZoneToDrifting":["181",["test_ac_4_2_3_in_zone_to_drifting_on_low_score:184:(self)::AC-4.2.3: IN_ZONE \u2192 DRIFTING: score < 0.6 for 1+ exchange."]],"TestDriftingToInZone":["202",["test_ac_4_2_4_drifting_to_in_zone_after_2_high_scores:205:(self)::AC-4.2.4: DRIFTING \u2192 IN_ZONE: score >= 0.7 for 2+ exchanges."]],"TestDriftingToClingy":["225",["test_ac_4_2_5_drifting_to_clingy_after_2_days:228:(self)::AC-4.2.5: DRIFTING \u2192 CLINGY: clinginess > 0.7 for 2+ days."]],"TestDriftingToDistant":["249",["test_ac_4_2_6_drifting_to_distant_after_2_days:252:(self)::AC-4.2.6: DRIFTING \u2192 DISTANT: neglect > 0.6 for 2+ days."]],"TestClingyToDrifting":["273",["test_ac_4_2_7_clingy_to_drifting_after_2_good_days:276:(self)::AC-4.2.7: CLINGY \u2192 DRIFTING: clinginess < 0.5 for 2+ days."]],"TestClingyToOutOfZone":["297",["test_ac_4_2_8_clingy_to_out_of_zone_after_3_days:300:(self)::AC-4.2.8: CLINGY \u2192 OUT_OF_ZONE: clingy 3+ consecutive days."]],"TestDistantToDrifting":["323",["test_ac_4_2_9_distant_to_drifting_after_1_day:326:(self)::AC-4.2.9: DISTANT \u2192 DRIFTING: neglect < 0.4 for 1+ day."]],"TestDistantToOutOfZone":["344",["test_ac_4_2_10_distant_to_out_of_zone_after_5_days:347:(self)::AC-4.2.10: DISTANT \u2192 OUT_OF_ZONE: distant 5+ consecutive days."]],"TestOutOfZoneToCalibrating":["369",["test_ac_4_2_11_out_of_zone_to_calibrating_on_recovery:372:(self)::AC-4.2.11: OUT_OF_ZONE \u2192 CALIBRATING: recovery + grace period."]],"TestTransitionLogging":["390",["test_ac_4_2_12_transitions_return_state_transition:393:(self)::AC-4.2.12: Each transition returns StateTransition for logging."]],"TestChapterReset":["421",["test_ac_4_3_1_on_chapter_change_method_exists:424:(self)::AC-4.3.1: on_chapter_change(new_chapter) method defined.","test_ac_4_3_2_state_reset_to_calibrating:432:(self)::AC-4.3.2: State reset to CALIBRATING on chapter change.","test_ac_4_3_3_consecutive_counters_reset:441:(self)::AC-4.3.3: Consecutive counters reset to 0.","test_ac_4_3_4_multiplier_set_to_0_9:454:(self)::AC-4.3.4: Multiplier set to 0.9 (calibrating default).","test_chapter_change_returns_transition:463:(self)::Chapter change returns StateTransition for history."]],"TestTransitionHistory":["476",["test_get_history_returns_list:479:(self)::get_history() returns list of StateTransitions.","test_history_captures_transitions:488:(self)::History captures all state transitions."]]}],"t/engine/scoring/test_analyzer.py":["p",{"TestScoreAnalyzerCreation":["20",["test_create_analyzer:23:(self)::Test creating a ScoreAnalyzer instance.","test_analyzer_has_model:28:(self)::Test that analyzer has a model configured."]],"TestScoreAnalyzerAnalysis":["35",["analyzer:39:(self)::Create ScoreAnalyzer instance.","basic_context:44:(self)::Create basic conversation context.","test_analyze_returns_response_analysis:57:async (self, analyzer, basic_context)::Test that analyze returns a ResponseAnalysis object.","test_analyze_with_negative_deltas:85:async (self, analyzer, basic_context)::Test analysis of a negative interaction.","test_analyze_neutral_interaction:110:async (self, analyzer, basic_context)::Test analysis of a neutral interaction.","test_analyze_respects_delta_bounds:134:async (self, analyzer, basic_context)::Test that analysis respects -10 to +10 delta bounds."]],"TestScoreAnalyzerContextAware":["163",["analyzer:167:(self)::Create ScoreAnalyzer instance.","test_chapter_affects_analysis:172:async (self, analyzer)::Test that different chapters affect analysis.","test_relationship_state_affects_analysis:235:async (self, analyzer)::Test that relationship state affects analysis."]],"TestScoreAnalyzerBulkAnalysis":["295",["analyzer:299:(self)::Create ScoreAnalyzer instance.","basic_context:304:(self)::Create basic conversation context.","test_analyze_batch:312:async (self, analyzer, basic_context)::Test analyzing multiple exchanges at once.","test_analyze_batch_empty:340:async (self, analyzer, basic_context)::Test batch analysis with empty exchanges returns neutral."]],"TestScoreAnalyzerPromptConstruction":["349",["analyzer:353:(self)::Create ScoreAnalyzer instance.","test_build_analysis_prompt:357:(self, analyzer)::Test that analysis prompt is constructed correctly.","test_prompt_includes_chapter_behaviors:382:(self, analyzer)::Test that prompt includes chapter-specific behaviors."]],"TestScoreAnalyzerErrorHandling":["399",["analyzer:403:(self)::Create ScoreAnalyzer instance.","basic_context:408:(self)::Create basic conversation context.","test_analyze_handles_llm_error:416:async (self, analyzer, basic_context)::Test that analyzer handles LLM errors gracefully.","test_analyze_handles_invalid_response:430:async (self, analyzer, basic_context)::Test that analyzer handles invalid LLM response."]]}],"t/engine/scoring/test_calculator.py":["p",{"TestScoreCalculatorCreation":["17",["test_create_calculator:20:(self)::Test creating a ScoreCalculator instance.","test_calculator_has_weights:25:(self)::Test that calculator has metric weights configured."]],"TestCalibrationMultipliers":["34",["calculator:38:(self)::Create ScoreCalculator instance.","positive_deltas:43:(self)::Create positive deltas for testing.","negative_deltas:53:(self)::Create negative deltas for testing.","test_in_zone_multiplier:62:(self, calculator, positive_deltas)::Test IN_ZONE state gives 1.0x multiplier (full credit).","test_calibrating_multiplier:72:(self, calculator, positive_deltas)::Test CALIBRATING state gives 0.9x multiplier.","test_clingy_multiplier:82:(self, calculator, positive_deltas)::Test CLINGY state gives 0.5x multiplier (harsh penalty).","test_distant_multiplier:92:(self, calculator, positive_deltas)::Test DISTANT state gives 0.6x multiplier.","test_out_of_zone_multiplier:102:(self, calculator, positive_deltas)::Test OUT_OF_ZONE state gives 0.2x multiplier (danger zone).","test_negative_deltas_not_reduced:112:(self, calculator, negative_deltas)::Test that penalties (negative deltas) are NOT reduced by multiplier.","test_mixed_deltas:123:(self, calculator)::Test mixed positive/negative deltas."]],"TestCompositeScoreCalculation":["140",["calculator:144:(self)::Create ScoreCalculator instance.","test_calculate_composite_all_50:148:(self, calculator)::Test composite with all metrics at 50.","test_calculate_composite_weighted:161:(self, calculator)::Test that weights are applied correctly.","test_calculate_composite_all_max:181:(self, calculator)::Test composite with all metrics at 100.","test_calculate_composite_all_zero:192:(self, calculator)::Test composite with all metrics at 0."]],"TestMetricUpdate":["204",["calculator:208:(self)::Create ScoreCalculator instance.","test_update_metrics_basic:212:(self, calculator)::Test basic metric update.","test_update_metrics_floor_at_zero:234:(self, calculator)::Test that metrics cannot go below 0.","test_update_metrics_ceiling_at_100:257:(self, calculator)::Test that metrics cannot exceed 100."]],"TestScoreResult":["281",["test_score_result_creation:284:(self)::Test creating a ScoreResult.","test_score_result_with_events:316:(self)::Test ScoreResult with threshold events."]],"TestFullCalculation":["356",["calculator:360:(self)::Create ScoreCalculator instance.","test_calculate_full_flow:364:(self, calculator)::Test the full calculation flow.","test_calculate_with_clingy_state:396:(self, calculator)::Test calculation with CLINGY engagement state."]]}],"t/engine/scoring/test_models.py":["p",{"TestMetricDeltas":["20",["test_valid_deltas:23:(self)::Test that valid deltas within bounds are accepted.","test_max_positive_delta:36:(self)::Test that +10 is accepted (max positive).","test_max_negative_delta:46:(self)::Test that -10 is accepted (max negative).","test_delta_exceeds_positive_bound:56:(self)::Test that +11 raises ValidationError.","test_delta_exceeds_negative_bound:67:(self)::Test that -11 raises ValidationError.","test_decimal_precision:78:(self)::Test that deltas can have decimal precision.","test_total_property:89:(self)::Test that total computes sum of all deltas.","test_is_positive_property:99:(self)::Test is_positive property."]],"TestResponseAnalysis":["117",["test_valid_analysis:120:(self)::Test creating a valid ResponseAnalysis.","test_analysis_defaults:138:(self)::Test ResponseAnalysis with minimal required fields.","test_confidence_bounds:152:(self)::Test that confidence must be between 0 and 1.","test_behaviors_list:176:(self)::Test that behaviors_identified accepts list of strings."]],"TestConversationContext":["194",["test_valid_context:197:(self)::Test creating valid conversation context.","test_chapter_bounds:212:(self)::Test that chapter must be 1-5.","test_relationship_score_bounds:226:(self)::Test that relationship_score must be 0-100.","test_context_defaults:240:(self)::Test context with minimal required fields."]],"TestScoreChangeEvent":["252",["test_boss_threshold_event:255:(self)::Test creating boss threshold event.","test_game_over_event:268:(self)::Test creating game over event.","test_critical_low_event:280:(self)::Test creating critical low event.","test_event_types:291:(self)::Test that only valid event types are accepted."]]}],"t/engine/scoring/test_service.py":["p",{"TestScoringServiceCreation":["23",["test_create_service:26:(self)::Test creating a ScoringService instance."]],"TestScoringServiceScore":["34",["service:38:(self)::Create ScoringService instance.","mock_analysis:43:(self)::Create mock ResponseAnalysis.","mock_context:58:(self)::Create mock conversation context.","current_metrics:68:(self)::Create current metrics dict.","test_score_interaction_returns_result:80:async (self, service, mock_analysis, mock_context, current_metrics)::Test that score_interaction returns a ScoreResult.","test_score_interaction_with_history:99:async (self, service, mock_analysis, mock_context, current_metrics)::Test that score_interaction logs to history.","test_score_interaction_with_events:125:async (self, service, mock_context, current_metrics)::Test that threshold events are detected and returned."]],"TestScoringServiceAnalyzeOnly":["157",["service:161:(self)::Create ScoringService instance.","mock_context:166:(self)::Create mock conversation context.","test_analyze_only:174:async (self, service, mock_context)::Test analyze_only returns analysis without calculating scores."]],"TestScoringServiceBatchScoring":["199",["service:203:(self)::Create ScoringService instance.","mock_context:208:(self)::Create mock conversation context.","current_metrics:216:(self)::Create current metrics dict.","test_score_batch:226:async (self, service, mock_context, current_metrics)::Test scoring multiple exchanges at once."]]}],"t/platforms/telegram/test_auth.py":["p",{"TestTelegramAuth":["14",["mock_supabase_client:18:(self)::Mock Supabase AsyncClient for testing.","mock_user_repository:25:(self)::Mock UserRepository for testing.","mock_pending_repo:31:(self)::Mock PendingRegistrationRepository for testing.","auth:37:(self, mock_supabase_client, mock_user_repository, mock_pending_repo)::Create TelegramAuth instance with mocked dependencies.","test_ac_fr004_001_valid_email_sends_magic_link:48:async (self, auth, mock_supabase_client, mock_user_repository)::","test_ac_t008_1_register_user_creates_pending_registration:83:async (self, auth, mock_supabase_client, mock_user_repository, mock_pending_repo)::","test_ac_t008_2_sends_magic_link_via_supabase:111:async (self, auth, mock_supabase_client, mock_user_repository)::","test_ac_fr004_002_valid_link_creates_account:140:async (self, auth, mock_supabase_client, mock_user_repository, mock_pending_repo)::","test_ac_t008_3_verify_magic_link_completes_registration:193:async (self, auth, mock_supabase_client, mock_user_repository, mock_pending_repo)::","test_ac_t008_4_link_telegram_updates_user_record:229:async (self, auth, mock_user_repository)::","test_register_user_already_linked:253:async (self, auth, mock_user_repository)::","test_verify_otp_invalid_token:276:async (self, auth, mock_supabase_client, mock_pending_repo)::","test_verify_without_pending_registration:301:async (self, auth, mock_pending_repo)::","test_invalid_email_format:320:async (self, auth)::","test_link_telegram_user_not_found:335:async (self, auth, mock_user_repository)::","test_ac_t046_6_persistence_across_restarts:354:async (self, mock_supabase_client, mock_user_repository, mock_pending_repo):get_email_impl,store_impl:","store_impl:368:async (tid, em)::","get_email_impl:372:async (tid)::"]]}],"t/platforms/telegram/test_bot.py":["p",{"TestTelegramBot":["12",["mock_settings:16:(self)::Mock settings for testing.","bot:23:(self, mock_settings)::Create TelegramBot instance with mocked settings.","test_ac_t004_1_send_message_with_parse_mode:29:async (self, bot)::","test_ac_t004_2_send_chat_action_typing:69:async (self, bot)::","test_ac_t004_3_set_webhook:100:async (self, bot)::","test_ac_t004_4_uses_httpx_async_client:133:async (self, bot)::","test_ac_t004_5_handles_telegram_api_errors_gracefully:146:async (self, bot)::"]]}],"t/platforms/telegram/test_commands.py":["p",{"TestCommandHandler":["15",["mock_user_repository:19:(self)::Mock UserRepository for testing.","mock_telegram_auth:25:(self)::Mock TelegramAuth for testing.","mock_bot:31:(self)::Mock TelegramBot for testing.","handler:38:(self, mock_user_repository, mock_telegram_auth, mock_bot)::Create CommandHandler instance with mocked dependencies.","test_ac_t009_1_routes_commands_by_name:47:async (self, handler)::","test_ac_fr003_001_start_command_new_user:85:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t009_2_handle_start_existing_user:120:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t009_3_handle_help_returns_commands:155:async (self, handler, mock_bot)::","test_ac_t009_4_handle_status_returns_chapter_score:185:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t009_5_unknown_commands_handled_gracefully:228:async (self, handler, mock_bot)::","test_command_with_bot_username:256:async (self, handler)::","test_status_command_unregistered_user:280:async (self, handler, mock_user_repository, mock_bot)::"]]}],"t/platforms/telegram/test_delivery.py":["p",{"TestResponseDelivery":["14",["mock_bot:18:(self)::Mock TelegramBot for testing.","delivery:24:(self, mock_bot)::Create ResponseDelivery instance with mocked bot.","test_ac_fr002_002_response_delivered_via_telegram:31:async (self, delivery, mock_bot)::","test_ac_fr007_001_long_response_split_intelligently:61:async (self, delivery, mock_bot)::","test_ac_t016_1_queue_stores_for_delivery:99:async (self, delivery, mock_bot)::","test_ac_t016_3_send_now_sends_with_typing_indicator:125:async (self, delivery, mock_bot)::","test_ac_t016_4_splits_messages_intelligently_not_mid_word:154:async (self, delivery, mock_bot)::","test_short_message_not_split:191:async (self, delivery, mock_bot)::","test_exactly_4096_chars_not_split:213:async (self, delivery, mock_bot)::","test_one_char_over_limit_triggers_split:234:async (self, delivery, mock_bot)::","test_multiple_chunks_all_under_limit:255:async (self, delivery, mock_bot)::","test_empty_response_handled_gracefully:279:async (self, delivery, mock_bot)::"]],"TestTypingIndicators":["300",["mock_bot:309:(self)::Mock TelegramBot for testing.","delivery:315:(self, mock_bot)::Create ResponseDelivery instance with mocked bot.","test_ac_fr009_001_typing_indicator_appears_before_response:322:async (self, delivery, mock_bot)::","test_ac_fr009_002_periodic_typing_during_delay:365:async (self, delivery, mock_bot, monkeypatch):mock_sleep:","mock_sleep:440:async (seconds)::","test_ac_fr009_003_typing_stops_when_message_sent:403:async (self, delivery, mock_bot)::","test_no_periodic_typing_for_short_delays:429:async (self, delivery, mock_bot, monkeypatch):mock_sleep:","test_typing_indicator_sent_for_each_chunk:463:async (self, delivery, mock_bot)::"]]}],"t/platforms/telegram/test_errors.py":["p",{"TestErrorRecovery":["19",["mock_user_repository:28:(self)::Mock UserRepository.","mock_text_agent_handler:39:(self)::Mock TextAgentMessageHandler.","mock_response_delivery:50:(self)::Mock ResponseDelivery.","mock_bot:55:(self)::Mock TelegramBot.","sample_message:60:(self)::Create a sample TelegramMessage.","handler:77:(self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot,)::Create MessageHandler with mocked dependencies.","test_ac_fr008_001_agent_unavailable_user_notified:93:async (self, handler, mock_text_agent_handler, mock_bot, sample_message,)::","test_ac_fr008_001_agent_unavailable_no_crash:124:async (self, handler, mock_text_agent_handler, sample_message,)::","test_ac_fr008_002_delivery_failure_handled_gracefully:146:async (self, handler, mock_response_delivery, mock_bot, sample_message,)::","test_ac_fr008_003_auth_failure_prompts_reauth:170:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message,)::","test_ac_t035_1_try_catch_around_agent_invocation:202:async (self, handler, mock_text_agent_handler, mock_bot, sample_message,)::","test_ac_t035_3_notify_user_in_character:236:async (self, handler, mock_text_agent_handler, mock_bot, sample_message,)::","test_normal_flow_still_works:267:async (self, handler, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message,)::"]]}],"t/platforms/telegram/test_message_handler.py":["p",{"TestMessageHandler":["21",["mock_user_repository:25:(self)::Mock UserRepository for testing.","mock_text_agent_handler:31:(self)::Mock text agent MessageHandler.","mock_response_delivery:37:(self)::Mock ResponseDelivery for testing.","mock_bot:43:(self)::Mock TelegramBot for testing.","handler:55:(self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot,)::Create MessageHandler instance with mocked dependencies.","sample_message:65:(self)::Create sample Telegram message for testing.","test_ac_fr002_001_authenticated_user_message_routed_to_text_agent:77:async (self, handler, mock_user_repository, mock_text_agent_handler, sample_message)::","test_ac_t015_1_handle_processes_text_messages:109:async (self, handler, mock_user_repository, mock_text_agent_handler, sample_message)::","test_ac_t015_2_checks_authentication_prompts_registration:137:async (self, handler, mock_user_repository, mock_bot, sample_message)::","test_ac_t015_4_routes_to_text_agent_with_user_context:160:async (self, handler, mock_user_repository, mock_text_agent_handler, sample_message)::","test_ac_t015_5_queues_response_for_delivery:190:async (self, handler, mock_user_repository, mock_text_agent_handler, mock_response_delivery, sample_message)::","test_skip_response_not_queued:225:async (self, handler, mock_user_repository, mock_text_agent_handler, mock_response_delivery, sample_message)::","test_typing_indicator_sent_before_processing:255:async (self, handler, mock_user_repository, mock_text_agent_handler, mock_bot, sample_message)::","test_empty_message_handled_gracefully:281:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t025_1_minute_limit_sends_in_character_response:311:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_ac_t025_1_daily_limit_sends_in_character_response:354:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_ac_t025_2_warning_when_approaching_daily_limit:397:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_ac_t025_3_no_harsh_technical_error_messages:446:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_rate_limiting_disabled_when_no_limiter_configured:484:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::"]]}],"t/platforms/telegram/test_rate_limiter.py":["p",["mock_cache:21:()::Mock cache client for rate limit tracking.","rate_limiter:31:(mock_cache)::Create RateLimiter with mocked cache."],{"TestRateLimiter":["36",["test_ac_fr006_001_rate_limit_hit_after_20_messages_per_minute:44:async (self, rate_limiter, mock_cache,)::","test_ac_t024_1_check_returns_rate_limit_status:72:async (self, rate_limiter, mock_cache,)::","test_ac_t024_2_tracks_per_minute_and_per_day_limits:93:async (self, rate_limiter, mock_cache,):mock_incr:","mock_incr:272:async (key)::","test_ac_fr006_002_warning_when_approaching_daily_limit:127:async (self, rate_limiter, mock_cache,):mock_incr:","test_daily_limit_exceeded_blocks_message:156:async (self, rate_limiter, mock_cache,):mock_incr:","test_ac_t024_4_keys_expire_appropriately:183:async (self, rate_limiter, mock_cache,)::","test_ac_fr006_003_rate_limit_resets_after_cooldown:208:async (self, rate_limiter, mock_cache,)::","test_ac_t024_3_get_remaining_returns_quota_info:234:async (self, rate_limiter, mock_cache,):mock_get:","mock_get:241:async (key)::","test_multiple_users_isolated:262:async (self, rate_limiter, mock_cache,):mock_incr:","test_edge_case_exactly_20_messages_allowed:299:async (self, rate_limiter, mock_cache,)::"]]}],"t/platforms/telegram/test_registration_handler.py":["p",{"TestRegistrationHandler":["14",["mock_telegram_auth:18:(self)::Mock TelegramAuth for testing.","mock_bot:24:(self)::Mock TelegramBot for testing.","handler:30:(self, mock_telegram_auth, mock_bot)::Create RegistrationHandler instance with mocked dependencies.","test_ac_fr004_001_valid_email_triggers_magic_link:40:async (self, handler, mock_telegram_auth, mock_bot)::","test_ac_t008_1_creates_pending_registration:74:async (self, handler, mock_telegram_auth)::","test_ac_t008_2_sends_confirmation_message:99:async (self, handler, mock_telegram_auth, mock_bot)::","test_invalid_email_format_rejected:125:async (self, handler, mock_bot)::","test_already_registered_user:146:async (self, handler, mock_telegram_auth, mock_bot)::","test_telegram_auth_value_error:172:async (self, handler, mock_telegram_auth, mock_bot)::","test_unexpected_exception_handled:197:async (self, handler, mock_telegram_auth, mock_bot)::","test_unknown_status_from_auth:222:async (self, handler, mock_telegram_auth, mock_bot)::","test_email_whitespace_trimmed:250:async (self, handler, mock_telegram_auth, mock_bot)::","test_is_valid_email_valid_formats:272:(self, handler)::","test_is_valid_email_invalid_formats:287:(self, handler)::","test_is_valid_email_strips_whitespace:304:(self, handler)::"]]}],"t/platforms/telegram/test_session_integration.py":["p",["mock_user_repository:24:()::Mock UserRepository for authentication checks.","mock_text_agent_handler:32:()::Mock text agent handler that simulates context awareness.","mock_response_delivery:40:()::Mock ResponseDelivery for message sending.","mock_bot:48:()::Mock TelegramBot for typing indicators.","message_handler:62:(mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot,)::Create MessageHandler with mocked dependencies."],{"TestSessionPersistence":["72",["test_ac_fr005_001_context_maintained_across_multiple_messages:86:async (self, message_handler, mock_user_repository, mock_text_agent_handler,)::","test_ac_fr005_002_context_restored_after_time_gap:173:async (self, message_handler, mock_user_repository, mock_text_agent_handler,)::","test_ac_fr005_003_no_cross_user_contamination:223:async (self, message_handler, mock_user_repository, mock_text_agent_handler,):get_user_by_telegram_id,handle_message:","get_user_by_telegram_id:239:async (telegram_id:int)::","handle_message:251:async (user_id, text)::","test_session_isolation_via_user_id_scoping:314:async (self, message_handler, mock_user_repository, mock_text_agent_handler,)::"]]}]},"g":[["DailySummaryRepository.__init__","ConversationThreadRepository.__init__"],["ConversationRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["ConversationRepository.__init__","GeneratedPromptRepository.__init__"],["GeneratedPromptRepository.__init__","EngagementStateRepository.__init__"],["ResponseDelivery.queue","_send_now"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestUserMetricsRepository.__init__"],["RecoveryManager.check_recovery_complete","_check_out_of_zone_recovery"],["UserRepository.__init__","TelegramAuth.__init__"],["ClinginessDetector.detect","_frequency_signal"],["MissingVariableError.__init__","TestVicePreferenceRepository.__init__"],["analyze_distraction","UserMetricsRepository._clamp"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestVicePreferenceRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ConversationRepository.__init__"],["UserRepository.__init__","EngagementStateRepository.__init__"],["NikitaMemory.add_episode","_get_group_id"],["_ChapterBehaviorsProxy.__len__","_load_chapter_behaviors"],["TestNikitaThoughtRepository.test_create_missing_him_thought_48h","TestNikitaThoughtRepository.mock_create_thought"],["ConfigLoader._load_all_configs","_load_yaml"],["TestRateLimiter.test_multiple_users_isolated","TestRateLimiter.mock_incr"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","RegistrationHandler.__init__"],["TestLayer3RelationshipState.test_layer3_chapter_variations","TestLayer6ResponseGuidelines._create_context"],["UserRepository.update_last_interaction","_ChapterBehaviorsProxy.get"],["GeneratedPromptRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["UserMetricsRepository.__init__","TelegramAuth.__init__"],["TestLayer2CurrentMoment.test_layer2_gap_mood_variations","TestLayer3RelationshipState._create_context"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ConversationRepository.__init__"],["DecayProcessor.process_user","DecayProcessor.should_skip_user"],["verify_task_secret","_get_task_secret"],["UserNotFoundError.__init__","MetaPromptService.__init__"],["TemplateGenerator.generate_prompt_legacy","_layer5_knowledge_inner_life"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TemplateGenerator.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ScoreHistoryRepository.__init__"],["UserMetricsRepository.__init__","TelegramBot.__init__"],["RateLimiter.check","InMemoryCache.expire"],["NeglectDetector._short_message_signal","_clamp"],["ConversationRepository.__init__","__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","PostProcessor.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","NikitaThoughtRepository.__init__"],["ConversationThreadRepository.__init__","UserRepository.__init__"],["BaseRepository.get","PendingRegistrationRepository.get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TemplateGenerator.__init__"],["analyze_neediness","_get_cache_key"],["DailySummaryRepository.__init__","RegistrationHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","DecayCalculator.__init__"],["get_supabase_client","_get_supabase_sync_client"],["NikitaMemory.get_user_facts","_get_group_id"],["EngagementCard","getAdvice"],["analyze_distraction","_get_cache_key"],["VicePreferenceRepository.__init__","MetaPromptService.__init__"],["UserNotFoundError.__init__","TestUserMetricsRepository.__init__"],["ScoreHistoryRepository.__init__","TemplateGenerator.__init__"],["UserNotFoundError.__init__","VicePreferenceRepository.__init__"],["EngagementStateMachine.update","EngagementStateMachine._update_counters"],["GeneratedPromptRepository.__init__","SessionDetector.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","PendingRegistrationRepository.__init__"],["ResponseDelivery.queue","ResponseDelivery._send_now"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ScoreHistoryRepository.__init__"],["EngagementStateMachine._apply_transition","EngagementStateMachine._get_transition_reason"],["MessageHandler.handle","get_nikita_agent_for_user"],["ClinginessDetector._double_text_signal","_clamp"],["ConversationThreadRepository.__init__","PromptLoader.__init__"],["VicePreferenceRepository.__init__","TestUserMetricsRepository.__init__"],["TestLayer4ConversationHistory.test_layer4_with_week_summaries","_create_context_with_history"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","NikitaThoughtRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","NikitaMemory.__init__"],["BaseRepository.delete_by_id","InMemoryCache.get"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TelegramAuth.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","DecayCalculator.__init__"],["PromptLoader.load","_resolve_path"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","PromptLoader.__init__"],["UserNotFoundError.__init__","PostProcessor.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ResponseDelivery.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","EngagementStateRepository.__init__"],["PendingRegistrationRepository.cleanup_expired","delete"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","DecayProcessor.__init__"],["MissingVariableError.__init__","SkipDecision.__init__"],["RateLimiter.get_remaining","BaseRepository.get"],["RecoveryManager.check_point_of_no_return","_get_game_over_reason"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","FactExtractor.__init__"],["MissingVariableError.__init__","ExperimentLoader.__init__"],["DailySummaryRepository.__init__","NikitaThoughtRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ScoreHistoryRepository.__init__"],["VicePreferenceRepository.__init__","PostProcessor.__init__"],["MetaPromptService.generate_system_prompt","MetaPromptService._format_template"],["NikitaThoughtRepository.__init__","FactExtractor.__init__"],["NikitaMemory.add_user_fact","NikitaMemory.add_episode"],["DailySummaryRepository.__init__","DecayCalculator.__init__"],["ScoreAnalyzer.agent","_create_score_analyzer_agent"],["UserNotFoundError.__init__","PendingRegistrationRepository.__init__"],["VicePreferenceRepository.__init__","TemplateGenerator.__init__"],["PromptLoader._substitute_variables","PromptLoader.replace_match"],["NikitaThoughtRepository.__init__","ScoreHistoryRepository.__init__"],["TelegramAuth.verify_magic_link","register_user"],["NeglectDetector._short_message_signal","UserMetricsRepository._clamp"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","DecayCalculator.__init__"],["run_async_migrations","get_url"],["GeneratedPromptRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ResponseDelivery.__init__"],["TestRateLimiter.test_ac_t024_3_get_remaining_returns_quota_info","mock_get"],["NikitaMemory.add_episode","NikitaMemory._get_group_id"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","DailySummaryRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","CommandHandler.__init__"],["UserRepository.__init__","SkipDecision.__init__"],["NikitaThoughtRepository.__init__","DecayCalculator.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","MissingVariableError.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","VicePreferenceRepository.__init__"],["NikitaThoughtRepository.create_missing_him_thought","create_thought"],["UserRepository.__init__","ExperimentLoader.__init__"],["UserMetricsRepository.__init__","SkipDecision.__init__"],["UserNotFoundError.__init__","ConversationThreadRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","RegistrationHandler.__init__"],["ScoreCalculator.calculate","ScoreCalculator.apply_multiplier"],["ConversationRepository.__init__","NikitaMemory.__init__"],["ResponseDelivery.queue","ResponseDelivery._wait_with_typing"],["DailySummaryRepository.__init__","ResponseDelivery.__init__"],["TemplateGenerator.generate_prompt_legacy","_layer2_current_moment"],["ClinginessDetector._double_text_signal","UserMetricsRepository._clamp"],["MissingVariableError.__init__","MessageHandler.__init__"],["GeneratedPromptRepository.__init__","PromptLoader.__init__"],["EngagementStateRepository.__init__","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestDailySummaryRepositoryContextEngineering.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","InMemoryCache.__init__"],["UserMetricsRepository.__init__","ExperimentLoader.__init__"],["ConversationRepository.__init__","DecayProcessor.__init__"],["NikitaMemory.get_user_facts","NikitaMemory._get_group_id"],["EngagementStateRepository.__init__","CommandHandler.__init__"],["ScoreAnalyzer._call_llm","_call_llm_raw"],["_ChapterBehaviorsProxy.get","InMemoryCache.get"],["create_app","health"],["InMemoryCache.incr","InMemoryCache.get"],["UserRepository.update_last_interaction","UserRepository.get"],["EngagementStateRepository.__init__","MissingVariableError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TelegramAuth.__init__"],["NikitaThoughtRepository.__init__","ResponseDelivery.__init__"],["run_migrations_online","run_async_migrations"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","BaseRepository.__init__"],["TestDecayCalculatorIsOverdue.test_is_overdue_no_interaction_returns_true","create_mock_user"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TelegramBot.__init__"],["TestLayer4ConversationHistory.test_layer4_with_last_conversation","_create_context_with_history"],["RateLimiter.check","RateLimiter._seconds_until_midnight"],["RateLimiter.__init__","InMemoryCache.get"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","FactExtractor.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","CommandHandler.__init__"],["MissingVariableError.__init__","ScoringService.__init__"],["DecayProcessor.process_user","DecayProcessor._log_decay_event"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_sets_decay_reason","create_mock_user"],["ExperimentLoader._load_experiment_with_inheritance","_get_experiment_path"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","BaseRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ScoreHistoryRepository.__init__"],["NikitaThoughtRepository.bulk_create_thoughts","NikitaThoughtRepository.create_thought"],["UserRepository.__init__","MessageHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","CommandHandler.__init__"],["UserNotFoundError.__init__","RegistrationHandler.__init__"],["ScoreCalculator.calculate","ScoreCalculator.update_metrics"],["ConversationRepository.__init__","DailySummaryRepository.__init__"],["RateLimiter.__init__","expire"],["TestLayer3RelationshipState.test_layer3_game_over_status","TestLayer2CurrentMoment._create_context"],["MissingVariableError.__init__","MissingVariableError.__init__"],["MissingVariableError.__init__","ConfigLoader.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","MissingVariableError.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","DecayCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TelegramAuth.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","RateLimiter.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","SkipDecision.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","MetaPromptService.__init__"],["MetaPromptService._load_context","_compute_nikita_energy"],["TestDecayProcessorProcessUser.test_process_user_logs_decay_event","create_mock_user"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","NikitaThoughtRepository.__init__"],["ScoreHistoryRepository.__init__","FactExtractor.__init__"],["UserMetricsRepository.__init__","MessageHandler.__init__"],["DatabaseRateLimiter.get_remaining","DatabaseRateLimiter._get_day_window"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ConversationRepository.__init__"],["ScoreHistoryRepository.__init__","ScoreHistoryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","DecayCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TelegramBot.__init__"],["UserRepository.__init__","UserMetricsRepository.__init__"],["VicePreferenceRepository.__init__","RegistrationHandler.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ExperimentLoader.__init__"],["BaseRepository.session","PendingRegistrationRepository.session"],["build_system_prompt","_build_system_prompt_legacy"],["RateLimiter.get_remaining","_get_day_key"],["ClinginessDetector.detect","_double_text_signal"],["TestDecayProcessorProcessUser.test_process_user_skips_boss_fight","create_mock_user"],["ExperimentLoader._load_experiment_with_inheritance","ExperimentLoader._list_available_experiments"],["DailySummaryRepository.__init__","DatabaseRateLimiter.__init__"],["ConversationRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["TemplateGenerator.generate_prompt_legacy","_layer3_relationship_state"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestVicePreferenceRepositoryExtras.__init__"],["ScoreHistoryRepository.__init__","DecayCalculator.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestUserMetricsRepository.__init__"],["UserMetricsRepository.__init__","UserMetricsRepository.__init__"],["DailySummaryRepository.__init__","TelegramAuth.__init__"],["EngagementStateRepository.__init__","MetaPromptService.__init__"],["DailySummaryRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["UserNotFoundError.__init__","ResponseTimer.__init__"],["_ChapterBehaviorsProxy.items","items"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TelegramAuth.__init__"],["DailySummaryRepository.__init__","TelegramBot.__init__"],["InMemoryCache.get","BaseRepository.get"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","EngagementStateRepository.__init__"],["NikitaThoughtRepository.__init__","TelegramAuth.__init__"],["MissingVariableError.__init__","ScoreAnalyzer.__init__"],["SessionDetector.detect_and_queue","SessionDetector.get_stale_sessions"],["UserNotFoundError.__init__","NikitaThoughtRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ResponseDelivery.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","TestTelegramAuth.store_impl"],["UserMetricsRepository.__init__","ConfigLoader.__init__"],["MissingVariableError.__init__","EngagementStateMachine.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","UserRepository.__init__"],["NikitaThoughtRepository.__init__","EngagementStateRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","MetaPromptService.__init__"],["UserNotFoundError.__init__","DecayCalculator.__init__"],["EngagementStateRepository.__init__","TestUserMetricsRepository.__init__"],["NikitaThoughtRepository.__init__","TelegramBot.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","PostProcessor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","__init__"],["DatabaseRateLimiter.check","_seconds_until_midnight"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","MessageHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TemplateGenerator.__init__"],["ConversationRepository.__init__","SessionDetector.__init__"],["VicePreferenceRepository.__init__","ScoreHistoryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","MetaPromptService.__init__"],["DailySummaryRepository.__init__","TestVicePreferenceRepository.__init__"],["TestLayer6ResponseGuidelines.test_layer6_time_based_adjustments","TestLayer2CurrentMoment._create_context"],["VicePreferenceRepository.__init__","NikitaThoughtRepository.__init__"],["ConversationThreadRepository.__init__","VicePreferenceRepository.__init__"],["TestTypingIndicators.test_ac_fr009_002_periodic_typing_during_delay","TestTypingIndicators.mock_sleep"],["VicePreferenceRepository.__init__","DecayCalculator.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestUserMetricsRepository.__init__"],["ConversationRepository.__init__","ConversationRepository.__init__"],["RegistrationHandler.handle_email_input","RegistrationHandler.is_valid_email"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","PromptLoader.__init__"],["ConfigLoader._load_all_configs","ConfigLoader._load_yaml"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","UserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","SkipDecision.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","PendingRegistrationRepository.__init__"],["EngagementStateRepository.__init__","PostProcessor.__init__"],["TestRateLimiter.test_daily_limit_exceeded_blocks_message","mock_incr"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestUserMetricsRepository.__init__"],["ConversationThreadRepository.__init__","InMemoryCache.__init__"],["EngagementStateRepository.__init__","TemplateGenerator.__init__"],["UserNotFoundError.__init__","ResponseDelivery.__init__"],["UserRepository.update_score","BaseRepository.get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ExperimentLoader.__init__"],["NeglectDetector.detect","_frequency_signal"],["get_nikita_agent","_create_nikita_agent"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","PostProcessor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ResponseTimer.__init__"],["VicePreferenceRepository.__init__","ResponseDelivery.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TelegramAuth.__init__"],["TestLayer4ConversationHistory.test_layer4_with_last_conversation","TestLayer4ConversationHistory._create_context_with_history"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","SkipDecision.__init__"],["ConversationRepository.__init__","UserRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","EngagementStateRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","PostProcessor.__init__"],["MissingVariableError.__init__","TemplateGenerator.__init__"],["ConversationThreadRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TemplateGenerator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TelegramAuth.__init__"],["TestLayer3RelationshipState.test_layer3_chapter_variations","TestLayer3RelationshipState._create_context"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ExperimentLoader.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TelegramBot.__init__"],["ConversationThreadRepository.__init__","RateLimiter.__init__"],["ScoreHistoryRepository.__init__","TelegramAuth.__init__"],["MissingVariableError.__init__","ScoreCalculator.__init__"],["TestNikitaThoughtRepository.test_create_missing_him_thought_48h","mock_create_thought"],["generate_system_prompt","TemplateGenerator.generate_prompt"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","MessageHandler.__init__"],["ScoreHistoryRepository.__init__","EngagementStateRepository.__init__"],["DailySummaryRepository.__init__","SkipDecision.__init__"],["ConfigLoader.get_boss_threshold","get_chapter"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","PendingRegistrationRepository.__init__"],["DatabaseRateLimiter.check","DatabaseRateLimiter._get_minute_window"],["ConversationRepository.__init__","PromptLoader.__init__"],["GeneratedPromptRepository.__init__","VicePreferenceRepository.__init__"],["InMemoryCache.incr","_cleanup_expired"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","SkipDecision.__init__"],["ConversationThreadRepository.__init__","ConversationThreadRepository.__init__"],["NikitaMemory.add_episode","NikitaMemory.add_episode"],["DailySummaryRepository.__init__","ExperimentLoader.__init__"],["ConversationThreadRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","RegistrationHandler.__init__"],["deep_merge","deep_merge"],["UserNotFoundError.__init__","DatabaseRateLimiter.__init__"],["NikitaThoughtRepository.__init__","SkipDecision.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","UserMetricsRepository.__init__"],["BaseRepository.delete","PendingRegistrationRepository.delete"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ExperimentLoader.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","NikitaMemory.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ConversationThreadRepository.__init__"],["GeneratedPromptRepository.__init__","InMemoryCache.__init__"],["TestDecayProcessorShouldSkipUser.test_skip_won_status","create_mock_user"],["RecoveryManager.check_recovery_complete","RecoveryManager._check_out_of_zone_recovery"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","CommandHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","DecayProcessor.__init__"],["UserNotFoundError.__init__","TestDailySummaryRepositoryExtras.__init__"],["NikitaThoughtRepository.__init__","ExperimentLoader.__init__"],["MetaPromptService._load_context","_compute_nikita_mood"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","MessageHandler.__init__"],["UserRepository.__init__","ScoreCalculator.__init__"],["ResponseDelivery._send_now","_split_message"],["UserNotFoundError.__init__","TelegramBot.__init__"],["TestLayer2CurrentMoment.test_layer2_gap_mood_variations","_create_context"],["TestNikitaThoughtRepository.test_create_missing_him_thought_24h","mock_create_thought"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ConfigLoader.__init__"],["EngagementStateRepository.__init__","RegistrationHandler.__init__"],["PendingRegistrationRepository.delete","delete"],["VicePreferenceRepository.__init__","TelegramAuth.__init__"],["BaseRepository.delete_by_id","get"],["UserMetricsRepository.__init__","ScoreCalculator.__init__"],["ConversationThreadRepository.__init__","__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","UserMetricsRepository.__init__"],["GeneratedPromptRepository.__init__","PendingRegistrationRepository.__init__"],["VicePreferenceRepository.__init__","TelegramBot.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_no_game_over_when_score_above_zero","create_mock_user"],["DailySummaryRepository.__init__","MessageHandler.__init__"],["ClinginessDetector.detect","_clamp"],["UserRepository.__init__","UserNotFoundError.__init__"],["UserNotFoundError.__init__","TestVicePreferenceRepository.__init__"],["BaseRepository.update","BaseRepository.get"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","RegistrationHandler.__init__"],["GeneratedPromptRepository.__init__","RateLimiter.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","MessageHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","NikitaThoughtRepository.__init__"],["UserRepository.__init__","RateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ConfigLoader.__init__"],["UserMetricsRepository.__init__","UserNotFoundError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","RegistrationHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","DecayCalculator.__init__"],["NikitaThoughtRepository.__init__","MessageHandler.__init__"],["DatabaseRateLimiter.get_remaining","_get_day_window"],["UserRepository.update_last_interaction","PendingRegistrationRepository.get"],["ScoreCalculator.calculate","apply_multiplier"],["GeneratedPromptRepository.__init__","ConversationThreadRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","SkipDecision.__init__"],["DecayCalculator.calculate_decay","DecayCalculator.is_overdue"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","UserMetricsRepository.__init__"],["UserRepository.update_score","UserRepository.get"],["DailySummaryRepository.__init__","ScoringService.__init__"],["TestFullPromptVisualVerification.test_full_prompt_generation_visual","mock_meta_prompt_service"],["GeneratedPromptRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","DatabaseRateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ScoreAnalyzer.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestDailySummaryRepositoryContextEngineering.__init__"],["PromptLoader.load","PromptLoader._resolve_path"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","EngagementStateMachine.__init__"],["ConversationRepository.__init__","CommandHandler.__init__"],["UserRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["ClinginessDetector.detect","ClinginessDetector._length_ratio_signal"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","SkipDecision.__init__"],["UserRepository.__init__","GeneratedPromptRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ExperimentLoader.__init__"],["ConversationThreadRepository.__init__","ResponseTimer.__init__"],["NikitaThoughtRepository.__init__","UserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","MetaPromptService.__init__"],["EngagementStateRepository.__init__","NikitaThoughtRepository.__init__"],["ClinginessDetector.detect","_response_time_signal"],["DailySummaryRepository.__init__","MissingVariableError.__init__"],["ConversationThreadRepository.bulk_create_threads","create_thread"],["DailySummaryRepository.__init__","ConfigLoader.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ScoreCalculator.__init__"],["RateLimiter.check","_seconds_until_midnight"],["FactExtractor.extract_facts","_call_llm_for_extraction"],["EngagementStateRepository.__init__","DecayCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ExperimentLoader.__init__"],["ScoreHistoryRepository.__init__","SkipDecision.__init__"],["UserMetricsRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["UserMetricsRepository.__init__","GeneratedPromptRepository.__init__"],["BaseRepository.get","InMemoryCache.get"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ResponseDelivery.__init__"],["TestLayer4ConversationHistory.test_layer4_with_today_summaries","_create_context_with_history"],["MissingVariableError.__init__","FactExtractor.__init__"],["NikitaThoughtRepository.__init__","ConfigLoader.__init__"],["ScoreHistoryRepository.__init__","ExperimentLoader.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","NikitaThoughtRepository.__init__"],["atomic","is_deadlock_error"],["_ChapterBehaviorsProxy.get","get"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestUserMetricsRepository.__init__"],["MissingVariableError.__init__","ScoreHistoryRepository.__init__"],["CalibrationCalculator.compute","UserMetricsRepository._clamp"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ScoreAnalyzer.__init__"],["TestConversationThreadRepository.test_bulk_resolve_threads_resolves_found","TestConversationThreadRepository.mock_resolve_thread"],["UserRepository.advance_chapter","get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","EngagementStateMachine.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","DecayCalculator.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","UserNotFoundError.__init__"],["MetaPromptService._load_context","MetaPromptService._compute_nikita_mood"],["UserRepository.__init__","__init__"],["DecayWarning","getSeverity"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","NikitaThoughtRepository.__init__"],["ClinginessDetector.detect","UserMetricsRepository._clamp"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","DecayCalculator.__init__"],["create_telegram_router","TelegramBot.set_webhook"],["UserNotFoundError.__init__","SkipDecision.__init__"],["UserRepository.update_game_status","BaseRepository.get"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","RateLimiter.__init__"],["EngagementStateRepository.__init__","ResponseDelivery.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","MessageHandler.__init__"],["UserMetricsRepository.__init__","__init__"],["BaseRepository.delete_by_id","delete"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ConversationRepository.__init__"],["ScoringService.score_interaction","_log_history"],["CalibrationCalculator.compute","map_score_to_state"],["DailySummaryRepository.__init__","ScoreAnalyzer.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","PostProcessor.__init__"],["MessageHandler.handle","handle"],["BaseRepository.update","create"],["DailySummaryRepository.__init__","EngagementStateMachine.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","MessageHandler.__init__"],["TestLayer3RelationshipState.test_layer3_score_trend_variations","TestLayer3RelationshipState._create_context"],["get_session_maker","get_async_engine"],["ConfigLoader.__init__","ConfigLoader._load_all_configs"],["VicePreferenceRepository.__init__","SkipDecision.__init__"],["ConversationThreadRepository.__init__","DecayProcessor.__init__"],["BaseRepository.delete","BaseRepository.delete"],["RateLimiter.get_remaining","RateLimiter._get_day_key"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestVicePreferenceRepositoryExtras.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","UserMetricsRepository.__init__"],["ConversationRepository.__init__","MetaPromptService.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ResponseDelivery.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","GeneratedPromptRepository.__init__"],["ScoreHistoryRepository.__init__","MessageHandler.__init__"],["UserMetricsRepository.__init__","FactExtractor.__init__"],["VicePreferenceRepository.__init__","ExperimentLoader.__init__"],["GeneratedPromptRepository.__init__","ResponseTimer.__init__"],["NikitaMemory.get_context_for_prompt","NikitaMemory.search_memory"],["CommandHandler._handle_status","MetaPromptService._get_chapter_name"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ResponseDelivery.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","PendingRegistrationRepository.__init__"],["ScoreCalculator.update_metrics","ScoreCalculator.clamp"],["MetaPromptService.__init__","_load_templates"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ScoreCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ScoringService.__init__"],["BaseRepository.delete_by_id","BaseRepository.get"],["ScoreHistoryRepository.__init__","UserMetricsRepository.__init__"],["TelegramBot.send_message","escape_html"],["BaseRepository.delete_by_id","_ChapterBehaviorsProxy.get"],["ConversationRepository.__init__","TestUserMetricsRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TelegramAuth.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestDailySummaryRepositoryExtras.__init__"],["EngagementStateMachine.update","EngagementStateMachine._apply_transition"],["ConversationRepository.__init__","VicePreferenceRepository.__init__"],["MetaPromptService._load_context","_compute_nikita_activity"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ConfigLoader.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TelegramBot.__init__"],["SessionDetector.detect_and_queue","SessionDetector.mark_for_processing"],["RateLimiter.check","incr"],["atomic","transfer_funds"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","UserNotFoundError.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ConversationThreadRepository.__init__"],["ConversationRepository.__init__","InMemoryCache.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","PromptLoader.__init__"],["TestLayer6ResponseGuidelines.test_layer6_gap_based_adjustments","TestLayer3RelationshipState._create_context"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ScoreCalculator.__init__"],["EngagementStateRepository.__init__","TelegramAuth.__init__"],["VicePreferenceRepository.__init__","MessageHandler.__init__"],["ConversationRepository.__init__","PostProcessor.__init__"],["ConversationThreadRepository.__init__","DatabaseRateLimiter.__init__"],["ConversationThreadRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["DailySummaryRepository.__init__","TemplateGenerator.__init__"],["UserNotFoundError.__init__","ScoringService.__init__"],["RateLimiter.get_remaining","get"],["EngagementStateRepository.__init__","TelegramBot.__init__"],["UserNotFoundError.__init__","BaseRepository.__init__"],["_ChapterBehaviorsProxy.__getitem__","_load_chapter_behaviors"],["EngagementStateMachine._apply_transition","_reset_counters"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","DatabaseRateLimiter.__init__"],["ConversationThreadRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["UserRepository.__init__","NikitaMemory.__init__"],["PendingRegistrationRepository.get_email","InMemoryCache.get"],["GeneratedPromptRepository.__init__","DecayProcessor.__init__"],["VicePreferenceRepository.__init__","UserMetricsRepository.__init__"],["UserNotFoundError.__init__","MissingVariableError.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TelegramAuth.__init__"],["UserNotFoundError.__init__","ConfigLoader.__init__"],["FactExtractor.extract_facts","FactExtractor._deduplicate_facts"],["DailySummaryRepository.__init__","ScoreCalculator.__init__"],["UserRepository.__init__","DecayProcessor.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","UserNotFoundError.__init__"],["run_in_transaction","_wrapped"],["ConversationRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","GeneratedPromptRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestDailySummaryRepositoryExtras.__init__"],["TestEdgeCases.test_user_with_no_last_interaction","mock_meta_prompt_service"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ScoreAnalyzer.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","TestTelegramAuth.get_email_impl"],["MissingVariableError.__init__","TelegramAuth.__init__"],["ChapterCard","getStatusBadge"],["UserMetricsRepository.__init__","NikitaMemory.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TelegramBot.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","EngagementStateMachine.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TelegramAuth.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ScoreCalculator.__init__"],["TestLayer4ConversationHistory.test_layer4_with_today_summaries","TestLayer4ConversationHistory._create_context_with_history"],["MissingVariableError.__init__","EngagementStateRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","RegistrationHandler.__init__"],["TestDecayProcessorShouldSkipUser.test_skip_game_over_status","create_mock_user"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TelegramBot.__init__"],["TestConversationThreadRepository.test_bulk_create_threads_creates_all","mock_create_thread"],["NikitaThoughtRepository.__init__","ScoreCalculator.__init__"],["_ChapterBehaviorsProxy.get","BaseRepository.get"],["VicePreferenceRepository.__init__","ConfigLoader.__init__"],["DatabaseRateLimiter.check","RateLimiter._seconds_until_midnight"],["InMemoryCache.incr","BaseRepository.get"],["DecayProcessor.process_user","should_skip_user"],["UserRepository.advance_chapter","_ChapterBehaviorsProxy.get"],["ConversationThreadRepository.__init__","TestVicePreferenceRepository.__init__"],["_create_nikita_agent","recall_memory"],["DailySummaryRepository.__init__","UserNotFoundError.__init__"],["RecoveryManager.check_recovery_complete","_check_clingy_recovery"],["ConversationRepository.__init__","ConversationThreadRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestVicePreferenceRepositoryExtras.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","UserNotFoundError.__init__"],["UserRepository.__init__","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","GeneratedPromptRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestVicePreferenceRepository.__init__"],["RateLimiter.__init__","BaseRepository.get"],["ConversationThreadRepository.__init__","ConversationRepository.__init__"],["_ChapterBehaviorsProxy.keys","_load_chapter_behaviors"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_correct_amount_ch1_10h_overdue","create_mock_user"],["NikitaThoughtRepository.__init__","UserNotFoundError.__init__"],["UserNotFoundError.__init__","ScoreAnalyzer.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","RateLimiter.__init__"],["UserMetricsRepository.__init__","DailySummaryRepository.__init__"],["UserNotFoundError.__init__","EngagementStateMachine.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ResponseTimer.__init__"],["GeneratedPromptRepository.__init__","DatabaseRateLimiter.__init__"],["TestLayer3RelationshipState.test_layer3_chapter_variations","TestLayer2CurrentMoment._create_context"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","BaseRepository.__init__"],["handleSubmit","validateEmail"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","NikitaMemory.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","FactExtractor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","SkipDecision.__init__"],["UserRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["UserMetricsRepository.__init__","EngagementStateRepository.__init__"],["DailySummaryRepository.__init__","GeneratedPromptRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","CommandHandler.__init__"],["FactExtractor.extract_facts","FactExtractor._call_llm_for_extraction"],["RecoveryManager.check_recovery_complete","_check_distant_recovery"],["UserRepository.update_game_status","InMemoryCache.get"],["MissingVariableError.__init__","SessionDetector.__init__"],["GeneratedPromptRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","NikitaThoughtRepository.__init__"],["VicePreferenceRepository.__init__","ScoreAnalyzer.__init__"],["_ChapterBehaviorsProxy.items","_load_chapter_behaviors"],["NikitaMemory.add_relationship_episode","add_episode"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","DecayProcessor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","GeneratedPromptRepository.__init__"],["VicePreferenceRepository.__init__","EngagementStateMachine.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","DecayCalculator.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ExperimentLoader.__init__"],["PromptLoader.render","_substitute_variables"],["UserMetricsRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["PromptLoader._substitute_variables","_get_nested_value"],["ConversationRepository.__init__","RegistrationHandler.__init__"],["ConversationRepository.search","search"],["NikitaThoughtRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["BaseRepository.delete_by_id","UserRepository.get"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","InMemoryCache.__init__"],["NikitaThoughtRepository.__init__","GeneratedPromptRepository.__init__"],["ConversationThreadRepository.bulk_resolve_threads","ConversationThreadRepository.resolve_thread"],["TestTypingIndicators.test_no_periodic_typing_for_short_delays","mock_sleep"],["recall_memory","format_memory_results"],["NeglectDetector.detect","ClinginessDetector._frequency_signal"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ScoreCalculator.__init__"],["PendingRegistrationRepository.delete","PendingRegistrationRepository.delete"],["ScoreCalculator.calculate","ScoreCalculator.calculate_composite"],["TestNikitaThoughtRepository.test_create_thought_valid_types","TestNikitaThoughtRepository.mock_create"],["TestLayer3RelationshipState.test_layer3_chapter_variations","_create_context"],["EngagementStateRepository.__init__","SkipDecision.__init__"],["PromptLoader.replace_match","PromptLoader._get_nested_value"],["TestNikitaThoughtRepository.test_create_missing_him_thought_24h","TestNikitaThoughtRepository.mock_create_thought"],["MetaPromptService.extract_entities","TemplateGenerator._load_context"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","FactExtractor.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ScoreCalculator.__init__"],["GeneratedPromptRepository.__init__","TestVicePreferenceRepository.__init__"],["ScoreAnalyzer.analyze_batch","ScoreAnalyzer._call_llm_raw"],["EngagementStateRepository.__init__","ExperimentLoader.__init__"],["UserRepository.__init__","SessionDetector.__init__"],["TestDecayCalculatorIsOverdue.test_is_overdue_within_grace_returns_false","create_mock_user"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","DailySummaryRepository.__init__"],["DailySummaryRepository.get_for_date","get_by_date"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","__init__"],["TestConversationThreadRepository.test_create_thread_valid_types","TestConversationThreadRepository.mock_create"],["ScoreHistoryRepository.__init__","ScoreCalculator.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ResponseDelivery.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","SkipDecision.__init__"],["GeneratedPromptRepository.__init__","ConversationRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","UserNotFoundError.__init__"],["TestRateLimiter.test_ac_fr006_002_warning_when_approaching_daily_limit","mock_incr"],["NikitaThoughtRepository.__init__","__init__"],["UserMetricsRepository.__init__","SessionDetector.__init__"],["TestLayer2CurrentMoment.test_layer2_time_of_day_variations","TestLayer6ResponseGuidelines._create_context"],["UserRepository.__init__","ConversationRepository.__init__"],["RegistrationHandler.handle_email_input","is_valid_email"],["ConversationRepository.__init__","ResponseTimer.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","MessageHandler.__init__"],["UserNotFoundError.__init__","TemplateGenerator.__init__"],["EngagementStateMachine.update","EngagementStateMachine._evaluate_transition"],["DailySummaryRepository.__init__","FactExtractor.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","SkipDecision.__init__"],["MessageHandler.handle","MessageHandler._send_error_response"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","UserNotFoundError.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ExperimentLoader.__init__"],["InMemoryCache.get","get"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","RateLimiter.__init__"],["RateLimiter.get_remaining","_ChapterBehaviorsProxy.get"],["clean_session","session_maker"],["ConfigLoader.get_boss_threshold","ConfigLoader.get_chapter"],["DailySummaryRepository.__init__","ScoreHistoryRepository.__init__"],["TestLLMAnalysisFunctions.test_ac_2_3_6_results_cached_per_session","mock_llm"],["RateLimiter.get_remaining","_get_minute_key"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestDailySummaryRepositoryContextEngineering.__init__"],["ConversationRepository.__init__","NikitaThoughtRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","MetaPromptService.__init__"],["NikitaThoughtRepository.bulk_create_thoughts","create_thought"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ExperimentLoader.__init__"],["ScoreCalculator.calculate","ScoreCalculator._detect_events"],["ScoreHistoryRepository.__init__","UserNotFoundError.__init__"],["MessageHandler.handle","_send_error_response"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","NikitaMemory.__init__"],["TemplateGenerator.generate_prompt_legacy","_layer4_conversation_history"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_correct_amount_ch1","create_mock_user"],["ScoreCalculator.calculate","UserMetricsRepository.calculate_composite"],["UserRepository.apply_decay","update_score"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TestVicePreferenceRepositoryExtras.__init__"],["DecayProcessor.process_all","process_user"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","GeneratedPromptRepository.__init__"],["ScoreHistoryRepository.__init__","RateLimiter.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ScoringService.__init__"],["EngagementStateRepository.__init__","MessageHandler.__init__"],["NeglectDetector.detect","_short_message_signal"],["TestLayer2CurrentMoment.test_layer2_time_of_day_variations","_create_context"],["_ChapterBehaviorsProxy.get","UserRepository.get"],["ExperimentLoader._load_experiment_with_inheritance","ExperimentLoader._get_experiment_path"],["MetaPromptService.extract_entities","MetaPromptService._load_context"],["UserRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestUserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","GeneratedPromptRepository.__init__"],["VicePreferenceRepository.__init__","ScoreCalculator.__init__"],["ConfigLoader.__new__","ConfigLoader.__new__"],["UserRepository.advance_chapter","UserRepository.get"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ConfigLoader.__init__"],["ResponseTimer.calculate_delay_human_readable","calculate_delay"],["ScoreCalculator.calculate","calculate_composite"],["NeglectDetector.detect","UserMetricsRepository._clamp"],["NikitaMemory.get_context_for_prompt","search_memory"],["ScoreHistoryRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","MessageHandler.__init__"],["ScoreHistoryRepository.__init__","GeneratedPromptRepository.__init__"],["EngagementStateMachine.update","_update_counters"],["NikitaThoughtRepository.get_thoughts_for_prompt","NikitaThoughtRepository.get_active_thoughts"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","SessionDetector.__init__"],["UserMetricsRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","NikitaMemory.__init__"],["ConversationRepository.__init__","ResponseDelivery.__init__"],["ScoreCard","getBadgeVariant"],["EngagementStateRepository.__init__","ScoringService.__init__"],["UserRepository.update_score","get"],["UserMetricsRepository.update_metrics","EngagementStateRepository.get_by_user_id"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","DatabaseRateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","MessageHandler.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","__init__"],["ScoreCalculator.apply_multiplier","adjust"],["TestRateLimiter.test_ac_fr006_002_warning_when_approaching_daily_limit","TestRateLimiter.mock_incr"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","DailySummaryRepository.__init__"],["TestDecayProcessorProcessUser.test_process_user_returns_none_when_within_grace","create_mock_user"],["NikitaMemory.add_relationship_episode","NikitaMemory.add_episode"],["UserRepository.__init__","PromptLoader.__init__"],["VicePreferenceRepository.__init__","UserNotFoundError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ConversationRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","PostProcessor.__init__"],["BaseRepository.delete_by_id","PendingRegistrationRepository.delete"],["ConversationThreadRepository.__init__","ScoringService.__init__"],["_ChapterBehaviorsProxy.values","_ChapterBehaviorsProxy.values"],["ConversationThreadRepository.__init__","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestDailySummaryRepositoryExtras.__init__"],["EngagementStateRepository.__init__","ConfigLoader.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TelegramBot.__init__"],["_ChapterBehaviorsProxy.get","_load_chapter_behaviors"],["ConversationThreadRepository.__init__","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","EngagementStateRepository.__init__"],["DecayCalculator.calculate_decay","is_overdue"],["run_migrations_offline","get_url"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ScoringService.__init__"],["MissingVariableError.__init__","UserMetricsRepository.__init__"],["ConversationThreadRepository.__init__","MissingVariableError.__init__"],["UserMetricsRepository.__init__","PromptLoader.__init__"],["ScoreHistoryRepository.__init__","__init__"],["TemplateGenerator.generate_prompt_legacy","generate_prompt"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","NikitaMemory.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ScoringService.__init__"],["ClinginessDetector.detect","ClinginessDetector._response_time_signal"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","MissingVariableError.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","PendingRegistrationRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ConfigLoader.__init__"],["ClinginessDetector.detect","NeglectDetector._response_time_signal"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ScoreAnalyzer.__init__"],["CalibrationCalculator.compute","CalibrationCalculator._timing_component"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","EngagementStateMachine.__init__"],["RateLimiter.check","expire"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","FactExtractor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","DecayProcessor.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","DailySummaryRepository.__init__"],["NikitaThoughtRepository.__init__","NikitaMemory.__init__"],["TestSessionDetector.test_detect_and_queue_skips_failed_marks","mock_mark"],["VicePreferenceRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestEdgeCases.test_empty_context_still_generates_valid_prompt","mock_meta_prompt_service"],["VicePreferenceRepository.__init__","GeneratedPromptRepository.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_capped_at_max","create_mock_user"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ScoreHistoryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ConfigLoader.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestVicePreferenceRepository.__init__"],["ResponseTimer.calculate_delay_human_readable","ResponseTimer.calculate_delay"],["TestLayer3RelationshipState.test_layer3_score_trend_variations","TestLayer6ResponseGuidelines._create_context"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","UserRepository.__init__"],["PendingRegistrationRepository.delete","BaseRepository.delete"],["VicePreferenceRepository.discover","get_by_category"],["_create_nikita_agent","note_user_fact"],["SessionDetector.detect_and_queue","mark_for_processing"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","EngagementStateRepository.__init__"],["ClinginessDetector.detect","ClinginessDetector._double_text_signal"],["TestSessionDetector.test_detect_and_queue_marks_all_found","TestSessionDetector.mock_get_stale"],["RecoveryManager.check_recovery_complete","RecoveryManager._check_distant_recovery"],["DatabaseRateLimiter.get_remaining","DatabaseRateLimiter._get_minute_window"],["ScoreCard","getStrokeColor"],["EngagementStateMachine._apply_transition","_get_transition_reason"],["EngagementStateRepository.__init__","ScoreAnalyzer.__init__"],["InMemoryCache.get","InMemoryCache._cleanup_expired"],["UserRepository.update_last_interaction","InMemoryCache.get"],["EngagementStateRepository.__init__","EngagementStateMachine.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ConversationThreadRepository.__init__"],["DailySummaryRepository.__init__","DailySummaryRepository.__init__"],["SessionDetector.detect_and_queue","get_stale_sessions"],["ConversationRepository.__init__","DatabaseRateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestDailySummaryRepositoryContextEngineering.__init__"],["MessageHandler.handle","MessageHandler.handle"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","SessionDetector.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","DailySummaryRepository.__init__"],["MetaPromptService.simulate_thoughts","_load_context"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","PromptLoader.__init__"],["VicePreferenceRepository.__init__","__init__"],["ConversationRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["DailySummaryRepository.__init__","EngagementStateRepository.__init__"],["UserNotFoundError.__init__","FactExtractor.__init__"],["RateLimiter.get_remaining","UserRepository.get"],["ConversationRepository.__init__","TelegramBot.__init__"],["TestLayer3RelationshipState.test_layer3_score_trend_variations","_create_context"],["NikitaMemory.add_episode","add_episode"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ScoreAnalyzer.__init__"],["NikitaThoughtRepository.__init__","DailySummaryRepository.__init__"],["GeneratedPromptRepository.__init__","ScoringService.__init__"],["TestNikitaThoughtRepository.test_create_thought_valid_types","mock_create"],["GeneratedPromptRepository.__init__","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","EngagementStateMachine.__init__"],["ConversationThreadRepository.__init__","MetaPromptService.__init__"],["InMemoryCache.get","_ChapterBehaviorsProxy.get"],["UserNotFoundError.__init__","ScoreHistoryRepository.__init__"],["GeneratedPromptRepository.__init__","CommandHandler.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","get_email_impl"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ScoreAnalyzer.__init__"],["GeneratedPromptRepository.__init__","MissingVariableError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","EngagementStateMachine.__init__"],["UserRepository.__init__","CommandHandler.__init__"],["TestNikitaThoughtRepository.test_expire_missing_him_thoughts_marks_used","mock_get_active"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestDailySummaryRepositoryContextEngineering.__init__"],["ScoreAnalyzer.analyze_batch","_call_llm_raw"],["VicePreferenceRepository.__init__","FactExtractor.__init__"],["CalibrationCalculator.compute","CalibrationCalculator._content_component"],["TestLayer6ResponseGuidelines.test_layer6_gap_based_adjustments","TestLayer6ResponseGuidelines._create_context"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","SessionDetector.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","NikitaMemory.__init__"],["DecayWarning","getStyles"],["TestSessionDetector.test_detect_and_queue_marks_all_found","TestSessionDetector.mock_mark"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","RegistrationHandler.__init__"],["NikitaThoughtRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["ConversationThreadRepository.__init__","TestUserMetricsRepository.__init__"],["ConversationRepository.__init__","TestVicePreferenceRepository.__init__"],["BaseRepository.update","get"],["UserMetricsRepository.update_metrics","get_by_user_id"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","DecayProcessor.__init__"],["PendingRegistrationRepository.get_email","get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","NikitaMemory.__init__"],["get_pool_status","get_async_engine"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","SkipDecision.__init__"],["MetaPromptService.generate_system_prompt","TemplateGenerator._load_context"],["NikitaThoughtRepository.expire_missing_him_thoughts","NikitaThoughtRepository.get_active_thoughts"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ScoreCalculator.__init__"],["analyze_neediness","_call_neediness_llm"],["DecayProcessor.process_user","DecayProcessor._handle_game_over"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","UserRepository.__init__"],["run_in_transaction","atomic"],["TestNikitaThoughtRepository.test_bulk_create_thoughts_creates_all","TestNikitaThoughtRepository.mock_create_thought"],["CalibrationCalculator.compute","_content_component"],["ScoreHistoryRepository.__init__","NikitaMemory.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ExperimentLoader.__init__"],["PromptLoader.render","load"],["DailySummaryRepository.__init__","SessionDetector.__init__"],["BaseRepository.get","BaseRepository.get"],["ScoreHistoryRepository.__init__","DecayProcessor.__init__"],["UserRepository.update_score","_ChapterBehaviorsProxy.get"],["ConversationThreadRepository.__init__","PostProcessor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","SessionDetector.__init__"],["TestLayer6ResponseGuidelines.test_layer6_gap_based_adjustments","_create_context"],["mock_meta_prompt_service","_mock_generator"],["ConversationThreadRepository.__init__","TemplateGenerator.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","DailySummaryRepository.__init__"],["BaseRepository.delete_by_id","BaseRepository.delete"],["NikitaThoughtRepository.__init__","SessionDetector.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","UserNotFoundError.__init__"],["EngagementStateRepository.__init__","ScoreCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","PromptLoader.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ConversationRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TemplateGenerator.__init__"],["UserMetricsRepository.update_metrics","UserMetricsRepository.get_by_user_id"],["BaseRepository.delete_by_id","PendingRegistrationRepository.get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","UserRepository.__init__"],["RateLimiter.check","DatabaseRateLimiter._seconds_until_midnight"],["GeneratedPromptRepository.__init__","MetaPromptService.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","DailySummaryRepository.__init__"],["MissingVariableError.__init__","VicePreferenceRepository.__init__"],["ClinginessDetector.detect","NeglectDetector._frequency_signal"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","NikitaThoughtRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","CommandHandler.__init__"],["UserRepository.__init__","MetaPromptService.__init__"],["ExperimentLoader._load_experiment_with_inheritance","deep_merge"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","DecayCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","EngagementStateRepository.__init__"],["ScoreHistoryRepository.__init__","DailySummaryRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ScoreCalculator.__init__"],["TestLayer3RelationshipState.test_layer3_boss_fight_status","TestLayer6ResponseGuidelines._create_context"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TestDailySummaryRepositoryContextEngineering.__init__"],["_AgentProxy._real_agent","get_nikita_agent"],["MissingVariableError.__init__","InMemoryCache.__init__"],["EngagementStateRepository.__init__","UserNotFoundError.__init__"],["EngagementStateMachine.update","_evaluate_transition"],["VicePreferenceRepository.__init__","NikitaMemory.__init__"],["RateLimiter.check","RateLimiter._get_minute_key"],["MetaPromptService.generate_system_prompt","MetaPromptService._load_context"],["proxy","setAll"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ScoreCalculator.__init__"],["GeneratedPromptRepository.__init__","TestUserMetricsRepository.__init__"],["DailySummaryRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","GeneratedPromptRepository.__init__"],["UserRepository.update_game_status","get"],["TelegramAuth.verify_magic_link","TelegramAuth.register_user"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","PromptLoader.__init__"],["UserRepository.__init__","TestUserMetricsRepository.__init__"],["TestLayer2CurrentMoment.test_layer2_gap_mood_variations","TestLayer2CurrentMoment._create_context"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","UserRepository.__init__"],["UserRepository.__init__","VicePreferenceRepository.__init__"],["ScoreAnalyzer._call_llm","ScoreAnalyzer._build_analysis_prompt"],["DatabaseRateLimiter.check","_get_minute_window"],["ScoreHistoryRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","UserNotFoundError.__init__"],["EngagementStateMachine.on_chapter_change","_reset_counters"],["NikitaThoughtRepository.__init__","UserRepository.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_within_grace_returns_none","create_mock_user"],["ScoreCalculator.calculate","_detect_events"],["TemplateGenerator.generate_prompt_legacy","_layer6_response_guidelines"],["UserMetricsRepository.__init__","TestUserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ScoringService.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ResponseDelivery.__init__"],["BaseRepository.update","BaseRepository.session"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","BaseRepository.__init__"],["MissingVariableError.__init__","UserNotFoundError.__init__"],["UserNotFoundError.__init__","TelegramAuth.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","UserNotFoundError.__init__"],["TestLayer3RelationshipState.test_layer3_boss_fight_status","_create_context"],["UserMetricsRepository.__init__","VicePreferenceRepository.__init__"],["GeneratedPromptRepository.__init__","PostProcessor.__init__"],["EngagementStateRepository.__init__","GeneratedPromptRepository.__init__"],["UserNotFoundError.__init__","EngagementStateRepository.__init__"],["UserRepository.__init__","InMemoryCache.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","SessionDetector.__init__"],["MetaPromptService.generate_system_prompt","MetaPromptService._log_prompt"],["GeneratedPromptRepository.__init__","TemplateGenerator.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","MissingVariableError.__init__"],["PendingRegistrationRepository.cleanup_expired","PendingRegistrationRepository.delete"],["NeglectDetector._response_time_signal","UserMetricsRepository._clamp"],["InMemoryCache.get","UserRepository.get"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ConfigLoader.__init__"],["UserRepository.__init__","PostProcessor.__init__"],["MissingVariableError.__init__","RateLimiter.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","PromptLoader.__init__"],["VicePreferenceRepository.__init__","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","SessionDetector.__init__"],["UserMetricsRepository.__init__","InMemoryCache.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ConversationRepository.__init__"],["NikitaThoughtRepository.__init__","PromptLoader.__init__"],["_ChapterBehaviorsProxy.get","PendingRegistrationRepository.get"],["TestLayer2CurrentMoment.test_layer2_time_of_day_variations","TestLayer3RelationshipState._create_context"],["CalibrationCalculator.compute","_clamp"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","MetaPromptService.__init__"],["ConfigLoader.__init__","_load_all_configs"],["VicePreferenceRepository.__init__","EngagementStateRepository.__init__"],["MetaPromptService._load_context","MetaPromptService._compute_nikita_activity"],["ScoreAnalyzer.analyze","_neutral_analysis"],["UserRepository.advance_chapter","PendingRegistrationRepository.get"],["OptimalFrequencyCalculator.get_bounds","OptimalFrequencyCalculator.get_tolerance_band"],["ScoreHistoryRepository.__init__","SessionDetector.__init__"],["NeglectDetector._frequency_signal","UserMetricsRepository._clamp"],["ConversationThreadRepository.__init__","RegistrationHandler.__init__"],["_ChapterBehaviorsProxy.keys","_ChapterBehaviorsProxy.keys"],["MissingVariableError.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","FactExtractor.__init__"],["MissingVariableError.__init__","GeneratedPromptRepository.__init__"],["UserRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","GeneratedPromptRepository.__init__"],["MetricItem","getProgressColor"],["VicePreferenceRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ScoreHistoryRepository.__init__"],["BaseRepository.update","_ChapterBehaviorsProxy.get"],["PendingRegistrationRepository.get_email","BaseRepository.get"],["ExperimentLoader._load_experiment_with_inheritance","_load_experiment_with_inheritance"],["PendingRegistrationRepository.get_email","_ChapterBehaviorsProxy.get"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestUserMetricsRepository.__init__"],["UserMetricsRepository.__init__","PendingRegistrationRepository.__init__"],["TestBaseRepositorySubclassing.test_subclass_can_access_session","custom_method"],["DailySummaryRepository.__init__","UserMetricsRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","VicePreferenceRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ScoreAnalyzer.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","UserRepository.__init__"],["PromptLoader.render","PromptLoader.load"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","EngagementStateMachine.__init__"],["ConversationRepository.__init__","ScoringService.__init__"],["EngagementStateRepository.__init__","FactExtractor.__init__"],["UserMetricsRepository.__init__","RateLimiter.__init__"],["ConversationRepository.__init__","BaseRepository.__init__"],["FactExtractor.extract_facts","_deduplicate_facts"],["UserRepository.__init__","ConversationThreadRepository.__init__"],["MissingVariableError.__init__","__init__"],["EngagementStateRepository.__init__","ScoreHistoryRepository.__init__"],["MessageHandler.handle","_send_rate_limit_response"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TelegramAuth.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","InMemoryCache.__init__"],["ConversationRepository.__init__","MissingVariableError.__init__"],["OptimalFrequencyCalculator.get_bounds","get_optimal"],["create_app","root"],["ConversationRepository.__init__","ConfigLoader.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestDailySummaryRepositoryExtras.__init__"],["ScoringService.score_batch","_log_history"],["ConversationThreadRepository.__init__","ScoreHistoryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","PostProcessor.__init__"],["VicePreferenceRepository.__init__","SessionDetector.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TelegramBot.__init__"],["UserMetricsRepository.__init__","ConversationThreadRepository.__init__"],["ScoreHistoryRepository.__init__","UserRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","FactExtractor.__init__"],["ConversationThreadRepository.__init__","NikitaThoughtRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","PromptLoader.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ScoreHistoryRepository.__init__"],["TestNikitaThoughtRepository.test_get_thoughts_for_prompt_groups_by_type","mock_get_active_thoughts"],["ConversationThreadRepository.__init__","DecayCalculator.__init__"],["TestDecayCalculatorIsOverdue.test_is_overdue_just_inside_grace_returns_false","create_mock_user"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","FactExtractor.__init__"],["InMemoryCache.incr","get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","PromptLoader.__init__"],["RateLimiter.__init__","InMemoryCache.incr"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ScoreHistoryRepository.__init__"],["TestConversationThreadRepository.test_create_thread_valid_types","mock_create"],["_get_chapter_behaviors","_load_chapter_behaviors"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","CommandHandler.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","PendingRegistrationRepository.__init__"],["GeneratedPromptRepository.__init__","RegistrationHandler.__init__"],["TestExtractionStage.test_stage_extraction_handles_parse_error","mock_meta_prompt_service"],["DecayProcessor.process_user","_log_decay_event"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestVicePreferenceRepository.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_includes_hours_overdue","create_mock_user"],["UserRepository.__init__","RegistrationHandler.__init__"],["ScoreHistoryRepository.__init__","PromptLoader.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","NikitaMemory.__init__"],["UserRepository.apply_decay","UserRepository.update_score"],["RateLimiter.__init__","get"],["ScoreAnalyzer.analyze_batch","_neutral_analysis"],["MissingVariableError.__init__","ResponseTimer.__init__"],["UserRepository.update_game_status","_ChapterBehaviorsProxy.get"],["EngagementStateMachine.update","_apply_transition"],["TestDecayProcessorShouldSkipUser.test_skip_boss_fight_status","create_mock_user"],["ConversationThreadRepository.bulk_create_threads","ConversationThreadRepository.create_thread"],["ConversationRepository.__init__","ScoreAnalyzer.__init__"],["UserNotFoundError.__init__","ExperimentLoader.__init__"],["UserMetricsRepository.__init__","RegistrationHandler.__init__"],["TestTemplateGeneratorBasics.test_generate_prompt_returns_string","mock_meta_prompt_service"],["ConversationRepository.__init__","EngagementStateMachine.__init__"],["RateLimiter.get_remaining","PendingRegistrationRepository.get"],["ConversationThreadRepository.__init__","ResponseDelivery.__init__"],["MetaPromptService._log_prompt","MetaPromptService._count_tokens"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TemplateGenerator.__init__"],["VicePreferenceRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","VicePreferenceRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ConversationThreadRepository.__init__"],["TestConversationThreadRepository.test_bulk_create_threads_creates_all","TestConversationThreadRepository.mock_create_thread"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_floor_at_zero","create_mock_user"],["EngagementStateRepository.__init__","NikitaMemory.__init__"],["UserMetricsRepository.update_metrics","GeneratedPromptRepository.get_by_user_id"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ScoreCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","UserMetricsRepository.__init__"],["CalibrationCalculator._frequency_component","_clamp"],["PendingRegistrationRepository.cleanup_expired","BaseRepository.delete"],["MetaPromptService._load_context","MetaPromptService._get_chapter_name"],["PromptLoader._substitute_variables","PromptLoader._get_nested_value"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","InMemoryCache.__init__"],["GeneratedPromptRepository.__init__","ScoreHistoryRepository.__init__"],["UserRepository.__init__","ResponseTimer.__init__"],["_ChapterBehaviorsProxy.keys","keys"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","DailySummaryRepository.__init__"],["GeneratedPromptRepository.__init__","NikitaThoughtRepository.__init__"],["DecayWarning","getMessage"],["VicePreferenceRepository.__init__","PromptLoader.__init__"],["GeneratedPromptRepository.__init__","DecayCalculator.__init__"],["UserRepository.__init__","NikitaThoughtRepository.__init__"],["UserMetricsRepository.__init__","ResponseTimer.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","VicePreferenceRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","EngagementStateRepository.__init__"],["MissingVariableError.__init__","NikitaMemory.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","MetaPromptService.__init__"],["UserNotFoundError.__init__","MessageHandler.__init__"],["BaseRepository.update","BaseRepository.create"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","NikitaMemory.__init__"],["create_telegram_router","set_webhook"],["BaseRepository.update","UserRepository.get"],["ScoringService.score_interaction","ScoringService._log_history"],["TestBaseRepositorySubclassing.test_subclass_can_access_session","TestBaseRepositorySubclassing.custom_method"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","CommandHandler.__init__"],["PendingRegistrationRepository.get_email","UserRepository.get"],["MissingVariableError.__init__","DecayProcessor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","RegistrationHandler.__init__"],["UserMetricsRepository.__init__","NikitaThoughtRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","SkipDecision.__init__"],["EngagementStateRepository.__init__","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","InMemoryCache.__init__"],["OptimalFrequencyCalculator.get_bounds","get_tolerance_band"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","handle_message"],["ClinginessDetector.detect","_length_ratio_signal"],["UserNotFoundError.__init__","UserMetricsRepository.__init__"],["DailySummaryRepository.__init__","VicePreferenceRepository.__init__"],["TestPipelineStatusMarking.test_pipeline_marks_processed_on_success","mock_meta_prompt_service"],["_build_system_prompt_legacy","build_system_prompt"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","RateLimiter.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ExperimentLoader.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestUserMetricsRepository.__init__"],["EngagementStateRepository.__init__","EngagementStateRepository.__init__"],["ConversationRepository.__init__","TemplateGenerator.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_past_grace_returns_decay_result","create_mock_user"],["ConversationThreadRepository.get_threads_for_prompt","get_open_threads"],["GeneratedPromptRepository.__init__","ResponseDelivery.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","VicePreferenceRepository.__init__"],["ConversationThreadRepository.__init__","TelegramAuth.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","DailySummaryRepository.__init__"],["NikitaThoughtRepository.__init__","TestUserMetricsRepository.__init__"],["analyze_neediness","_clamp"],["UserRepository.__init__","ResponseDelivery.__init__"],["ScoreCalculator.update_metrics","clamp"],["ConversationThreadRepository.__init__","TelegramBot.__init__"],["NikitaThoughtRepository.__init__","VicePreferenceRepository.__init__"],["DailySummaryRepository.__init__","InMemoryCache.__init__"],["InMemoryCache.incr","InMemoryCache._cleanup_expired"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ConversationThreadRepository.__init__"],["MissingVariableError.__init__","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestVicePreferenceRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","EngagementStateRepository.__init__"],["NikitaThoughtRepository.get_thoughts_for_prompt","get_active_thoughts"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","InMemoryCache.__init__"],["OptimalFrequencyCalculator.get_bounds","OptimalFrequencyCalculator.get_optimal"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ResponseTimer.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","SessionDetector.__init__"],["CalibrationCalculator._frequency_component","UserMetricsRepository._clamp"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","PostProcessor.__init__"],["NeglectDetector.detect","NeglectDetector._frequency_signal"],["_ChapterBehaviorsProxy.values","_load_chapter_behaviors"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","EngagementStateRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","RateLimiter.__init__"],["TestNikitaThoughtRepository.test_bulk_create_thoughts_creates_all","mock_create_thought"],["NikitaThoughtRepository.__init__","InMemoryCache.__init__"],["TestRateLimiter.test_ac_t024_2_tracks_per_minute_and_per_day_limits","mock_incr"],["UserMetricsRepository.__init__","DecayProcessor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","NikitaThoughtRepository.__init__"],["_ChapterBehaviorsProxy.get","_ChapterBehaviorsProxy.get"],["InMemoryCache.incr","_ChapterBehaviorsProxy.get"],["MissingVariableError.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","MessageHandler.__init__"],["atomic","atomic"],["EngagementStateMachine._apply_transition","EngagementStateMachine._reset_counters"],["create_telegram_router","receive_webhook"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ConversationThreadRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","MetaPromptService.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","PendingRegistrationRepository.__init__"],["TemplateGenerator.generate_prompt_legacy","TemplateGenerator._load_context"],["EngagementStateRepository.__init__","SessionDetector.__init__"],["UserRepository.update_game_status","UserRepository.get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","__init__"],["RateLimiter.__init__","_ChapterBehaviorsProxy.get"],["DailySummaryRepository.__init__","RateLimiter.__init__"],["TestNikitaThoughtRepository.test_create_missing_him_thought_72h","mock_create_thought"],["TestLayer4ConversationHistory.test_layer4_with_open_threads","TestLayer4ConversationHistory._create_context_with_history"],["TestLayer3RelationshipState.test_layer3_boss_fight_status","TestLayer3RelationshipState._create_context"],["NikitaThoughtRepository.__init__","PendingRegistrationRepository.__init__"],["InMemoryCache.get","PendingRegistrationRepository.get"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","FactExtractor.__init__"],["UserMetricsRepository.update_metrics","_clamp"],["ScoreHistoryRepository.__init__","MetaPromptService.__init__"],["ScoreAnalyzer.analyze","ScoreAnalyzer._call_llm"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ScoringService.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TestUserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","SessionDetector.__init__"],["TestTypingIndicators.test_no_periodic_typing_for_short_delays","TestTypingIndicators.mock_sleep"],["NikitaThoughtRepository.__init__","RateLimiter.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ScoreHistoryRepository.__init__"],["GeneratedPromptRepository.__init__","TelegramAuth.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","UserRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ResponseDelivery.__init__"],["UserRepository.__init__","DatabaseRateLimiter.__init__"],["DailySummaryRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["DailySummaryRepository.get_for_date","DailySummaryRepository.get_by_date"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","VicePreferenceRepository.__init__"],["ScoreAnalyzer.analyze_batch","_build_batch_prompt"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ConversationThreadRepository.__init__"],["analyze_neediness","UserMetricsRepository._clamp"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","SessionDetector.__init__"],["ClinginessDetector._length_ratio_signal","_clamp"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","MissingVariableError.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ConfigLoader.__init__"],["GeneratedPromptRepository.__init__","TelegramBot.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_game_over_triggered_at_zero","create_mock_user"],["UserRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["TestLayer5KnowledgeInnerLife.test_layer5_with_active_thoughts","_create_context_with_knowledge"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","VicePreferenceRepository.__init__"],["UserMetricsRepository.__init__","DatabaseRateLimiter.__init__"],["NikitaThoughtRepository.__init__","ConversationThreadRepository.__init__"],["UserRepository.update_last_interaction","BaseRepository.get"],["UserRepository.__init__","TelegramBot.__init__"],["ScoreHistoryRepository.__init__","TestUserMetricsRepository.__init__"],["MissingVariableError.__init__","ConversationRepository.__init__"],["TestDecayCalculatorIsOverdue.test_is_overdue_respects_chapter_grace_periods","create_mock_user"],["TestRateLimiter.test_ac_t024_2_tracks_per_minute_and_per_day_limits","TestRateLimiter.mock_incr"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ResponseTimer.__init__"],["ScoreHistoryRepository.__init__","VicePreferenceRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","PostProcessor.__init__"],["UserMetricsRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["MetricItem","getColor"],["EngagementStateRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","PromptLoader.__init__"],["DecayProcessor.process_all","DecayProcessor.process_user"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","InMemoryCache.__init__"],["NeglectDetector.detect","_clamp"],["TemplateGenerator.generate_prompt_legacy","TemplateGenerator._layer1_core_identity"],["get_memory_client","initialize"],["RateLimiter.__init__","InMemoryCache.expire"],["DailySummaryRepository.__init__","__init__"],["TemplateGenerator.generate_prompt_legacy","MetaPromptService._load_context"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","TestSessionPersistence.handle_message"],["TestTemplateGeneratorBasics.test_generate_prompt_contains_all_6_layers","mock_meta_prompt_service"],["ConversationThreadRepository.__init__","SkipDecision.__init__"],["TestDecayProcessorShouldSkipUser.test_process_active_status","create_mock_user"],["ExperimentLoader._load_experiment_with_inheritance","ExperimentLoader._load_experiment_with_inheritance"],["ScoreHistoryRepository.__init__","InMemoryCache.__init__"],["UserRepository.update_score","PendingRegistrationRepository.get"],["ScoreAnalyzer._call_llm","_build_analysis_prompt"],["UserRepository.__init__","TestVicePreferenceRepository.__init__"],["BaseRepository.update","PendingRegistrationRepository.session"],["ScoreHistoryRepository.__init__","PostProcessor.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","UserRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","RegistrationHandler.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","PendingRegistrationRepository.__init__"],["ConversationThreadRepository.__init__","ExperimentLoader.__init__"],["BaseRepository.update","session"],["NeglectDetector.detect","NeglectDetector._short_message_signal"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ResponseTimer.__init__"],["EngagementStateRepository.__init__","PromptLoader.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ScoreAnalyzer.__init__"],["MissingVariableError.__init__","UserRepository.__init__"],["ConversationRepository.__init__","FactExtractor.__init__"],["NikitaThoughtRepository.__init__","RegistrationHandler.__init__"],["TestLayer2CurrentMoment.test_layer2_time_of_day_variations","TestLayer2CurrentMoment._create_context"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","EngagementStateMachine.__init__"],["UserMetricsRepository.__init__","TestVicePreferenceRepository.__init__"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","TestSessionPersistence.get_user_by_telegram_id"],["NikitaMemory.add_nikita_event","NikitaMemory.add_episode"],["ConversationRepository.__init__","ScoreHistoryRepository.__init__"],["BaseRepository.delete","delete"],["MessageHandler.handle","store_pending_response"],["VicePreferenceRepository.discover","VicePreferenceRepository.get_by_category"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","DatabaseRateLimiter.__init__"],["UserMetricsRepository.update_metrics","UserMetricsRepository._clamp"],["UserMetricsRepository.__init__","ConversationRepository.__init__"],["NikitaThoughtRepository.expire_missing_him_thoughts","get_active_thoughts"],["NeglectDetector.detect","_response_time_signal"],["UserNotFoundError.__init__","InMemoryCache.__init__"],["ScoreHistoryRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","RateLimiter.__init__"],["ResponseDelivery.queue","_wait_with_typing"],["VicePreferenceRepository.__init__","VicePreferenceRepository.__init__"],["UserNotFoundError.__init__","ScoreCalculator.__init__"],["create_telegram_router","auth_confirm"],["ConversationRepository.__init__","DecayCalculator.__init__"],["TestLayer5KnowledgeInnerLife.test_layer5_with_user_facts","_create_context_with_knowledge"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","UserMetricsRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestDailySummaryRepositoryExtras.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ConversationThreadRepository.__init__"],["ClinginessDetector._length_ratio_signal","UserMetricsRepository._clamp"],["DailySummaryRepository.__init__","ResponseTimer.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TelegramBot.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","DecayProcessor.__init__"],["MissingVariableError.__init__","PromptLoader.__init__"],["MetaPromptService.__init__","MetaPromptService._load_templates"],["MetaPromptService.generate_system_prompt","_format_template"],["RateLimiter.check","_get_day_key"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","PromptLoader.__init__"],["TemplateGenerator.generate_prompt_legacy","TemplateGenerator.generate_prompt"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ResponseTimer.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ConversationThreadRepository.__init__"],["DatabaseRateLimiter.check","DatabaseRateLimiter._seconds_until_midnight"],["VicePreferenceRepository.__init__","InMemoryCache.__init__"],["InMemoryCache.incr","UserRepository.get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestVicePreferenceRepositoryExtras.__init__"],["ConversationThreadRepository.__init__","MessageHandler.__init__"],["TestExtractionStage.test_stage_extraction_parses_llm_response","mock_meta_prompt_service"],["NikitaThoughtRepository.__init__","ResponseTimer.__init__"],["UserNotFoundError.__init__","UserNotFoundError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","NikitaThoughtRepository.__init__"],["ScoreHistoryRepository.__init__","ConversationThreadRepository.__init__"],["get_nikita_agent_for_user","get_user_by_id"],["EngagementStateRepository.__init__","UserMetricsRepository.__init__"],["MessageHandler.handle","MessageHandler._send_rate_limit_response"],["RateLimiter.__init__","UserRepository.get"],["BaseRepository.get","get"],["GeneratedPromptRepository.__init__","SkipDecision.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestVicePreferenceRepository.__init__"],["NikitaThoughtRepository.__init__","NikitaThoughtRepository.__init__"],["_ChapterBehaviorsProxy.items","_ChapterBehaviorsProxy.items"],["UserNotFoundError.__init__","RateLimiter.__init__"],["CommandHandler._handle_status","_get_score_hint"],["ConversationThreadRepository.__init__","UserMetricsRepository.__init__"],["ClinginessDetector._frequency_signal","_clamp"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","DecayProcessor.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TelegramAuth.__init__"],["VicePreferenceRepository.__init__","PendingRegistrationRepository.__init__"],["CommandHandler._handle_status","CommandHandler._get_score_hint"],["GeneratedPromptRepository.__init__","ExperimentLoader.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","RegistrationHandler.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","EngagementStateRepository.__init__"],["MetaPromptService.generate_system_prompt","_load_context"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","UserMetricsRepository.__init__"],["TestLayer5KnowledgeInnerLife.test_layer5_with_active_thoughts","TestLayer5KnowledgeInnerLife._create_context_with_knowledge"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TemplateGenerator.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","__init__"],["VicePreferenceRepository.__init__","RateLimiter.__init__"],["UserNotFoundError.__init__","TestVicePreferenceRepositoryExtras.__init__"],["DailySummaryRepository.__init__","NikitaMemory.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","UserMetricsRepository.__init__"],["UserNotFoundError.__init__","GeneratedPromptRepository.__init__"],["ConversationThreadRepository.__init__","ConfigLoader.__init__"],["DailySummaryRepository.__init__","DecayProcessor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ResponseDelivery.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","DatabaseRateLimiter.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ScoreCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestDailySummaryRepositoryContextEngineering.__init__"],["ScoreHistoryRepository.__init__","RegistrationHandler.__init__"],["UserRepository.advance_chapter","InMemoryCache.get"],["BaseRepository.update","PendingRegistrationRepository.get"],["VicePreferenceRepository.__init__","ConversationThreadRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestDailySummaryRepositoryExtras.__init__"],["PendingRegistrationRepository.get_email","PendingRegistrationRepository.get"],["ExperimentLoader._load_experiment_with_inheritance","_list_available_experiments"],["NikitaThoughtRepository.__init__","DecayProcessor.__init__"],["TestLayer3RelationshipState.test_layer3_score_trend_variations","TestLayer2CurrentMoment._create_context"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ResponseTimer.__init__"],["GeneratedPromptRepository.__init__","MessageHandler.__init__"],["MissingVariableError.__init__","BaseRepository.__init__"],["UserNotFoundError.__init__","__init__"],["detect_stale_sessions","SessionDetector.detect_and_queue"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","UserNotFoundError.__init__"],["get_async_session","get_session_maker"],["MissingVariableError.__init__","CommandHandler.__init__"],["CalibrationCalculator.compute","CalibrationCalculator._frequency_component"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ResponseTimer.__init__"],["TestLayer3RelationshipState.test_layer3_game_over_status","TestLayer6ResponseGuidelines._create_context"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","NikitaThoughtRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","DatabaseRateLimiter.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","SessionDetector.__init__"],["ScoreAnalyzer.analyze","_call_llm"],["CalibrationCalculator._timing_component","_clamp"],["DatabaseRateLimiter.get_remaining","_get_minute_window"],["ConversationThreadRepository.__init__","ScoreAnalyzer.__init__"],["ConversationRepository.__init__","TelegramAuth.__init__"],["ScoreHistoryRepository.__init__","ResponseTimer.__init__"],["GeneratedPromptRepository.__init__","UserMetricsRepository.__init__"],["ConversationThreadRepository.__init__","EngagementStateMachine.__init__"],["ScoreCard","getScoreColor"],["atomic","wrapper"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestDailySummaryRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestVicePreferenceRepository.__init__"],["ConversationRepository.__init__","EngagementStateRepository.__init__"],["atomic","decorator"],["ClinginessDetector._frequency_signal","UserMetricsRepository._clamp"],["PromptLoader.replace_match","_get_nested_value"],["TestLayer5KnowledgeInnerLife.test_layer5_with_user_facts","TestLayer5KnowledgeInnerLife._create_context_with_knowledge"],["ScoreHistoryRepository.__init__","NikitaThoughtRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ConversationRepository.__init__"],["TestLayer4ConversationHistory.test_layer4_with_week_summaries","TestLayer4ConversationHistory._create_context_with_history"],["UserRepository.__init__","ScoringService.__init__"],["BaseRepository.session","session"],["DailySummaryRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["UserRepository.__init__","BaseRepository.__init__"],["NikitaThoughtRepository.create_missing_him_thought","NikitaThoughtRepository.create_thought"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","GeneratedPromptRepository.__init__"],["GeneratedPromptRepository.__init__","ConfigLoader.__init__"],["TestLayer3RelationshipState.test_layer3_game_over_status","_create_context"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","DatabaseRateLimiter.__init__"],["ExperimentLoader.load_experiment_config","_load_experiment_with_inheritance"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","VicePreferenceRepository.__init__"],["UserRepository.__init__","MissingVariableError.__init__"],["UserRepository.__init__","ConfigLoader.__init__"],["UserMetricsRepository.__init__","ScoringService.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ResponseDelivery.__init__"],["UserMetricsRepository.__init__","BaseRepository.__init__"],["NikitaThoughtRepository.__init__","DatabaseRateLimiter.__init__"],["TestLayer6ResponseGuidelines.test_layer6_gap_based_adjustments","TestLayer2CurrentMoment._create_context"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestVicePreferenceRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestDailySummaryRepositoryExtras.__init__"],["UserMetricsRepository.__init__","CommandHandler.__init__"],["TestConversationThreadRepository.test_bulk_resolve_threads_resolves_found","mock_resolve_thread"],["MetaPromptService._load_context","MetaPromptService._compute_nikita_energy"],["UserRepository.update_game_status","PendingRegistrationRepository.get"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TelegramBot.__init__"],["TestDecayProcessorProcessAll.test_process_all_returns_summary","create_mock_user"],["UserMetricsRepository.__init__","MissingVariableError.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","InMemoryCache.__init__"],["NikitaThoughtRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["UserMetricsRepository.calculate_composite","EngagementStateRepository.get_by_user_id"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ConversationRepository.__init__"],["TestNikitaThoughtRepository.test_expire_missing_him_thoughts_marks_used","TestNikitaThoughtRepository.mock_get_active"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","DecayProcessor.__init__"],["VicePreferenceRepository.__init__","ResponseTimer.__init__"],["MissingVariableError.__init__","MetaPromptService.__init__"],["ScoreHistoryRepository.__init__","ResponseDelivery.__init__"],["EngagementStateRepository.__init__","VicePreferenceRepository.__init__"],["TestConversationThreadRepository.test_get_threads_for_prompt_groups_by_type","mock_get_open_threads"],["TestLayer6ResponseGuidelines.test_layer6_time_based_adjustments","TestLayer6ResponseGuidelines._create_context"],["RateLimiter.get_remaining","InMemoryCache.get"],["BaseRepository.get","_ChapterBehaviorsProxy.get"],["ClinginessDetector._response_time_signal","_clamp"],["TestConversationThreadRepository.test_create_thread_valid_types","TestNikitaThoughtRepository.mock_create"],["TestDecayCalculatorIsOverdue.test_is_overdue_past_grace_returns_true","create_mock_user"],["session","session_maker"],["PostProcessor._get_extraction_agent","_get_extraction_system_prompt"],["TemplateGenerator.generate_prompt_legacy","_layer1_core_identity"],["NeglectDetector._response_time_signal","_clamp"],["CalibrationCalculator._timing_component","UserMetricsRepository._clamp"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestVicePreferenceRepository.__init__"],["GeneratedPromptRepository.__init__","ScoreAnalyzer.__init__"],["DailySummaryRepository.__init__","ConversationRepository.__init__"],["EngagementStateRepository.__init__","InMemoryCache.__init__"],["GeneratedPromptRepository.__init__","EngagementStateMachine.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","VicePreferenceRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","FactExtractor.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_includes_timestamp","create_mock_user"],["UserRepository.__init__","ScoreAnalyzer.__init__"],["TestNikitaThoughtRepository.test_create_missing_him_thought_72h","TestNikitaThoughtRepository.mock_create_thought"],["MissingVariableError.__init__","TestUserMetricsRepository.__init__"],["get_agent_id","get_elevenlabs_config"],["NikitaThoughtRepository.__init__","TestVicePreferenceRepository.__init__"],["ResponseDelivery._send_now","ResponseDelivery._split_message"],["UserRepository.__init__","EngagementStateMachine.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ScoreHistoryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ScoringService.__init__"],["UserNotFoundError.__init__","NikitaMemory.__init__"],["NeglectDetector._abrupt_ending_signal","_clamp"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","BaseRepository.__init__"],["analyze_distraction","_call_distraction_llm"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","VicePreferenceRepository.__init__"],["ConversationThreadRepository.__init__","ScoreCalculator.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","RateLimiter.__init__"],["NeglectDetector._frequency_signal","_clamp"],["TestLayer5KnowledgeInnerLife.test_layer5_with_missing_him_thought","_create_context_with_knowledge"],["NikitaThoughtRepository.__init__","ConversationRepository.__init__"],["UserMetricsRepository.__init__","ScoreAnalyzer.__init__"],["UserNotFoundError.__init__","DecayProcessor.__init__"],["DecayProcessor.process_user","_handle_game_over"],["TestTypingIndicators.test_ac_fr009_002_periodic_typing_during_delay","mock_sleep"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","InMemoryCache.__init__"],["UserMetricsRepository.__init__","EngagementStateMachine.__init__"],["TestLayer6ResponseGuidelines.test_layer6_time_based_adjustments","_create_context"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","MissingVariableError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ConfigLoader.__init__"],["TestNikitaThoughtRepository.test_get_thoughts_for_prompt_groups_by_type","TestNikitaThoughtRepository.mock_get_active_thoughts"],["TestSessionDetector.test_detect_and_queue_marks_all_found","mock_get_stale"],["MessageHandler.handle","CommandHandler.handle"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","DatabaseRateLimiter.__init__"],["TestLLMAnalysisFunctions.test_ac_2_3_6_results_cached_per_session","TestLLMAnalysisFunctions.mock_llm"],["CalibrationCalculator.compute","_timing_component"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","MessageHandler.__init__"],["TestLayer3RelationshipState.test_layer3_boss_fight_status","TestLayer2CurrentMoment._create_context"],["EngagementStateRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","InMemoryCache.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_uses_chapter_specific_rates","create_mock_user"],["UserMetricsRepository.__init__","MetaPromptService.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ConversationThreadRepository.__init__"],["MissingVariableError.__init__","PostProcessor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","DatabaseRateLimiter.__init__"],["ConversationRepository.__init__","SkipDecision.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TestDailySummaryRepositoryExtras.__init__"],["generate_response","build_system_prompt"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestDailySummaryRepositoryContextEngineering.__init__"],["VicePreferenceRepository.__init__","DecayProcessor.__init__"],["ConversationThreadRepository.__init__","UserNotFoundError.__init__"],["get_agent_id","ElevenLabsConfig.get_agents_dict"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TelegramBot.__init__"],["EngagementStateRepository.__init__","RateLimiter.__init__"],["NeglectDetector.detect","_abrupt_ending_signal"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestDailySummaryRepositoryExtras.__init__"],["ConversationRepository.__init__","ExperimentLoader.__init__"],["ScoreHistoryRepository.__init__","DatabaseRateLimiter.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","UserMetricsRepository.__init__"],["UserNotFoundError.__init__","DailySummaryRepository.__init__"],["ScoreCalculator.calculate","UserMetricsRepository.update_metrics"],["DatabaseRateLimiter.check","DatabaseRateLimiter._get_day_window"],["MetaPromptService.simulate_thoughts","TemplateGenerator._load_context"],["MissingVariableError.__init__","PendingRegistrationRepository.__init__"],["ScoreHistoryRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["EngagementStateRepository.__init__","ConversationThreadRepository.__init__"],["ClinginessDetector._response_time_signal","UserMetricsRepository._clamp"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","RateLimiter.__init__"],["EngagementStateRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestLayer2CurrentMoment.test_layer2_gap_mood_variations","TestLayer6ResponseGuidelines._create_context"],["ScoreHistoryRepository.__init__","TelegramBot.__init__"],["DailySummaryRepository.__init__","PromptLoader.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","TestVicePreferenceRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ScoreAnalyzer.__init__"],["TestRateLimiter.test_daily_limit_exceeded_blocks_message","TestRateLimiter.mock_incr"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","RateLimiter.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","EngagementStateMachine.__init__"],["NikitaMemory.search_memory","_get_group_id"],["ConversationThreadRepository.__init__","GeneratedPromptRepository.__init__"],["UserRepository.__init__","TemplateGenerator.__init__"],["get_nikita_agent_for_user","_get_nikita_agent_for_user"],["UserNotFoundError.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["get_nikita_agent_for_user","get_memory_client"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestVicePreferenceRepository.__init__"],["CalibrationCalculator.compute","_frequency_component"],["UserMetricsRepository.calculate_composite","get_by_user_id"],["get_memory_client","NikitaMemory.initialize"],["InMemoryCache.incr","PendingRegistrationRepository.get"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestVicePreferenceRepositoryExtras.__init__"],["NeglectDetector._abrupt_ending_signal","UserMetricsRepository._clamp"],["UserMetricsRepository.__init__","PostProcessor.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","GeneratedPromptRepository.__init__"],["GeneratedPromptRepository.__init__","ScoreCalculator.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ScoringService.__init__"],["ConversationThreadRepository.bulk_resolve_threads","resolve_thread"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","BaseRepository.__init__"],["MissingVariableError.__init__","ConversationThreadRepository.__init__"],["UserMetricsRepository.__init__","TemplateGenerator.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ConversationThreadRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ConversationRepository.__init__"],["ScoreHistoryRepository.__init__","TestVicePreferenceRepository.__init__"],["ConversationRepository.__init__","MessageHandler.__init__"],["ConfigLoader.__new__","__new__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","CommandHandler.__init__"],["EngagementStateMachine.on_chapter_change","EngagementStateMachine._reset_counters"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestVicePreferenceRepositoryExtras.__init__"],["get_agent_id","get_agents_dict"],["process_conversations","process_conversation"],["EngagementStateRepository.__init__","__init__"],["VicePreferenceRepository.__init__","DatabaseRateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","MissingVariableError.__init__"],["RateLimiter.__init__","PendingRegistrationRepository.get"],["ScoreHistoryRepository.__init__","ConversationRepository.__init__"],["_ChapterBehaviorsProxy.__iter__","_load_chapter_behaviors"],["RateLimiter.check","RateLimiter._get_day_key"],["generate_response","_generate_response"],["VicePreferenceRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["ClinginessDetector.detect","ClinginessDetector._frequency_signal"],["RecoveryManager.check_point_of_no_return","RecoveryManager._get_game_over_reason"],["GeneratedPromptRepository.__init__","UserNotFoundError.__init__"],["ConversationRepository.__init__","UserMetricsRepository.__init__"],["generate_system_prompt","generate_prompt"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ResponseTimer.__init__"],["BaseRepository.get","UserRepository.get"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","__init__"],["UserNotFoundError.__init__","SessionDetector.__init__"],["MetaPromptService.simulate_thoughts","MetaPromptService._load_context"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ScoringService.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","BaseRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","DailySummaryRepository.__init__"],["InMemoryCache.get","InMemoryCache.get"],["UserMetricsRepository.calculate_composite","UserMetricsRepository.get_by_user_id"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","__init__"],["TestLayer5KnowledgeInnerLife.test_layer5_with_missing_him_thought","TestLayer5KnowledgeInnerLife._create_context_with_knowledge"],["ConversationThreadRepository.__init__","FactExtractor.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","MissingVariableError.__init__"],["MissingVariableError.__init__","RegistrationHandler.__init__"],["UserNotFoundError.__init__","ConversationRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","EngagementStateRepository.__init__"],["MetaPromptService.generate_system_prompt","_log_prompt"],["TemplateGenerator.generate_prompt","generate_system_prompt"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TemplateGenerator.__init__"],["VicePreferenceRepository.__init__","TestVicePreferenceRepository.__init__"],["RateLimiter.get_remaining","RateLimiter._get_minute_key"],["EngagementStateRepository.__init__","ResponseTimer.__init__"],["GeneratedPromptRepository.__init__","GeneratedPromptRepository.__init__"],["DailySummaryRepository.__init__","BaseRepository.__init__"],["CalibrationCalculator._content_component","_clamp"],["DailySummaryRepository.__init__","CommandHandler.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ScoringService.__init__"],["NeglectDetector.detect","ClinginessDetector._response_time_signal"],["VicePreferenceRepository.__init__","ConversationRepository.__init__"],["ConversationThreadRepository.get_threads_for_prompt","ConversationThreadRepository.get_open_threads"],["PromptLoader.render","PromptLoader._substitute_variables"],["TestDecayProcessorProcessAll.test_process_all_tracks_game_overs","create_mock_user"],["NeglectDetector.detect","NeglectDetector._response_time_signal"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","BaseRepository.__init__"],["RateLimiter.check","InMemoryCache.incr"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","MetaPromptService.__init__"],["NikitaThoughtRepository.__init__","ScoringService.__init__"],["NikitaThoughtRepository.__init__","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ResponseTimer.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","MissingVariableError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ConfigLoader.__init__"],["NikitaThoughtRepository.__init__","CommandHandler.__init__"],["UserNotFoundError.__init__","UserRepository.__init__"],["NikitaMemory.search_memory","NikitaMemory._get_group_id"],["proxy","createServerClient"],["UserRepository.update_score","InMemoryCache.get"],["NikitaThoughtRepository.__init__","MissingVariableError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ResponseTimer.__init__"],["TestNikitaThoughtRepository.test_create_thought_valid_types","TestConversationThreadRepository.mock_create"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","DecayProcessor.__init__"],["GeneratedPromptRepository.__init__","__init__"],["TestLayer4ConversationHistory.test_layer4_with_open_threads","_create_context_with_history"],["TestSessionDetector.test_detect_and_queue_skips_failed_marks","TestSessionDetector.mock_mark"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","VicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestUserMetricsRepository.__init__"],["MissingVariableError.__init__","NikitaThoughtRepository.__init__"],["TestRateLimiter.test_ac_t024_3_get_remaining_returns_quota_info","TestRateLimiter.mock_get"],["ScoringService.score_batch","ScoringService._log_history"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","SessionDetector.__init__"],["CommandHandler._handle_status","CommandHandler._get_chapter_name"],["MissingVariableError.__init__","DecayCalculator.__init__"],["MetaPromptService._load_context","CommandHandler._get_chapter_name"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","MetaPromptService.__init__"],["TemplateGenerator.generate_prompt_legacy","_load_context"],["ConversationRepository.search","ConversationRepository.search"],["MetaPromptService._log_prompt","_count_tokens"],["UserNotFoundError.__init__","PromptLoader.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","InMemoryCache.__init__"],["TestLayer3RelationshipState.test_layer3_game_over_status","TestLayer3RelationshipState._create_context"],["GeneratedPromptRepository.__init__","FactExtractor.__init__"],["TestDecayProcessorProcessUser.test_process_user_applies_decay_when_overdue","create_mock_user"],["EngagementStateRepository.__init__","DecayProcessor.__init__"],["BaseRepository.session","BaseRepository.session"],["ConversationThreadRepository.__init__","NikitaMemory.__init__"],["UserRepository.__init__","FactExtractor.__init__"],["ScoreCalculator.calculate","update_metrics"],["UserRepository.update_last_interaction","get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","PostProcessor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ScoreAnalyzer.__init__"],["UserRepository.__init__","ScoreHistoryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","EngagementStateMachine.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestUserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","NikitaMemory.__init__"],["ExperimentLoader.load_experiment_config","ExperimentLoader._load_experiment_with_inheritance"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TemplateGenerator.__init__"],["DailySummaryRepository.__init__","MetaPromptService.__init__"],["CalibrationCalculator._content_component","UserMetricsRepository._clamp"],["TestConversationThreadRepository.test_get_threads_for_prompt_groups_by_type","TestConversationThreadRepository.mock_get_open_threads"],["_ChapterBehaviorsProxy.values","values"],["NikitaThoughtRepository.__init__","ScoreAnalyzer.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","DecayProcessor.__init__"],["NikitaThoughtRepository.__init__","EngagementStateMachine.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ScoringService.__init__"],["MissingVariableError.__init__","ResponseDelivery.__init__"],["UserRepository.__init__","DecayCalculator.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","BaseRepository.__init__"],["UserMetricsRepository.__init__","ScoreHistoryRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","UserNotFoundError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","DecayProcessor.__init__"],["TemplateGenerator.generate_prompt","MetaPromptService.generate_system_prompt"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","DatabaseRateLimiter.__init__"],["NikitaThoughtRepository.__init__","MetaPromptService.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestDailySummaryRepositoryContextEngineering.__init__"],["CommandHandler._handle_status","_get_chapter_name"],["PostProcessor._get_extraction_agent","PostProcessor._get_extraction_system_prompt"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","MissingVariableError.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","BaseRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","UserRepository.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ConfigLoader.__init__"],["TestPostProcessorBasics.test_process_conversation_full_pipeline_success","mock_meta_prompt_service"],["UserMetricsRepository.__init__","DecayCalculator.__init__"],["MetaPromptService._load_context","_get_chapter_name"],["DailySummaryRepository.__init__","TestUserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","RateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","PostProcessor.__init__"],["ScoreHistoryRepository.__init__","ScoringService.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","MissingVariableError.__init__"],["ConversationThreadRepository.__init__","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TemplateGenerator.__init__"],["ScoreHistoryRepository.__init__","BaseRepository.__init__"],["RecoveryManager.check_recovery_complete","RecoveryManager._check_clingy_recovery"],["MetaPromptService.extract_entities","_load_context"],["ScoreHistoryRepository.__init__","CommandHandler.__init__"],["RateLimiter.__init__","incr"],["ConversationThreadRepository.__init__","EngagementStateRepository.__init__"],["ScoreHistoryRepository.__init__","MissingVariableError.__init__"],["ScoreHistoryRepository.__init__","ConfigLoader.__init__"],["DatabaseRateLimiter.check","_get_day_window"],["EngagementStateRepository.__init__","DatabaseRateLimiter.__init__"],["ScoreCalculator.apply_multiplier","ScoreCalculator.adjust"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestVicePreferenceRepositoryExtras.__init__"],["EngagementStateRepository.__init__","TestDailySummaryRepositoryContextEngineering.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","GeneratedPromptRepository.__init__"],["analyze_distraction","_clamp"],["ConversationRepository.__init__","ScoreCalculator.__init__"],["PromptLoader._substitute_variables","replace_match"],["DailySummaryRepository.__init__","PostProcessor.__init__"],["TestLayer6ResponseGuidelines.test_layer6_time_based_adjustments","TestLayer3RelationshipState._create_context"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","get_user_by_telegram_id"],["EngagementStateRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","FactExtractor.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","store_impl"],["UserMetricsRepository.__init__","ResponseDelivery.__init__"],["TestRateLimiter.test_multiple_users_isolated","mock_incr"],["NikitaMemory.add_nikita_event","add_episode"],["GeneratedPromptRepository.__init__","NikitaMemory.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestVicePreferenceRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ScoreHistoryRepository.__init__"],["BaseRepository.update","InMemoryCache.get"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TemplateGenerator.__init__"],["UserNotFoundError.__init__","CommandHandler.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestDailySummaryRepositoryContextEngineering.__init__"],["detect_stale_sessions","detect_and_queue"],["TestSessionDetector.test_detect_and_queue_marks_all_found","mock_mark"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","ScoreAnalyzer.__init__"],["NikitaThoughtRepository.__init__","PostProcessor.__init__"],["TestDailySummaryRepositoryContextEngineering.test_update_summary_context_fields","EngagementStateMachine.__init__"],["TestDecayCalculatorCalculateDecay.test_calculate_decay_configurable_max","create_mock_user"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ConversationRepository.__init__"],["NeglectDetector.detect","NeglectDetector._abrupt_ending_signal"],["MissingVariableError.__init__","DatabaseRateLimiter.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","DecayCalculator.__init__"],["NikitaThoughtRepository.__init__","TemplateGenerator.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","DatabaseRateLimiter.__init__"],["ConversationRepository.__init__","UserNotFoundError.__init__"],["DailySummaryRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestDailySummaryRepositoryContextEngineering.__init__"],["TestDecayProcessorNoCatchUp.test_no_catch_up_decay_after_boss_resolved","create_mock_user"],["VicePreferenceRepository.__init__","ScoringService.__init__"],["ScoreAnalyzer._call_llm","ScoreAnalyzer._call_llm_raw"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","__init__"],["VicePreferenceRepository.__init__","BaseRepository.__init__"],["InMemoryCache.get","_cleanup_expired"],["MissingVariableError.__init__","TestDailySummaryRepositoryExtras.__init__"],["VicePreferenceRepository.__init__","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestDailySummaryRepositoryExtras.__init__"],["ConversationRepository.__init__","RateLimiter.__init__"],["RateLimiter.check","_get_minute_key"],["EngagementStateRepository.__init__","TestVicePreferenceRepository.__init__"],["MissingVariableError.__init__","TelegramBot.__init__"],["ScoreHistoryRepository.__init__","ScoreAnalyzer.__init__"],["VicePreferenceRepository.__init__","MissingVariableError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","RegistrationHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","MetaPromptService.__init__"],["ScoreHistoryRepository.__init__","EngagementStateMachine.__init__"],["ConversationThreadRepository.__init__","SessionDetector.__init__"],["UserRepository.advance_chapter","BaseRepository.get"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","UserMetricsRepository.__init__"],["NikitaMemory.add_user_fact","add_episode"],["UserMetricsRepository.calculate_composite","GeneratedPromptRepository.get_by_user_id"],["MessageHandler.handle","generate_response"],["EngagementStateRepository.__init__","ConversationRepository.__init__"],["GeneratedPromptRepository.__init__","DailySummaryRepository.__init__"]],"d":{"CLAUDE.md":["CLAUDE.md","Core Constraints","Start","Repository Hygiene","State File Size Limits"],"MAGIC_LINK_FIX.md":["Magic Link Authentication Fix","Issue Summary","Fixes Applied","1. Enhanced Error Handling (`nikita/api/routes/telegram.py`)","2. Portal URL Support (`nikita/config/settings.py`)","3. Dual Registration Flow Support (`nikita/platforms/telegram/auth.py`)","Environment Variables","Optional - for portal login flow","Deployment Steps","1. Deploy Backend Changes"],"NIKITA_SYSTEM_OVERVIEW.md":["Nikita: Don't Get Dumped - Complete System Overview","Table of Contents","1. Executive Summary","Core Innovation","Tech Stack","2. System Architecture","2.1 High-Level Architecture"],"README.md":["Nikita: Don't Get Dumped","Overview","Tech Stack","Project Structure","Quick Start","Prerequisites","Installation","Clone repository","Create virtual environment","or: .venv\\Scripts\\activate  # Windows"],"docs/README.md":["Nikita: Don't Get Dumped","The Game","Documentation Index","Game Design","Technical","Decisions & Audits","Verification Reports","Guides","Quick Reference","Scoring"],"docs/architecture/overview.md":["Nikita: Architecture Overview","Tech Stack","System Architecture","Three Knowledge Graphs","1. Nikita Graph","2. User Graph","3. Relationship Graph"],"docs/decisions/20251201-analysis-backend-db-audit.md":["Backend & Database Security Investigation Report","Verification Status (2025-12-01)","Executive Summary","1. Authentication Architecture Analysis","1.1 Current Implementation"],"docs/decisions/20251201-report-game-mechanics-audit.md":["Nikita Game Mechanics Comprehensive Audit Report","Executive Summary","Part One: The Chapter System","How Chapters Work","Chapter Progression Triggers","Implementation Status for Chapters","Part Two: The Scoring System","The Four Hidden Metrics","How Scores Are Calculated"],"docs/decisions/20251202-security-review-001.md":["Security Review Report: Nikita System","Executive Summary","1. AUTHENTICATION","1.1 Telegram Webhook Validation \u26a0\ufe0f CRITICAL","nikita/api/routes/telegram.py:179-227","Add to nikita/platforms/telegram/auth.py","Update nikita/api/routes/telegram.py:179","1.2 Supabase Auth Magic Link Flow \u2705 GOOD","nikita/platforms/telegram/auth.py:86-97"],"docs/decisions/20251202-system-audit-final-report.md":["Nikita System Audit - Final Report","Executive Summary","1. Specification Status","1.1 Complete Specs (11/14)","1.2 Newly Completed Specs (3/3)","2. Code-Spec Alignment Fixes Applied","2.1 constants.py Updates","2.2 Model Updates","3. Architecture Review Summary","3.1 Strengths"],"docs/game/journey.md":["Nikita: The Player Journey","The First 10 Minutes: The Hook","Her Opening","The Test Begins","Chapter 1: Curiosity (Days 1-14)","What You're Experiencing","Daily Pattern (Chapter 1)","Sample Week 1 Interactions","Chapter 1 Boss: \"Are You Worth My Time?\"","Chapter 2: Intrigue (Days 15-35)"],"docs/game/mechanics.md":["Nikita: Game Mechanics","The Core Loop","Scoring System","Single Composite Score","Hidden Sub-Metrics","Score Visibility","Chapter Progression","5 Chapters","Advancement Gate","Boss Encounters"],"docs/game/nikita.md":["Nikita: Character Profile","Who She Is","Her Voice","Intellectual Mode","Substance References (Authentic)","Fight-Picking Mode","Flirtation Mode","Vulnerability Mode (Earned)","The Disappearance","Emotional States"],"docs/guides/20251202-system-audio-guide.md":["Nikita: Don't Get Dumped - Complete System Audio Guide","Introduction and Overview","Part One: The Technology Stack","Compute Layer","The AI Agents","Memory and Database","Scheduling","Platform Integration","Part Two: System Architecture and Request Flow","Step One: Webhook Reception"],"docs/portal-testing-report.md":["Portal Testing Report","Executive Summary","Key Findings","1. Visual Testing Results","1.1 Landing Page Components","1.2 Responsive Design Testing","2. Functionality Testing","2.1 Email Input Validation","2.2 Button Interaction","3. Performance Analysis"],"docs/verification/20251201-verification-memory-rls.md":["Memory Files RLS Pattern Verification Report","Summary","Files Verified","Verification Criteria","1. Correct RLS Pattern Usage","2. RLS Best Practices Documentation","RLS Best Practices","3. Code Examples Consistency","4. Cross-File Consistency","Detailed Findings"],"event-stream.md":["Event Stream"],"memory/CHANGELOG.md":["Memory Changelog","[0.3.0] - 2025-12-09","Portal Frontend","Backend","[0.2.0] - 2025-12-09","Backend","Portal Frontend","[0.1.0] - 2025-12-08","Portal Frontend (008-player-portal)","Tech Stack"],"memory/README.md":["Memory Documentation Hub","Documentation Files","Navigation","Critical References","Phase 1 Status (Complete)","Next Steps (Phases 2-5)"],"memory/architecture.md":["System Architecture","Current State","High-Level Architecture (Option 1: Python Game Engine + Supabase Spine)","Component Hierarchy (Phase 1 Complete)"],"memory/backend.md":["Backend Architecture","Current State","Deployment: Google Cloud Run","cloud-run-config (inline or via cloudbuild.yaml)","FastAPI Application Structure","Text Agent Handler (\u2705 COMPLETE)","Database Schema (Supabase PostgreSQL)"],"memory/constitution.md":["Nikita Technical Constitution","Preamble","Article I: Architecture Principles","Section 1.1: Interface Invisibility","Section 1.2: Dual-Agent Architecture","Section 1.3: Platform Agnostic Communication","Article II: Data & Memory Principles","Section 2.1: Temporal Memory Persistence","Section 2.2: Score State Atomicity","Section 2.3: Vice Preference Learning"],"memory/game-mechanics.md":["Game Mechanics","Current State","Scoring System (Defined in Constants)","Composite = intimacy*0.30 + passion*0.25 + trust*0.25 + secureness*0.20","Implemented in: nikita/db/models/user.py:155-166","Chapter System (Constants Defined)","Boss Encounters (Constants Defined)","Decay System (Constants Defined - Dec 2025 Update: HOURLY Decay)","Vice Categories (Constants Defined)"],"memory/integrations.md":["External Integrations","Current State","Supabase Integration","Configuration (Phase 1 \u2705)","Usage Patterns (TODO Phase 2)","API/Backend: SQLAlchemy via direct PostgreSQL connection","Portal: Supabase Client SDK (for RLS, Auth)","Portal: OTP sign-in","User receives SMS code \u2192 enters \u2192 JWT token issued","Backend: Verify JWT from portal requests"],"memory/product.md":["Product Definition: Nikita - Don't Get Dumped","Product Overview","Name","Tagline","Vision","Problem Statement","Market Context","Value Proposition","Core Value","\"Our Thing\""],"memory/user-journeys.md":["User Journeys","Current State","Target Specs","Journey 1: New Player Onboarding","Journey 2: Chapter Progression"],"nikita/CLAUDE.md":["nikita/ Package Overview","Purpose","Module Structure","Key Files","Development Patterns","1. Settings Access","2. Memory System","3. Game Constants","Architecture","Next Steps"],"nikita/api/CLAUDE.md":["api/ - FastAPI Application","Purpose","Current State","Target Architecture (Phase 2-5)","Key Endpoints (TODO)","Telegram (Phase 2)","Voice (Phase 4)","Portal (Phase 5)","Patterns","Dependency Injection"],"nikita/context/CLAUDE.md":["context/ - Context Engineering Module","Purpose","Architecture","Components","SessionDetector (`session_detector.py`)","PostProcessor (`post_processor.py`)","TemplateGenerator (`template_generator.py`)","Database Tables","pg_cron Integration","Key Design Decisions"],"nikita/db/CLAUDE.md":["db/ - Database Layer","Purpose","Current State","Key Models","User (user.py:19-110)","UserMetrics (user.py:112-167)","UserVicePreference (user.py:169-207)","Repository Pattern \u2705 COMPLETE","Database Schema","Migrations \u2705 COMPLETE (via Supabase MCP)"],"nikita/engine/CLAUDE.md":["engine/ - Game Engine","Purpose","Current State","Key Constants","Scoring Formula (constants.py:51-57)","Composite = intimacy*0.30 + passion*0.25 + trust*0.25 + secureness*0.20","Chapter System (constants.py - updated Dec 2025)","Note: Decay is now HOURLY (compressed game), grace periods compressed too","Chapter Behaviors (constants.py:60-110)","Target Implementation (Phase 3)"],"nikita/memory/CLAUDE.md":["memory/ - Knowledge Graph System","Purpose","Current State","Three-Graph Architecture","Nikita Graph","User Graph","Relationship Graph","Key Methods","add_episode (graphiti_client.py:54-79)","search_memory (graphiti_client.py:81-118)"],"nikita/meta_prompts/CLAUDE.md":["meta_prompts/ - Meta-Prompt Architecture","Purpose","Architecture","Components","MetaPromptService (service.py)","Generate system prompt (~4000 tokens, ~150ms)","Detect vices in user message","Extract entities from conversation","Simulate Nikita's thoughts","Models (models.py)"],"nikita/meta_prompts/templates/entity_extraction.meta.md":["Entity Extraction Meta-Prompt","CONTEXT","ENTITY TYPES TO EXTRACT","1. User Facts","2. Conversation Threads","3. Emotional Markers","4. Nikita Thought Seeds","INPUT","Conversation Excerpt","User's Current Profile"],"nikita/meta_prompts/templates/system_prompt.meta.md":["System Prompt Generator for Nikita","CRITICAL CONTEXT","This is an ADULT GAME (18+)","Vice Categories are FEATURES","INPUT CONTEXT","User Profile","Game State","Hidden Metrics (inform behavior, NEVER reveal)","Vice Profile (CRITICAL - shape ALL responses around this)","Temporal Context"],"nikita/meta_prompts/templates/thought_simulation.meta.md":["Thought Simulation Meta-Prompt","WHO IS NIKITA","INPUT CONTEXT","Relationship State","User's Vice Profile","Recent Context","Temporal Context","YOUR TASK","Thought Types","Vice Integration"],"nikita/meta_prompts/templates/vice_detection.meta.md":["Vice Detection Meta-Prompt","CONTEXT","THE 8 VICE CATEGORIES","1. intellectual_dominance","2. risk_taking","3. substances","4. sexuality","5. emotional_intensity","6. rule_breaking","7. dark_humor"],"plan/master-plan.md":["Nikita Game - Technical Architecture & Implementation Plan","SDD Orchestration (Dec 2025 Update)","Implementation Order (by dependency)","Security Issues (Pre-Production Blockers)","Key Values (Updated Dec 2025)","Executive Summary","1. High-Level System Architecture"],"portal/PLAYWRIGHT_RESULTS.md":["Playwright E2E Test Results","Summary","Passing Tests \u2705","Landing Page (7/10 passing)","Responsive Design (4/4 passing)","Performance (5/7 passing)","Accessibility (1/7 passing)","Failing Tests \u274c","Accessibility (6 failures)","Landing Page (3 failures)"],"portal/README.md":["Nikita Portal","Overview","Features","Tech Stack","Quick Start","Install","Dev server","Build","Production","Environment Variables"],"portal/TESTING.md":["Portal Testing Guide","Prerequisites","Running the Portal Locally","Test 1: Authentication Flow","1.1 Magic Link Email Submission","1.2 Magic Link Click & Callback","1.3 Error Handling","Test 2: Dashboard Components","2.1 Header & Navigation","2.2 Dashboard Cards"],"portal/VERCEL_SETUP.md":["Vercel Deployment Setup","Prerequisites","Step 1: Connect GitHub Repository to Vercel","1.1 Import Project","1.2 Configure Project Settings","1.3 Environment Variables","1.4 Deploy","Step 2: Automatic Preview Deployments","2.1 On Every PR","2.2 On Every Push to Branch"],"specs/001-nikita-text-agent/audit-report.md":["Audit Report: 001-nikita-text-agent","Executive Summary","1. Requirements Coverage Analysis","Functional Requirements \u2192 Tasks Mapping","2. User Story \u2192 Task Mapping","P1 User Stories (Must-Have)","P2 User Stories (Important)","P3 User Stories (Deferred)","3. Acceptance Criteria Analysis","Spec ACs \u2192 Tasks Mapping"],"specs/001-nikita-text-agent/plan.md":["Implementation Plan: Nikita Text Agent","Executive Summary","Architecture Overview","Research Summary","Pydantic AI Patterns (from plan research)","Existing Infrastructure","User Story Implementation","US-1: Basic Conversation (P1)","US-2: Memory-Enriched Responses (P1)"],"specs/001-nikita-text-agent/spec.md":["Feature Specification: Nikita Text Agent","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Nikita Persona Consistency","FR-002: Chapter-Specific Behavior Adaptation","FR-003: Memory Context Integration","FR-004: Message Skipping Logic","FR-005: Response Timing Variation","FR-006: Conversation Quality Assessment"],"specs/001-nikita-text-agent/tasks.md":["Implementation Tasks: Nikita Text Agent","Overview","US-1: Basic Conversation (Priority: P1 - Must-Have) \u2705","T1.1: Create Nikita Persona Prompt","T1.2: Create NikitaDeps Dataclass","T1.3: Implement NikitaTextAgent","T1.4: Create Agent Factory","US-2: Memory-Enriched Responses (Priority: P1 - Must-Have) \u2705","T2.1: Implement Memory Context Injection","T2.2: Create recall_memory Tool"],"specs/002-telegram-integration/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/002-telegram-integration/plan.md":["Implementation Plan: 002-Telegram-Integration","Overview","Core Components","Message Flow","Infrastructure Dependencies","From 010-api-infrastructure","Webhook endpoint (already defined in infrastructure spec)","From 011-background-tasks","From 009-database-infrastructure","Repositories"],"specs/002-telegram-integration/spec.md":["Feature Specification: Telegram Platform Integration","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Bot Command Handling","FR-002: Text Message Routing","FR-003: User Authentication Flow","FR-004: Account Creation","FR-005: Session Management","FR-006: Rate Limiting"],"specs/002-telegram-integration/tasks.md":["Tasks: 002-Telegram-Integration","Phase 1: Setup","Phase 2: Bot Client Foundation","T004: Implement TelegramBot Client","T005: Create TelegramUpdate Model","Phase 3: US-1 New User Onboarding (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T008: Implement TelegramAuth Class","T009: Implement CommandHandler Class"],"specs/003-scoring-engine/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/003-scoring-engine/plan.md":["Implementation Plan: 003-Scoring-Engine","Goal","Summary","Technical Context","Existing Architecture (Intelligence Evidence)","Existing scoring patterns","Found: 20 files with scoring-related code","Constants check","Found: Lines 25-31 (thresholds), 51-57 (weights)","Constitution Check (Article VI)"],"specs/003-scoring-engine/spec.md":["Feature Specification: Scoring Engine","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Interaction Analysis","FR-002: Metric Delta Calculation","FR-003: Composite Score Calculation","FR-004: Score Bounds Enforcement","FR-005: Score History Logging","FR-006: Context-Aware Analysis"],"specs/003-scoring-engine/tasks.md":["Tasks: 003-Scoring-Engine","Phase 1: Setup","Phase 2: Foundational Models","T003: Create ResponseAnalysis Model","T004: Create ConversationContext Model","T005: Create ScoreEvent Model","Phase 3: US-1 Exchange Scoring (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T009: Implement ScoreAnalyzer Class"],"specs/004-chapter-boss-system/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Tasks \u2192 Requirements Mapping","Constitution Alignment","Article Compliance Matrix","Constitution Compliance Detail"],"specs/004-chapter-boss-system/plan.md":["Implementation Plan: Chapter & Boss System (004)","Goal","Summary","Technical Context","Existing Architecture (from Explore)","Architecture (CoD^\u03a3)","Component Flow","Module Structure","Dependencies (CoD^\u03a3)","Tasks (By User Story)"],"specs/004-chapter-boss-system/spec.md":["Feature Specification: Chapter & Boss System","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Boss Threshold Detection","FR-002: Boss Encounter Initiation","FR-003: Five Distinct Boss Challenges","FR-004: Boss Outcome Judgment","FR-005: Boss Pass Handling","FR-006: Boss Fail Handling"],"specs/004-chapter-boss-system/tasks.md":["Tasks: Chapter & Boss System (004)","Get symbols from existing engine code","Check existing user model","Find agent patterns","Phase 1: Setup (Shared Infrastructure)","T1: Create Boss State Machine Module","T2: [P] Create Boss Prompts Module","Phase 2: US-1 - Boss Trigger (Priority: P1)","Intelligence Queries for US-1","Find scoring patterns"],"specs/005-decay-system/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/005-decay-system/plan.md":["Implementation Plan: 005-Decay-System","Goal","Summary","Technical Context","Existing Architecture (Intelligence Evidence)","Existing decay constants","Found: Lines 33-49","User model with last_interaction_at","Found: nikita/db/models/user.py:66","Constitution Check (Article VI)"],"specs/005-decay-system/spec.md":["Feature Specification: Decay System","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Grace Period Enforcement (UPDATED)","FR-002: Chapter-Specific Decay Rates (UPDATED)","FR-003: Decay Calculation","FR-004: Scheduled Decay Application","FR-005: Decay Floor Protection","FR-006: Interaction Reset"],"specs/005-decay-system/tasks.md":["Tasks: 005-Decay-System","Phase 1: Setup","Phase 2: Foundational Models","T003: Create DecayResult Model","Phase 3: US-1 Grace Period Protection (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T005: Implement DecayCalculator.is_overdue() Method","Verification for US-1","Phase 4: US-2 Decay Application (P1 - Must-Have)"],"specs/006-vice-personalization/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/006-vice-personalization/plan.md":["Implementation Plan: 006-Vice-Personalization","Overview","Core Components","8 Vice Categories (constitution.md \u00a7II.3)","Existing Infrastructure","VicePreferenceRepository (COMPLETE)","UserVicePreference Model (COMPLETE)","Implementation Tasks","Task 1: Add Vice Constants","Detection confidence thresholds"],"specs/006-vice-personalization/spec.md":["Feature Specification: Vice Personalization System","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Vice Category Detection","FR-002: Conversation Analysis for Vice Signals","FR-003: Vice Intensity Scoring","FR-004: Multi-Vice Profiles","FR-005: Vice-Aware Prompt Injection","FR-006: Natural Vice Expression"],"specs/006-vice-personalization/tasks.md":["Tasks: 006-Vice-Personalization","Phase 1: Setup","Phase 2: Vice Detection Models","T005: Create ViceSignal Model","T006: Create ViceAnalysisResult Model","T007: Create ViceProfile Model","Phase 3: US-1 Vice Detection (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T010: Create Vice Analysis Prompt Template"],"specs/007-voice-agent/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/007-voice-agent/plan.md":["Implementation Plan: 007-Voice-Agent","Overview","Architecture (ElevenLabs Server Tools Pattern)","Key Insight: No WebSocket Server Needed","ElevenLabs Integration","Agent Configuration","Server Tool Endpoints","Implementation Tasks","Task 1: Create Voice Module Structure"],"specs/007-voice-agent/spec.md":["Feature Specification: Voice Agent","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Voice Call Initiation","FR-002: Real-Time Speech Processing","FR-003: Natural Voice Response","FR-004: Conversational Latency","FR-005: Same-Agent Personality","FR-006: Voice Call Scoring"],"specs/007-voice-agent/tasks.md":["Tasks: 007-Voice-Agent","Phase 1: Setup","Phase 2: Voice Models","T004: Create Voice Data Models","Phase 3: US-1 Start Voice Call (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T006: Implement Call Initiation Logic","T007: Create Call Initiation API Endpoint","Verification for US-1"],"specs/008-player-portal/CHANGELOG.md":["008-player-portal Changelog","[0.3.0] - 2025-12-09","Fixed","Changed","Added","[0.2.0] - 2025-12-09","Fixed","Added","Changed","[0.1.0] - 2025-12-08"],"specs/008-player-portal/audit-report.md":["Audit Report: 008-Player-Portal with Admin Dashboard","Executive Summary","Audit Checklist","1. FR \u2192 Task Coverage \u2705","2. User Story \u2192 Task Coverage \u2705","3. Database Schema Compatibility \u2705"],"specs/008-player-portal/plan.md":["Implementation Plan: 008-Player-Portal with Admin Dashboard","Overview","Architecture"],"specs/008-player-portal/spec.md":["Feature Specification: Player Portal with Admin Dashboard","Summary","Key Features","Functional Requirements","Authentication","User Dashboard"],"specs/008-player-portal/tasks.md":["Implementation Tasks: 008-Player-Portal with Admin Dashboard","Phase 1: Database & Backend Foundation","T1: Create generated_prompts Migration","T2: Create is_admin() Function","T3: Add RLS Policies for generated_prompts","T4: Add Admin RLS Bypass Policies","T5: Create Portal API Schemas","T6: Create Portal API Routes"],"specs/009-database-infrastructure/audit-report.md":["Audit Report: 009 Database Infrastructure","Summary","Requirement Coverage Audit","Functional Requirements","Non-Functional Requirements","User Stories","Acceptance Criteria Audit","AC Count per Task","AC Testability Check","Dependency Audit"],"specs/009-database-infrastructure/consistency-verification.md":["Spec 009 Consistency Verification Report","Executive Summary","Detailed Verification","1. spec.md RLS Performance Requirements (FR-003)","FR-003: Row-Level Security (RLS)","2. plan.md Phase 6 Security Remediation","Phase 6: Security Remediation (Audit Findings - 2025-12-01)","3. tasks.md Security Remediation Tasks (T15-T18)","User Story: US-004 Security Remediation (Priority: P1)","T15: Fix message_embeddings Schema Drift"],"specs/009-database-infrastructure/plan.md":["Implementation Plan: Database Infrastructure","Goal","Summary","Technical Context","Existing Architecture (Intelligence Evidence)","Database files found","Output: database.py, models/{base,user,conversation,game}.py, repositories/__init__.py","Repository pattern check","Output: nikita/db/CLAUDE.md (docs only, no implementation)","AsyncSession usage"],"specs/009-database-infrastructure/spec.md":["009: Database Infrastructure","Overview","Functional Requirements","FR-001: Repository Pattern Implementation","FR-002: Migration Management","FR-003: Row-Level Security (RLS)","FR-004: Connection Pooling","FR-005: Transaction Management","FR-006: Audit Logging","Non-Functional Requirements"],"specs/009-database-infrastructure/tasks.md":["Tasks: 009 Database Infrastructure","Overview","User Story: US-001 Repository Instantiation (Priority: P1)","T1: Create Base Repository Class","T2: Create UserRepository","T3: Create UserMetricsRepository","T4: Create ConversationRepository","T5: Create ScoreHistoryRepository","T6: Create VicePreferenceRepository and DailySummaryRepository","T7: Create Repository Dependencies"],"specs/010-api-infrastructure/audit-report.md":["Audit Report: 010-API-Infrastructure","Summary","Requirement Traceability","Functional Requirements \u2192 Tasks","User Stories \u2192 Tasks","Acceptance Criteria Compliance","Article III Check: \u22652 ACs per Task","Dependency Validation","Upstream Dependencies","Downstream Blocks"],"specs/010-api-infrastructure/plan.md":["Implementation Plan: 010-API-Infrastructure","Overview","Dependency Analysis","Existing Code Analysis","User Story Tasks","US-001: Portal Authentication (P1)","US-002: Webhook Security (P1)"],"specs/010-api-infrastructure/spec.md":["010: API Infrastructure","Overview","Functional Requirements","FR-001: FastAPI Application Structure","FR-002: Authentication Middleware","FR-003: Rate Limiting","FR-004: Request/Response Schemas","Portal Responses","Webhook Payloads","FR-005: Error Handling"],"specs/010-api-infrastructure/tasks.md":["Tasks: 010-API-Infrastructure","Overview","US-001: Portal Authentication (P1)","T1.1: Create Supabase JWT Verification Module","T1.2: Create get_current_user Dependency","T1.3: Create Portal Router with Protected Routes","T1.4: Update main.py with API v1 Prefix","US-002: Webhook Security (P1)","T2.1: Create Webhook Auth Dependencies","T2.2: Create Telegram Router Stub"],"specs/011-background-tasks/audit-report.md":["Audit Report: 011-Background-Tasks","Summary","Requirement Traceability","Functional Requirements \u2192 Tasks","User Stories \u2192 Tasks","Acceptance Criteria Compliance","Article III Check: \u22652 ACs per Task","Dependency Validation","Upstream Dependencies","Downstream Blocks"],"specs/011-background-tasks/plan.md":["Implementation Plan: 011-Background-Tasks","Overview","Dependency Analysis","Database Schema Required","pending_responses (for FR-002)","job_history (for FR-005)","daily_summaries (for FR-003)","User Story Tasks","US-001: Decay Application (P1)","US-002: Delayed Response Delivery (P1)"],"specs/011-background-tasks/spec.md":["011: Background Tasks Infrastructure","Overview","Functional Requirements","FR-001: Scheduled Decay Processing","FR-002: Delayed Message Delivery","FR-003: Daily Summary Generation","FR-004: Edge Function Execution","FR-005: Job Monitoring","FR-006: Task Idempotency","Non-Functional Requirements"],"specs/011-background-tasks/tasks.md":["Tasks: 011-Background-Tasks","Overview","US-001: Decay Application (P1)","T1.1: Create pending_responses Table Migration","T1.2: Create job_history Table Migration","T1.3: Create daily_summaries Table Migration","T1.4: Create apply_daily_decay SQL Function","T1.5: Schedule pg_cron Decay Job","US-002: Delayed Response Delivery (P1)","T2.1: Create deliver-responses Edge Function"],"specs/012-context-engineering/audit-report.md":["012 - Context Engineering System Audit Report","Executive Summary","1. Specification Completeness","1.1 User Stories Coverage","1.2 Technical Completeness","1.3 Token Budget Analysis","2. Plan Coverage","2.1 Spec-to-Plan Mapping","2.2 Dependency Chain","3. Tasks Breakdown"],"specs/012-context-engineering/plan.md":["012 - Context Engineering System Implementation Plan","Executive Summary","User Stories","US-1: State Collection (P1)","US-2: Temporal Context (P1)","US-3: Memory Summarization (P1)","US-4: Mood Computation (P1)","US-5: Prompt Assembly (P1)","US-6: Validation (P2)","US-7: Integration (P1)"],"specs/012-context-engineering/spec.md":["012 - Context Engineering System","1. Overview","1.1 Purpose","1.2 Goals","1.3 Non-Goals","2. Architecture","2.1 Pipeline Overview","2.2 Component Diagram","3. Data Structures","3.1 PlayerProfile"],"specs/012-context-engineering/tasks.md":["012 - Context Engineering System Tasks","User Story Organization","Phase 1: Data Models (2 hours)","T1.1: Create Context Module Structure","T1.2: Implement PlayerProfile Model","T1.3: Implement TemporalContext Model","T1.4: Implement MemoryContext Model","T1.5: Implement NikitaState Model","T1.6: Implement SystemPrompt Model","Phase 2: Stage Implementations (5 hours)"],"specs/013-configuration-system/audit-report.md":["013 - Configuration System Audit Report","Executive Summary","1. Specification Completeness","1.1 User Stories Coverage","1.2 Technical Completeness","2. Plan Coverage","2.1 Spec-to-Plan Mapping","2.2 Dependency Order","3. Tasks Breakdown","3.1 Task Quality"],"specs/013-configuration-system/plan.md":["013 - Configuration System Implementation Plan","Executive Summary","User Stories","US-1: Base Configuration Loading (P1)","US-2: Pydantic Schema Validation (P1)","US-3: ConfigLoader Singleton (P1)","US-4: Prompt File System (P2)","US-5: Experiment Overlays (P2)","US-6: Migration from constants.py (P1)","Technical Architecture"],"specs/013-configuration-system/spec.md":["013 - Configuration System","1. Overview","1.1 Purpose","1.2 Goals","1.3 Design Principles","2. Architecture","2.1 Three-Layer System"],"specs/013-configuration-system/tasks.md":["013 - Configuration System Tasks","User Story Organization","US-1: Base Configuration Loading (P1)","T1.1: Create Directory Structure","T1.2: Create game.yaml","T1.3: Create chapters.yaml (+ scoring, decay, engagement, vices, schedule)","US-2: Pydantic Schema Validation (P1)","T2.1: Create GameConfig Schema","T2.2: Create ChaptersConfig Schema","T2.3: Create EngagementConfig Schema"],"specs/014-engagement-model/audit-report.md":["014 - Engagement Model Audit Report","Executive Summary","1. Specification Completeness","1.1 User Stories Coverage","1.2 Technical Completeness","1.3 Mathematical Model Quality","2. Plan Coverage","2.1 Spec-to-Plan Mapping","2.2 Dependency Order","3. Tasks Breakdown"],"specs/014-engagement-model/plan.md":["014 - Engagement Model Implementation Plan","Executive Summary","User Stories","US-1: Engagement State Machine (P1)","US-2: Calibration Score Computation (P1)","US-3: Clinginess Detection (P1)","US-4: Neglect Detection (P1)","US-5: Recovery Mechanics (P2)","US-6: Chapter Transitions (P2)","Technical Architecture"],"specs/014-engagement-model/spec.md":["014 - Engagement Model","1. Overview","1.1 Purpose","1.2 Core Philosophy","1.3 Key Differences from Old Model","2. Engagement State Machine","2.1 State Diagram"],"specs/014-engagement-model/tasks.md":["014 - Engagement Model Tasks","User Story Organization","Phase 1: Core Models (2 hours)","T1.1: Create Engagement Module Structure","T1.2: Implement EngagementState Enum","T1.3: Create Database Models","T1.4: Create Database Migration","Phase 2: Detection Algorithms (3 hours)","T2.1: Implement ClinginessDetector","T2.2: Implement NeglectDetector"],"specs/CROSS_VALIDATION_REPORT.md":["Cross-Validation Report","Validation Summary","Detailed Validations","1. Calibration Multipliers (003, 013, 014)","2. Boss Thresholds (004, 013)","3. Grace Periods (005, 013)","4. Decay Rates (005, 013)","5. Recovery Penalties and Rates (005, 013, 014)","6. Tolerance Bands (013, 014)","7. Chapter Behavior Profiles (004, 013)"],"specs/SPEC_INVENTORY.md":["Nikita Spec Inventory","Spec Matrix","Implementation Order (Updated 2025-12-02)","Phase A: Infrastructure Foundation","Phase B: Core System Architecture (NEW)","Phase C: Core Game Engine","Phase D: Platform Integration","Phase E: Advanced Features","Infrastructure Coverage","009-database-infrastructure"],"todo/master-todo.md":["Master Todo - Nikita Game","SDD Specification Status \u2705 ALL 14 SPECS AUDITED","Critical Path: \u2705 013 \u2192 \u2705 014 \u2192 \u2705 003 \u2192 012 Pipeline \u2192 004/005 \u2192 Voice \u2192 Portal","SDD Implementation Phases","Phase 0: Documentation Sync \u2705 COMPLETE","Phase 1A: Security Hardening \u2705 COMPLETE (SEC-04 deferred)","Phase 2: Configuration System (013) \u2705 COMPLETE","Phase 3: Engagement Model (014) \u2705 COMPLETE","Phase 4: Scoring Engine (003) \u2705 COMPLETE","Phase 5: Context Engineering (012) \u26a0\ufe0f 70% COMPLETE"]},"deps":{"nikita/agents/text/__init__.py":["typing","uuid","pydantic_ai","nikita.agents.text.deps","nikita.agents.text.agent","nikita.config.settings","nikita.db.models.user","nikita.memory.graphiti_client","nikita.memory.graphiti_client"],"nikita/agents/text/agent.py":["functools","typing","pydantic_ai","nikita.agents.text.deps","nikita.engine.constants","nikita.prompts.nikita_persona","nikita.db.models.user","nikita.memory.graphiti_client","nikita.agents.text.tools","logging","nikita.db.database","nikita.context.template_generator"],"nikita/agents/text/deps.py":["dataclasses","typing","nikita.config.settings","nikita.db.models.user","nikita.memory.graphiti_client"],"nikita/agents/text/facts.py":["dataclasses","typing"],"nikita/agents/text/handler.py":["logging","dataclasses","datetime","typing","uuid","nikita.agents.text.facts","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text","nikita.agents.text.agent"],"nikita/agents/text/skip.py":["random","typing"],"nikita/agents/text/timing.py":["random","typing"],"nikita/agents/text/tools.py":["typing","pydantic_ai","nikita.agents.text.deps","warnings"],"nikita/api/dependencies/auth.py":["uuid","jwt","fastapi","fastapi.security","nikita.config.settings"],"nikita/api/main.py":["contextlib","typing","fastapi","fastapi.middleware.cors","nikita.config.settings","sqlalchemy","nikita.db.database","nikita.platforms.telegram.bot","nikita.api.routes","nikita.api.routes","nikita.api.routes","nikita.api.routes","uvicorn"],"nikita/api/routes/admin.py":["datetime","typing","uuid","fastapi","sqlalchemy","sqlalchemy.ext.asyncio","nikita.api.schemas.admin","nikita.api.schemas.portal","nikita.db.database","nikita.db.models.conversation","nikita.db.models.engagement","nikita.db.models.user","nikita.db.repositories.conversation_repository","nikita.db.repositories.engagement_repository","nikita.db.repositories.metrics_repository","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository"],"nikita/api/routes/portal.py":["datetime","typing","uuid","fastapi","sqlalchemy.ext.asyncio","nikita.api.dependencies.auth","nikita.api.schemas.portal","nikita.db.database","nikita.db.repositories.conversation_repository","nikita.db.repositories.engagement_repository","nikita.db.repositories.metrics_repository","nikita.db.repositories.score_history_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository","nikita.engine.constants"],"nikita/api/routes/tasks.py":["fastapi","nikita.config.settings","nikita.db.dependencies","nikita.db.database","nikita.db.repositories.pending_registration_repository","nikita.db.database","nikita.context.session_detector"],"nikita/api/routes/telegram.py":["typing","hmac","fastapi","fastapi.responses","pydantic","nikita.config.settings","nikita.agents.text.handler","nikita.db.database","nikita.db.dependencies","nikita.platforms.telegram.auth","nikita.platforms.telegram.bot","nikita.platforms.telegram.commands","nikita.platforms.telegram.delivery","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.models","nikita.platforms.telegram.rate_limiter","nikita.platforms.telegram.registration_handler"],"nikita/api/schemas/admin.py":["datetime","decimal","uuid","pydantic"],"nikita/api/schemas/conversation.py":["datetime","decimal","typing","uuid","pydantic"],"nikita/api/schemas/game.py":["datetime","decimal","typing","uuid","pydantic"],"nikita/api/schemas/portal.py":["datetime","decimal","uuid","pydantic"],"nikita/api/schemas/user.py":["datetime","decimal","uuid","pydantic"],"nikita/config/elevenlabs.py":["functools","pydantic","pydantic_settings"],"nikita/config/experiments.py":["nikita.config.experiments","__future__","os","copy","pathlib","typing","yaml"],"nikita/config/loader.py":["datetime","decimal","functools","pathlib","typing","yaml","nikita.config.schemas"],"nikita/config/prompt_loader.py":["nikita.config.prompt_loader","__future__","re","functools","pathlib","typing"],"nikita/config/schemas.py":["pydantic"],"nikita/config/settings.py":["functools","typing","pydantic","pydantic_settings"],"nikita/context/post_processor.py":["logging","dataclasses","datetime","typing","uuid","pydantic_ai","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.repositories.conversation_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thought_repository","nikita.meta_prompts"],"nikita/context/session_detector.py":["logging","uuid","sqlalchemy.ext.asyncio","nikita.db.repositories.conversation_repository"],"nikita/context/template_generator.py":["logging","dataclasses","datetime","decimal","typing","uuid","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.conversation_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.user_repository","nikita.engine.constants","nikita.meta_prompts"],"nikita/db/database.py":["collections.abc","functools","sqlalchemy.ext.asyncio","sqlalchemy.pool","supabase","nikita.config.settings"],"nikita/db/dependencies.py":["collections.abc","typing","fastapi","sqlalchemy.ext.asyncio","nikita.db.database","nikita.db.repositories.conversation_repository","nikita.db.repositories.metrics_repository","nikita.db.repositories.pending_registration_repository","nikita.db.repositories.score_history_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository"],"nikita/db/migrations/env.py":["asyncio","logging.config","alembic","sqlalchemy","sqlalchemy.engine","sqlalchemy.ext.asyncio","nikita.config.settings","nikita.db.models.base","nikita.db.models.conversation","nikita.db.models.game","nikita.db.models.user"],"nikita/db/migrations/versions/20251128_0001_initial_schema.py":["collections.abc","sqlalchemy","alembic","sqlalchemy.dialects"],"nikita/db/migrations/versions/20251128_0002_rls_policies.py":["collections.abc","alembic"],"nikita/db/migrations/versions/20251128_0003_fix_message_embeddings.py":["collections.abc","alembic","sqlalchemy"],"nikita/db/migrations/versions/20251128_0004_rls_performance.py":["collections.abc","alembic"],"nikita/db/migrations/versions/20251128_0005_consolidate_policies.py":["collections.abc","alembic"],"nikita/db/migrations/versions/20251128_0006_extensions_pending_reg.py":["collections.abc","alembic","sqlalchemy"],"nikita/db/migrations/versions/20251205_0007_rate_limits_table.py":["collections.abc","alembic","sqlalchemy"],"nikita/db/models/base.py":["datetime","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm"],"nikita/db/models/context.py":["datetime","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.conversation","nikita.db.models.user","nikita.db.models.base"],"nikita/db/models/conversation.py":["datetime","decimal","typing","uuid","pgvector.sqlalchemy","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.context","nikita.db.models.generated_prompt","nikita.db.models.user"],"nikita/db/models/engagement.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.user"],"nikita/db/models/game.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.user"],"nikita/db/models/generated_prompt.py":["datetime","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.conversation","nikita.db.models.user"],"nikita/db/models/pending_registration.py":["datetime","datetime","sqlalchemy","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.base"],"nikita/db/models/rate_limit.py":["datetime","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base"],"nikita/db/models/user.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.context","nikita.db.models.conversation","nikita.db.models.engagement","nikita.db.models.game","nikita.db.models.generated_prompt"],"nikita/db/repositories/base.py":["typing","uuid","sqlalchemy.ext.asyncio","nikita.db.models.base"],"nikita/db/repositories/conversation_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.repositories.base","sqlalchemy","sqlalchemy.dialects.postgresql"],"nikita/db/repositories/engagement_repository.py":["uuid","sqlalchemy","sqlalchemy.ext.asyncio","sqlalchemy.orm","nikita.db.models.engagement","nikita.db.repositories.base"],"nikita/db/repositories/generated_prompt_repository.py":["datetime","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.generated_prompt","nikita.db.repositories.base"],"nikita/db/repositories/metrics_repository.py":["decimal","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.base"],"nikita/db/repositories/pending_registration_repository.py":["datetime","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.ext.asyncio","nikita.db.models.base","nikita.db.models.pending_registration"],"nikita/db/repositories/score_history_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.base"],"nikita/db/repositories/summary_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.base"],"nikita/db/repositories/thought_repository.py":["datetime","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.context","nikita.db.repositories.base"],"nikita/db/repositories/thread_repository.py":["datetime","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.context","nikita.db.repositories.base"],"nikita/db/repositories/user_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","sqlalchemy.orm","nikita.db.models.game","nikita.db.models.user","nikita.db.repositories.base"],"nikita/db/repositories/vice_repository.py":["datetime","decimal","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.base"],"nikita/db/transactions.py":["asyncio","functools","logging","collections.abc","enum","typing","sqlalchemy.exc","sqlalchemy.ext.asyncio"],"nikita/engine/constants.py":["nikita.engine.constants","nikita.config","__future__","warnings","datetime","decimal","pathlib","typing","nikita.config.enums"],"nikita/engine/decay/calculator.py":["datetime","decimal","typing","nikita.engine.constants","nikita.engine.decay.models","uuid"],"nikita/engine/decay/models.py":["datetime","decimal","uuid","pydantic"],"nikita/engine/decay/processor.py":["datetime","decimal","typing","sqlalchemy.ext.asyncio","nikita.engine.decay.calculator","nikita.engine.decay.models","nikita.db.repositories.score_history_repository","nikita.db.repositories.user_repository"],"nikita/engine/engagement/calculator.py":["decimal","nikita.config.enums","nikita.engine.engagement.models"],"nikita/engine/engagement/detection.py":["decimal","typing","nikita.engine.engagement.models"],"nikita/engine/engagement/models.py":["decimal","typing","pydantic","nikita.config.enums"],"nikita/engine/engagement/recovery.py":["dataclasses","datetime","nikita.config.enums"],"nikita/engine/engagement/state_machine.py":["decimal","nikita.config.enums","nikita.engine.engagement.models"],"nikita/engine/scoring/analyzer.py":["logging","decimal","pydantic_ai","nikita.engine.constants","nikita.engine.scoring.models"],"nikita/engine/scoring/calculator.py":["dataclasses","decimal","nikita.config.enums","nikita.engine.constants","nikita.engine.scoring.models"],"nikita/engine/scoring/models.py":["decimal","typing","pydantic"],"nikita/engine/scoring/service.py":["logging","decimal","typing","uuid","nikita.config.enums","nikita.engine.scoring.analyzer","nikita.engine.scoring.calculator","nikita.engine.scoring.models","sqlalchemy.ext.asyncio","nikita.db.repositories.score_history_repository"],"nikita/memory/graphiti_client.py":["datetime","typing","graphiti_core","graphiti_core.llm_client.anthropic_client","graphiti_core.llm_client.config","graphiti_core.embedder","graphiti_core.embedder.openai","graphiti_core.nodes","nikita.config.settings"],"nikita/meta_prompts/models.py":["dataclasses","datetime","decimal","uuid"],"nikita/meta_prompts/service.py":["json","time","pathlib","typing","uuid","pydantic_ai","nikita.config.settings","nikita.meta_prompts.models","sqlalchemy.ext.asyncio","nikita.db.repositories.generated_prompt_repository","nikita.db.repositories.generated_prompt_repository","datetime","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository","nikita.engine.constants"],"nikita/platforms/telegram/auth.py":["re","typing","uuid","supabase","nikita.db.repositories.pending_registration_repository","nikita.db.repositories.user_repository","nikita.config.settings"],"nikita/platforms/telegram/bot.py":["html","httpx","nikita.config.settings"],"nikita/platforms/telegram/commands.py":["nikita.db.repositories.user_repository","nikita.platforms.telegram.auth","nikita.platforms.telegram.bot"],"nikita/platforms/telegram/delivery.py":["asyncio","uuid","nikita.platforms.telegram.bot"],"nikita/platforms/telegram/message_handler.py":["typing","nikita.agents.text.handler","nikita.db.repositories.user_repository","nikita.platforms.telegram.bot","nikita.platforms.telegram.delivery","nikita.platforms.telegram.models","nikita.platforms.telegram.rate_limiter"],"nikita/platforms/telegram/models.py":["pydantic"],"nikita/platforms/telegram/rate_limiter.py":["dataclasses","datetime","typing","uuid","asyncio","time","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.ext.asyncio","nikita.db.models.rate_limit","nikita.db.models.rate_limit","nikita.db.models.rate_limit"],"nikita/platforms/telegram/registration_handler.py":["re","nikita.platforms.telegram.auth","nikita.platforms.telegram.bot"],"portal/src/app/auth/callback/route.ts":["@/lib/supabase/server","next/server"],"portal/src/app/conversations/page.tsx":["react","next/navigation","@/components/ui/button","@/lib/supabase/client","@/hooks/use-dashboard-data","@/components/history/ConversationList","@/components/history/ConversationDetail","@/components/ui/card","@/components/layout/Navigation"],"portal/src/app/dashboard/page.tsx":["next/navigation","@/components/ui/button","@/lib/supabase/client","@/hooks/use-dashboard-data","@/components/dashboard/ScoreCard","@/components/dashboard/ChapterCard","@/components/dashboard/EngagementCard","@/components/dashboard/MetricsGrid","@/components/dashboard/VicesCard","@/components/dashboard/DecayWarning","@/components/ui/card","@/components/layout/Navigation"],"portal/src/app/history/page.tsx":["next/navigation","@/components/ui/button","@/lib/supabase/client","@/hooks/use-dashboard-data","@/components/history/ScoreHistoryGraph","@/components/history/DailySummaryCard","@/components/ui/card","@/lib/api/client","@tanstack/react-query","@/components/layout/Navigation"],"portal/src/app/layout.tsx":["next/font/google","portal/src/app/providers.tsx"],"portal/src/app/page.tsx":["react","next/navigation","@/components/ui/card","@/components/ui/input","@/components/ui/button","@/lib/supabase/client"],"portal/src/app/providers.tsx":["@tanstack/react-query","react"],"portal/src/components/dashboard/ChapterCard.tsx":["@/components/ui/card","@/components/ui/badge","@/components/ui/progress"],"portal/src/components/dashboard/DecayWarning.tsx":["@/components/ui/card","@/components/ui/badge"],"portal/src/components/dashboard/EngagementCard.tsx":["@/components/ui/card","@/components/ui/badge"],"portal/src/components/dashboard/MetricsGrid.tsx":["@/components/ui/card","@/components/ui/progress"],"portal/src/components/dashboard/ScoreCard.tsx":["@/components/ui/card","@/components/ui/badge"],"portal/src/components/dashboard/VicesCard.tsx":["@/components/ui/card","@/components/ui/progress"],"portal/src/components/history/ConversationDetail.tsx":["@/components/ui/card","@/components/ui/badge"],"portal/src/components/history/ConversationList.tsx":["@/components/ui/card","@/components/ui/badge"],"portal/src/components/history/DailySummaryCard.tsx":["@/components/ui/card","@/components/ui/badge"],"portal/src/components/history/ScoreHistoryGraph.tsx":["@/components/ui/card","recharts"],"portal/src/components/layout/Navigation.tsx":["next/link","next/navigation","@/lib/utils"],"portal/src/components/ui/badge.tsx":["react","@radix-ui/react-slot","class-variance-authority","@/lib/utils"],"portal/src/components/ui/button.tsx":["react","@radix-ui/react-slot","class-variance-authority","@/lib/utils"],"portal/src/components/ui/card.tsx":["react","@/lib/utils"],"portal/src/components/ui/input.tsx":["react","@/lib/utils"],"portal/src/components/ui/progress.tsx":["react","@radix-ui/react-progress","@/lib/utils"],"portal/src/hooks/use-dashboard-data.ts":["@tanstack/react-query","@/lib/api/client"],"portal/src/proxy.ts":["next/server","@/lib/supabase/proxy","@supabase/ssr"],"tests/agents/text/test_agent.py":["os","pytest","unittest.mock","nikita.agents.text","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.deps","nikita.agents.text.agent","nikita.prompts.nikita_persona","nikita.agents.text.agent","nikita.engine.constants","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","inspect","nikita.agents.text.agent","nikita.agents.text.agent","inspect"],"tests/agents/text/test_chapter_behavior.py":["pytest","unittest.mock","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.engine.constants","nikita.agents.text.agent","re","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent"],"tests/agents/text/test_deps.py":["pytest","dataclasses","unittest.mock","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps"],"tests/agents/text/test_factory.py":["pytest","uuid","unittest.mock","nikita.agents.text","nikita.agents.text","inspect","nikita.agents.text","inspect","nikita.agents.text","nikita.agents.text.deps","nikita.agents.text","nikita.agents.text","nikita.agents.text"],"tests/agents/text/test_facts.py":["pytest","unittest.mock","nikita.agents.text","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","inspect","nikita.agents.text.facts","inspect","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts"],"tests/agents/text/test_handler.py":["pytest","datetime","uuid","unittest.mock","dataclasses","nikita.agents.text","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","inspect","nikita.agents.text.handler","inspect","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler"],"tests/agents/text/test_handler_facts.py":["pytest","datetime","uuid","unittest.mock","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts"],"tests/agents/text/test_handler_skip.py":["pytest","datetime","uuid","unittest.mock","logging","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip"],"tests/agents/text/test_nikita_persona.py":["pytest","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona"],"tests/agents/text/test_skip.py":["pytest","statistics","nikita.agents.text","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","inspect","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip"],"tests/agents/text/test_timing.py":["pytest","statistics","nikita.agents.text","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing"],"tests/agents/text/test_tools.py":["os","pytest","datetime","unittest.mock","nikita.agents.text","nikita.agents.text.tools","nikita.agents.text.agent","nikita.agents.text.tools","inspect","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text","nikita.agents.text.tools","nikita.agents.text.agent","nikita.agents.text.tools","inspect","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools"],"tests/api/routes/test_tasks.py":["pytest","unittest.mock","fastapi","fastapi.testclient","nikita.api.routes.tasks"],"tests/api/routes/test_telegram.py":["pytest","unittest.mock","fastapi","fastapi.testclient","httpx","nikita.platforms.telegram.bot","nikita.platforms.telegram.commands","nikita.platforms.telegram.message_handler","nikita.api.routes.telegram","nikita.api.routes.telegram"],"tests/config/test_enums.py":["pytest","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums"],"tests/config/test_experiments.py":["os","tempfile","pytest","pathlib","unittest.mock","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments","nikita.config.experiments"],"tests/config/test_loader.py":["pytest","pathlib","decimal","datetime","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","time","nikita.config.loader","time","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config","nikita.config.loader","os"],"tests/config/test_prompt_loader.py":["os","time","tempfile","pytest","pathlib","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader","nikita.config.prompt_loader"],"tests/config/test_schemas.py":["pytest","pydantic","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas","nikita.config.schemas"],"tests/context/test_post_processor.py":["json","datetime","typing","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.models.game","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor","nikita.context.post_processor"],"tests/context/test_session_detector.py":["datetime","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector","nikita.context.session_detector"],"tests/context/test_template_generator.py":["datetime","decimal","typing","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.context","nikita.db.models.game","nikita.db.models.user","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator","nikita.context.template_generator"],"tests/db/integration/conftest.py":["os","dotenv","collections.abc","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","random"],"tests/db/integration/test_fulltext_search.py":["os","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.conversation_repository","nikita.db.repositories.user_repository"],"tests/db/integration/test_migrations.py":["os","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","os","pathlib","os","pathlib"],"tests/db/integration/test_repositories_integration.py":["os","datetime","decimal","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.models.game","nikita.db.models.user","nikita.db.repositories.conversation_repository","nikita.db.repositories.metrics_repository","nikita.db.repositories.score_history_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository"],"tests/db/integration/test_rls_policies.py":["os","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.user_repository"],"tests/db/repositories/test_base.py":["unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.base","sqlalchemy","sqlalchemy.dialects.postgresql","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base"],"tests/db/repositories/test_conversation_repository.py":["datetime","decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.repositories.conversation_repository"],"tests/db/repositories/test_metrics_repository.py":["decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.metrics_repository"],"tests/db/repositories/test_pending_registration_repository.py":["pytest","datetime","unittest.mock","nikita.db.models.pending_registration","nikita.db.repositories.pending_registration_repository"],"tests/db/repositories/test_score_history_repository.py":["datetime","decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.score_history_repository"],"tests/db/repositories/test_summary_repository.py":["datetime","decimal","typing","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.summary_repository"],"tests/db/repositories/test_thought_repository.py":["datetime","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.context","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository","nikita.db.repositories.thought_repository"],"tests/db/repositories/test_thread_repository.py":["datetime","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.context","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository","nikita.db.repositories.thread_repository"],"tests/db/repositories/test_user_repository.py":["decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.models.game","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","datetime","nikita.db.repositories.user_repository","nikita.db.models.user","datetime","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository"],"tests/db/repositories/test_vice_repository.py":["datetime","decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.vice_repository"],"tests/engine/decay/test_calculator.py":["datetime","decimal","unittest.mock","uuid","pytest","nikita.engine.constants","nikita.engine.decay.calculator","nikita.engine.decay.models"],"tests/engine/decay/test_models.py":["datetime","decimal","uuid","pytest","pydantic","nikita.engine.decay.models"],"tests/engine/decay/test_processor.py":["datetime","decimal","unittest.mock","uuid","pytest","nikita.engine.decay.models","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor","nikita.engine.decay.processor"],"tests/engine/engagement/test_calculator.py":["decimal","pytest","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.models","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator","nikita.config.enums","nikita.engine.engagement.calculator"],"tests/engine/engagement/test_detection.py":["datetime","decimal","unittest.mock","pytest","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.models","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.models","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","inspect","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection","nikita.engine.engagement.detection"],"tests/engine/engagement/test_integration.py":["datetime","decimal","pytest","nikita.config.enums","nikita.engine.engagement"],"tests/engine/engagement/test_models.py":["decimal","pytest","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.config.enums","nikita.engine.engagement","nikita.engine.engagement","nikita.engine.engagement","nikita.engine.engagement","nikita.engine.engagement.models","nikita.config.enums","nikita.engine.engagement.models","nikita.engine.engagement.models","nikita.engine.engagement.models","nikita.engine.engagement.models","nikita.engine.engagement.models","nikita.engine.engagement.models","nikita.engine.engagement.models"],"tests/engine/engagement/test_recovery.py":["datetime","decimal","uuid","pytest","nikita.config.enums","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery","nikita.engine.engagement.recovery"],"tests/engine/engagement/test_state_machine.py":["decimal","uuid","pytest","nikita.config.enums","nikita.engine.engagement.models","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine","nikita.engine.engagement.state_machine"],"tests/engine/scoring/test_analyzer.py":["decimal","unittest.mock","pytest","nikita.engine.scoring.analyzer","nikita.engine.scoring.models"],"tests/engine/scoring/test_calculator.py":["decimal","unittest.mock","pytest","nikita.config.enums","nikita.engine.scoring.calculator","nikita.engine.scoring.models"],"tests/engine/scoring/test_models.py":["decimal","pytest","pydantic","nikita.engine.scoring.models"],"tests/engine/scoring/test_service.py":["decimal","unittest.mock","uuid","pytest","nikita.config.enums","nikita.engine.scoring.models","nikita.engine.scoring.service"],"tests/platforms/telegram/test_auth.py":["pytest","unittest.mock","nikita.platforms.telegram.auth","nikita.db.models.user","uuid"],"tests/platforms/telegram/test_bot.py":["pytest","unittest.mock","nikita.platforms.telegram.bot","httpx"],"tests/platforms/telegram/test_commands.py":["pytest","unittest.mock","nikita.platforms.telegram.commands","nikita.db.models.user","decimal","uuid"],"tests/platforms/telegram/test_delivery.py":["pytest","unittest.mock","uuid","nikita.platforms.telegram.delivery"],"tests/platforms/telegram/test_errors.py":["pytest","unittest.mock","uuid","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.models"],"tests/platforms/telegram/test_message_handler.py":["pytest","unittest.mock","uuid","datetime","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.models","nikita.platforms.telegram.rate_limiter","nikita.agents.text.handler","nikita.db.models.user"],"tests/platforms/telegram/test_rate_limiter.py":["pytest","datetime","uuid","unittest.mock","nikita.platforms.telegram.rate_limiter"],"tests/platforms/telegram/test_registration_handler.py":["pytest","unittest.mock","nikita.platforms.telegram.registration_handler"],"tests/platforms/telegram/test_session_integration.py":["pytest","datetime","uuid","unittest.mock","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.delivery","nikita.platforms.telegram.models","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler"]},"dir_purposes":{"docs":"Project documentation","nikita/api":"API endpoints and route handlers","nikita/api/middleware":"Middleware functions and handlers","nikita/config":"Configuration files and settings","nikita/db/migrations":"Database migration files","nikita/db/models":"Data models and database schemas","nikita/engine/decay":"Data models and schemas","nikita/engine/engagement":"Data models and schemas","nikita/engine/scoring":"Data models and schemas","nikita/meta_prompts":"Data models and schemas","nikita/platforms/telegram":"Data models and schemas","portal":"Test files and test utilities","portal/src/app/auth/callback":"API routes and endpoints","portal/src":"Source code root directory","portal/tests":"Test files and test utilities","specs/001-nikita-text-agent":"Test files and test utilities","specs":"Test specifications","specs/002-telegram-integration":"Test files and test utilities","specs/003-scoring-engine":"Test files and test utilities","specs/004-chapter-boss-system":"Test files and test utilities","specs/005-decay-system":"Test files and test utilities","specs/006-vice-personalization":"Test files and test utilities","specs/007-voice-agent":"Test files and test utilities","specs/008-player-portal":"Test files and test utilities","specs/009-database-infrastructure":"Test files and test utilities","specs/010-api-infrastructure":"API endpoints and route handlers","specs/011-background-tasks":"Test files and test utilities","specs/012-context-engineering":"Test files and test utilities","specs/013-configuration-system":"Configuration files and settings","specs/014-engagement-model":"Test files and test utilities","tests/agents/text":"Test files and test utilities","tests/api/routes":"Test files and test utilities","tests/config":"Configuration files and settings","tests/context":"Test files and test utilities","tests/db/integration":"Test files and test utilities","tests/db/repositories":"Test files and test utilities","tests/engine/decay":"Test files and test utilities","tests/engine/engagement":"Test files and test utilities","tests/engine/scoring":"Test files and test utilities","tests/platforms/telegram":"Test files and test utilities"},"staleness":1764763023.731252}