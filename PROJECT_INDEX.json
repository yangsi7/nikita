{"at":"2025-12-02T18:03:23.837453","root":".","tree":[".","\u251c\u2500\u2500 docs/","\u2502   \u251c\u2500\u2500 architecture/","\u2502   \u251c\u2500\u2500 game/","\u2502   \u2514\u2500\u2500 README.md","\u251c\u2500\u2500 docs-to-process/","\u251c\u2500\u2500 memory/","\u2502   \u2514\u2500\u2500 README.md","\u251c\u2500\u2500 nikita/ (75 files)","\u2502   \u251c\u2500\u2500 agents/ (10 files)","\u2502   \u2502   \u251c\u2500\u2500 text/ (8 files)","\u2502   \u2502   \u2514\u2500\u2500 tools/ (1 files)","\u2502   \u251c\u2500\u2500 api/ (10 files)","\u2502   \u2502   \u251c\u2500\u2500 middleware/ (1 files)","\u2502   \u2502   \u251c\u2500\u2500 routes/ (3 files)","\u2502   \u2502   \u2514\u2500\u2500 schemas/ (4 files)","\u2502   \u251c\u2500\u2500 config/ (3 files)","\u2502   \u251c\u2500\u2500 db/ (27 files)","\u2502   \u2502   \u251c\u2500\u2500 migrations/ (8 files)","\u2502   \u2502   \u2502   \u2514\u2500\u2500 versions/ (6 files)"],"stats":{"total_files":116,"total_directories":111,"fully_parsed":{"python":115},"listed_only":{"json":1},"markdown_files":115},"f":{"nikita/api/routes/tasks.py":["p",["_get_task_secret:19:()>str | None::Get task authentication secret from settings.","verify_task_secret:27:async (authorization:str | None = Header(None, alias=\"Authorization\"),)>None:_get_task_secret:","apply_daily_decay:54:async (user_repo:UserRepoDep, _:None = Depends(verify_task_secret),)::","deliver_pending_messages:77:async (_:None = Depends(verify_task_secret),)::","generate_daily_summaries:97:async (summary_repo:SummaryRepoDep, _:None = Depends(verify_task_secret),)::","cleanup_expired_registrations:118:async (_:None = Depends(verify_task_secret),)::"]],"nikita/api/routes/telegram.py":["p",["_get_bot_from_state:54:(request:Request)>TelegramBot::","get_telegram_auth:81:async (user_repo:UserRepoDep, pending_repo:PendingRegistrationRepoDep,)>TelegramAuth::","get_command_handler:106:async (user_repo:UserRepoDep, telegram_auth:TelegramAuthDep, bot:BotDep,)>CommandHandler::","get_message_handler:130:async (user_repo:UserRepoDep, bot:BotDep,)>MessageHandler::","create_telegram_router:163:(bot:TelegramBot)>APIRouter:receive_webhook,set_webhook:"],{"WebhookResponse":["29",[]],"SetWebhookRequest":["35",["validate_https:42:(cls, v:str)>str::Validate that URL uses HTTPS."]]}],"nikita/db/migrations/versions/20251128_0003_fix_message_embeddings.py":["p",["upgrade:30:()>None::Add user_id column to message_embeddings and backfill from conversations.","downgrade:92:()>None::Remove user_id column from message_embeddings."]],"nikita/db/migrations/versions/20251128_0004_rls_performance.py":["p",["upgrade:27:()>None::Recreate RLS policies with (select auth.uid()) optimization.","downgrade:100:()>None::Restore original RLS policies without optimization."]],"nikita/db/migrations/versions/20251128_0005_consolidate_policies.py":["p",["upgrade:28:()>None::Remove any duplicate policies that may exist.","downgrade:84:()>None::No-op - we don't want to recreate duplicate policies."]],"nikita/db/migrations/versions/20251128_0006_extensions_pending_reg.py":["p",["upgrade:30:()>None::Move extensions and create pending_registrations table.","downgrade:128:()>None::Remove pending_registrations and move extensions back."]],"nikita/db/models/pending_registration.py":["p",{"PendingRegistration":["16",["is_expired:63:(self)>bool::"]]}],"nikita/db/repositories/pending_registration_repository.py":["p",{"PendingRegistrationRepository":["17",["__init__:29:(self, session:AsyncSession)>None::","session:38:(self)>AsyncSession::Access the database session.","store:47:async (self, telegram_id:int, email:str, expires_at:datetime | None = None,)>PendingRegistration::","get:84:async (self, telegram_id:int)>PendingRegistration | None::","get_email:102:async (self, telegram_id:int)>str | None:get:","delete:116:async (self, telegram_id:int)>bool:delete:","cleanup_expired:131:async (self)>int:delete:"]]}],"nikita/platforms/telegram/auth.py":["p",{"TelegramAuth":["21",["__init__:36:(self, supabase_client:SupabaseClient, user_repository:UserRepository, pending_registration_repository:PendingRegistrationRepository,)::","register_user:52:async (self, telegram_id:int, email:str,)>dict[str, Any]::","verify_magic_link:103:async (self, telegram_id:int, otp_token:str,)>Any:register_user:","link_telegram:159:async (self, user_id:UUID, telegram_id:int,)>None::","get_pending_email:185:async (self, telegram_id:int)>str | None::"]]}],"nikita/platforms/telegram/bot.py":["p",{"TelegramBot":["11",["__init__:14:(self)::Initialize bot with settings and HTTP client.","send_message:29:async (self, chat_id:int, text:str, parse_mode:str = \"HTML\",)>dict::","send_chat_action:66:async (self, chat_id:int, action:str = \"typing\",)>dict::","set_webhook:97:async (self, url:str)>dict::","close:126:async (self)::Close the HTTP client connection."]]}],"nikita/platforms/telegram/commands.py":["p",{"CommandHandler":["15",["__init__:35:(self, user_repository:UserRepository, telegram_auth:TelegramAuth, bot:TelegramBot,)::","handle:47:async (self, message:dict)>None::","_handle_start:68:async (self, message:dict)>None::","_handle_help:101:async (self, message:dict)>None::","_handle_status:122:async (self, message:dict)>None:_get_chapter_name,_get_score_hint:","_handle_call:155:async (self, message:dict)>None::","_handle_unknown:171:async (self, message:dict)>None::","_get_chapter_name:190:(chapter:int)>str::","_get_score_hint:209:(score:float)>str::"]]}],"nikita/platforms/telegram/delivery.py":["p",{"ResponseDelivery":["15",["__init__:28:(self, bot:TelegramBot)::","queue:42:async (self, user_id:UUID, chat_id:int, response:str, delay_seconds:int,)>None:_send_now,_wait_with_typing:","_wait_with_typing:65:async (self, chat_id:int, delay_seconds:int)>None::","_send_now:84:async (self, chat_id:int, response:str)>None:_split_message:","_split_message:108:(self, text:str)>list[str]::"]]}],"nikita/platforms/telegram/message_handler.py":["p",{"MessageHandler":["21",["__init__:35:(self, user_repository:UserRepository, text_agent_handler:TextAgentMessageHandler, response_delivery:ResponseDelivery, bot:TelegramBot, rate_limiter:Optional[RateLimiter] = None,)::","handle:51:async (self, message:TelegramMessage)>None:_send_error_response,_send_rate_limit_response,handle:","_send_rate_limit_response:130:async (self, chat_id:int, result)>None::","_send_error_response:152:async (self, chat_id:int)>None::"]]}],"nikita/platforms/telegram/models.py":["p",{"TelegramUser":["10",[]],"TelegramChat":["23",[]],"TelegramMessage":["32",[]],"TelegramUpdate":["51",[]]}],"nikita/platforms/telegram/rate_limiter.py":["p",{"RateLimitResult":["18",[]],"RateLimiter":["39",["__init__:55:(self, cache:Any)::","check:64:async (self, user_id:UUID)>RateLimitResult:_get_day_key,_get_minute_key,_seconds_until_midnight:","get_remaining:128:async (self, user_id:UUID)>dict:_get_day_key,_get_minute_key:","_get_minute_key:156:(self, user_id:UUID)>str::Generate cache key for per-minute limit.","_get_day_key:160:(self, user_id:UUID)>str::Generate cache key for per-day limit.","_seconds_until_midnight:165:(self)>int::Calculate seconds until midnight UTC (when daily limit resets)."]]}],"t/api/routes/test_tasks.py":["p",{"TestTaskRouteAuth":["15",["app:19:(self)::Create test FastAPI app with task routes.","client:26:(self, app)::Create test client.","test_decay_endpoint_exists:30:(self, client)::Verify POST /decay endpoint exists.","test_deliver_endpoint_exists:37:(self, client)::Verify POST /deliver endpoint exists.","test_summary_endpoint_exists:43:(self, client)::Verify POST /summary endpoint exists.","test_cleanup_endpoint_exists:49:(self, client)::Verify POST /cleanup endpoint exists.","test_auth_required_when_secret_configured:75:(self, client)::Verify endpoints require auth when secret is configured.","test_auth_succeeds_with_valid_bearer:86:(self, client)::Verify auth succeeds with correct bearer token.","test_auth_fails_with_wrong_bearer:98:(self, client)::Verify auth fails with incorrect bearer token."]],"TestDecayEndpoint":["111",["app:115:(self)::Create test FastAPI app.","client:122:(self, app)::Create test client.","test_decay_returns_expected_format:126:(self, client)::Verify /decay returns expected response format."]],"TestDeliverEndpoint":["139",["app:143:(self)::Create test FastAPI app.","client:150:(self, app)::Create test client.","test_deliver_returns_expected_format:154:(self, client)::Verify /deliver returns expected response format."]],"TestSummaryEndpoint":["167",["app:171:(self)::Create test FastAPI app.","client:178:(self, app)::Create test client.","test_summary_returns_expected_format:182:(self, client)::Verify /summary returns expected response format."]],"TestCleanupEndpoint":["195",["app:199:(self)::Create test FastAPI app.","client:206:(self, app)::Create test client.","test_cleanup_returns_expected_format:210:(self, client)::Verify /cleanup returns expected response format on success.","test_cleanup_handles_errors_gracefully:242:(self, client)::Verify /cleanup handles errors gracefully."]]}],"t/api/routes/test_telegram.py":["p",{"TestTelegramWebhook":["18",["mock_bot:22:(self)::Mock TelegramBot.","mock_command_handler:30:(self)::Mock CommandHandler.","mock_message_handler:37:(self)::Mock MessageHandler.","app:44:(self, mock_bot, mock_command_handler, mock_message_handler)::Create test FastAPI app with dependency overrides.","client:67:(self, app)::Create test client.","test_ac_fr001_001_webhook_receives_updates:71:(self, client)::","test_ac_t006_1_command_routed_to_command_handler:95:(self, client, mock_command_handler)::","test_ac_t006_2_text_routed_to_message_handler:120:(self, client, mock_message_handler)::","test_ac_t006_3_empty_update_handled_gracefully:143:(self, client)::","test_ac_t006_4_returns_200_quickly:156:(self, client)::","test_webhook_returns_ok_status:177:(self, client)::","test_edited_message_ignored:197:(self, client, mock_message_handler)::","test_callback_query_ignored:216:(self, client, mock_command_handler)::"]],"TestSetWebhook":["234",["mock_bot:238:(self)::Mock TelegramBot.","app:245:(self, mock_bot)::Create test FastAPI app with mocked bot.","client:257:(self, app)::Create test client.","test_set_webhook_endpoint_exists:261:(self, client, mock_bot)::","test_set_webhook_calls_bot:272:(self, client, mock_bot)::","test_set_webhook_requires_https:286:(self, client, mock_bot)::"]]}],"t/db/integration/conftest.py":["p",["test_database_url:29:()>str::","engine:41:(test_database_url:str)::Create async engine for tests.","session_maker:51:(engine)>async_sessionmaker[AsyncSession]::Create session maker for tests.","session:61:async (session_maker)>AsyncGenerator[AsyncSession, None]:session_maker:","clean_session:75:async (session_maker)>AsyncGenerator[AsyncSession, None]:session_maker:","test_user_id:86:()>str::Generate a unique test user ID.","test_telegram_id:92:()>int::Generate a unique test Telegram ID."]],"t/db/integration/test_fulltext_search.py":["p",{"TestJSONBTextSearch":["29",["user:36:async (self, session:AsyncSession)>User::Create a test user.","conv_repo:45:async (self, session:AsyncSession)>ConversationRepository::Create ConversationRepository.","test_search_finds_message_content:52:async (self, conv_repo:ConversationRepository, user:User)::Search finds conversations containing specific text.","test_search_returns_empty_for_no_match:81:async (self, conv_repo:ConversationRepository, user:User)::Search returns empty list when no matches.","test_search_is_case_insensitive:104:async (self, conv_repo:ConversationRepository, user:User)::Search should work regardless of case (JSONB cast to text).","test_search_only_returns_user_conversations:126:async (self, session:AsyncSession)::Search should only return conversations for the specified user."]],"TestSearchVectorSetup":["169",["test_conversations_table_can_be_searched:177:async (self, session:AsyncSession)::Verify conversations table supports text search.","test_jsonb_to_text_cast_works:197:async (self, session:AsyncSession)::Verify PostgreSQL can cast JSONB to text for searching."]]}],"t/db/integration/test_migrations.py":["p",{"TestMigrationStatus":["24",["test_alembic_version_table_exists:28:async (self, session:AsyncSession)::Verify alembic_version table exists.","test_has_current_migration_version:48:async (self, session:AsyncSession)::Verify a migration version is recorded."]],"TestSchemaIntegrity":["62",["test_users_table_structure:69:async (self, session:AsyncSession)::Verify users table has expected columns.","test_user_metrics_table_structure:93:async (self, session:AsyncSession)::Verify user_metrics table has expected columns.","test_conversations_table_structure:115:async (self, session:AsyncSession)::Verify conversations table has expected columns.","test_score_history_table_structure:137:async (self, session:AsyncSession)::Verify score_history table has expected columns."]],"TestIndexesExist":["159",["test_users_telegram_id_index:163:async (self, session:AsyncSession)::Verify index on users.telegram_id exists.","test_score_history_user_id_index:181:async (self, session:AsyncSession)::Verify index on score_history.user_id exists."]],"TestForeignKeyConstraints":["199",["test_user_metrics_references_users:203:async (self, session:AsyncSession)::Verify user_metrics.user_id references users.id.","test_conversations_references_users:234:async (self, session:AsyncSession)::Verify conversations.user_id references users.id."]],"TestMigrationReversibility":["259",["test_migration_files_have_downgrade:269:(self)::Verify migration files have downgrade functions.","test_migration_files_are_ordered:290:(self)::Verify migration files have proper ordering."]]}],"t/db/integration/test_repositories_integration.py":["p",{"TestUserRepositoryIntegration":["38",["user_repo:42:async (self, session:AsyncSession)>UserRepository::Create UserRepository with test session.","test_create_user_with_metrics:49:async (self, user_repo:UserRepository, test_telegram_id:int)::AC-T14.1: Create user with metrics using real database.","test_get_by_telegram_id:66:async (self, user_repo:UserRepository, test_telegram_id:int)::AC-T14.1: Get user by Telegram ID.","test_update_score_atomically:83:async (self, user_repo:UserRepository, test_telegram_id:int)::AC-T14.3: Update score is atomic."]],"TestConversationRepositoryIntegration":["108",["user:112:async (self, session:AsyncSession)>User::Create a test user.","conv_repo:121:async (self, session:AsyncSession)>ConversationRepository::Create ConversationRepository with test session.","test_create_conversation:128:async (self, conv_repo:ConversationRepository, user:User)::AC-T14.1: Create conversation with real database.","test_append_message_to_jsonb:144:async (self, conv_repo:ConversationRepository, user:User)::AC-T14.1: Append message updates JSONB array.","test_get_recent_conversations:165:async (self, conv_repo:ConversationRepository, user:User)::AC-T14.1: Get recent conversations ordered by time."]],"TestTransactionAtomicity":["179",["test_rollback_on_error:186:async (self, session:AsyncSession, test_telegram_id:int)::Verify transaction rollback on error.","test_multiple_operations_in_transaction:211:async (self, session:AsyncSession, test_telegram_id:int)::Verify multiple operations are atomic."]],"TestMetricsIntegration":["243",["user:247:async (self, session:AsyncSession)>User::Create a test user with metrics.","test_update_metrics_with_clamping:258:async (self, session:AsyncSession, user:User)::AC-T14.3: Metrics updates are atomic with clamping.","test_calculate_composite_score:277:async (self, session:AsyncSession, user:User)::AC-T14.3: Composite score calculation."]],"TestVicePreferenceIntegration":["288",["user:292:async (self, session:AsyncSession)>User::Create a test user.","test_discover_and_update_intensity:303:async (self, session:AsyncSession, user:User)::AC-T14.3: Vice discovery and update are atomic."]],"TestDailySummaryIntegration":["322",["user:326:async (self, session:AsyncSession)>User::Create a test user.","test_create_and_get_summary:337:async (self, session:AsyncSession, user:User)::AC-T14.1: Create and retrieve daily summary.","test_get_range:357:async (self, session:AsyncSession, user:User)::AC-T14.1: Get summaries in date range."]]}],"t/db/integration/test_rls_policies.py":["p",{"TestRLSPoliciesExist":["28",["test_rls_enabled_on_users_table:35:async (self, session:AsyncSession)::Verify RLS is enabled on users table.","test_rls_enabled_on_user_metrics_table:56:async (self, session:AsyncSession)::Verify RLS is enabled on user_metrics table.","test_rls_enabled_on_conversations_table:77:async (self, session:AsyncSession)::Verify RLS is enabled on conversations table.","test_rls_enabled_on_score_history_table:98:async (self, session:AsyncSession)::Verify RLS is enabled on score_history table."]],"TestRLSPolicyRules":["119",["test_users_table_has_user_isolation_policy:123:async (self, session:AsyncSession)::Verify users table has user isolation policy.","test_user_metrics_has_user_isolation_policy:148:async (self, session:AsyncSession)::Verify user_metrics table has user isolation policy."]],"TestRLSServiceRoleBypass":["165",["test_service_role_can_create_user:175:async (self, session:AsyncSession, test_telegram_id:int)::Service role can create users (bypasses RLS).","test_service_role_can_read_all_users:189:async (self, session:AsyncSession)::Service role can read all users (bypasses RLS)."]],"TestRLSUserIsolation":["201",["test_user_cannot_see_other_users_data:212:async (self, session:AsyncSession)::"]]}],"t/db/repositories/test_conversation_repository.py":["p",{"TestConversationRepository":["25",["mock_session:29:(self)>AsyncMock::Create a mock AsyncSession.","sample_conversation:40:(self)>Conversation::Create a sample Conversation entity.","test_create_conversation_basic:59:async (self, mock_session:AsyncMock)::AC-T4.1: create_conversation creates a new conversation.","test_create_conversation_with_boss_fight:80:async (self, mock_session:AsyncMock)::AC-T4.1: create_conversation with boss_fight flag.","test_create_conversation_defaults_started_at:102:async (self, mock_session:AsyncMock)::AC-T4.1: create_conversation defaults started_at to now.","test_append_message_adds_to_messages:125:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.2: append_message adds message to JSONB messages array.","test_append_message_without_analysis:147:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.2: append_message works without analysis parameter.","test_append_message_raises_if_not_found:163:async (self, mock_session:AsyncMock)::AC-T4.2: append_message raises ValueError if conversation not found.","test_get_recent_returns_conversations:182:async (self, mock_session:AsyncMock)::AC-T4.3: get_recent returns list of recent conversations.","test_get_recent_respects_limit:200:async (self, mock_session:AsyncMock)::AC-T4.3: get_recent respects the limit parameter.","test_get_recent_default_limit:217:async (self, mock_session:AsyncMock)::AC-T4.3: get_recent uses default limit of 10.","test_search_finds_conversations:236:async (self, mock_session:AsyncMock)::AC-T4.4: search finds conversations matching query.","test_search_returns_empty_for_no_match:254:async (self, mock_session:AsyncMock)::AC-T4.4: search returns empty list for no matches.","test_close_conversation_sets_ended_at:275:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.5: close_conversation sets ended_at timestamp.","test_close_conversation_with_score_delta:292:async (self, mock_session:AsyncMock, sample_conversation:Conversation)::AC-T4.5: close_conversation sets score_delta when provided.","test_close_conversation_raises_if_not_found:307:async (self, mock_session:AsyncMock)::AC-T4.5: close_conversation raises ValueError if not found."]],"TestConversationRepositoryJSONB":["317",["mock_session:321:(self)>AsyncMock::Create a mock AsyncSession.","test_messages_start_as_empty_list:332:async (self, mock_session:AsyncMock)::Verify new conversations have empty messages array.","test_multiple_messages_can_be_appended:345:async (self, mock_session:AsyncMock)::Verify multiple messages can be appended sequentially."]]}],"t/db/repositories/test_metrics_repository.py":["p",{"TestUserMetricsRepository":["22",["mock_session:26:(self)>AsyncMock::Create a mock AsyncSession.","sample_metrics:35:(self)>UserMetrics::Create a sample UserMetrics entity.","test_get_by_user_id_returns_metrics:54:async (self, mock_session:AsyncMock, sample_metrics:UserMetrics)::AC-T3.1: get_by_user_id returns UserMetrics for user.","test_get_by_user_id_returns_none_if_not_found:71:async (self, mock_session:AsyncMock)::AC-T3.1: get_by_user_id returns None if user not found.","test_update_metrics_applies_deltas:88:async (self, mock_session:AsyncMock):__init__:AC-T3.2: update_metrics applies deltas to metrics.","__init__:134:(self)::","test_update_metrics_clamps_to_bounds:129:async (self, mock_session:AsyncMock):__init__:AC-T3.2: update_metrics clamps values to 0-100.","test_update_metrics_raises_if_not_found:161:async (self, mock_session:AsyncMock)::AC-T3.2: update_metrics raises ValueError if user not found.","test_calculate_composite_returns_score:178:async (self, mock_session:AsyncMock, sample_metrics:UserMetrics)::AC-T3.3: calculate_composite returns calculated score.","test_calculate_composite_raises_if_not_found:194:async (self, mock_session:AsyncMock)::AC-T3.3: calculate_composite raises ValueError if not found."]],"TestUserMetricsRepositoryHelpers":["206",["test_clamp_values:209:(self)::Verify _clamp helper clamps values correctly."]]}],"t/db/repositories/test_pending_registration_repository.py":["p",{"TestPendingRegistrationRepository":["17",["mock_session:21:(self)::Create a mock async session.","repository:27:(self, mock_session)::Create repository with mocked session.","test_ac_t046_2_store_creates_pending_registration:34:async (self, repository, mock_session)::","test_get_returns_registration_if_exists:68:async (self, repository, mock_session)::","test_get_returns_none_if_not_found:93:async (self, repository, mock_session)::","test_get_email_returns_email_string:113:async (self, repository, mock_session)::","test_get_email_returns_none_if_not_found:137:async (self, repository, mock_session)::","test_delete_removes_registration:155:async (self, repository, mock_session)::","test_delete_returns_false_if_not_found:176:async (self, repository, mock_session)::","test_ac_t046_5_cleanup_expired_deletes_old_registrations:194:async (self, repository, mock_session)::","test_store_with_custom_expiry:215:async (self, repository, mock_session)::"]]}],"t/db/repositories/test_score_history_repository.py":["p",{"TestScoreHistoryRepository":["23",["mock_session:27:(self)>AsyncMock::Create a mock AsyncSession.","sample_history_entries:37:(self)>list[ScoreHistory]::Create sample ScoreHistory entries for testing.","test_log_event_creates_record:57:async (self, mock_session:AsyncMock)::AC-T5.1: log_event creates a new history record.","test_log_event_without_optional_fields:82:async (self, mock_session:AsyncMock)::AC-T5.1: log_event works without optional event_type and event_details.","test_log_event_sets_recorded_at:98:async (self, mock_session:AsyncMock)::AC-T5.1: log_event automatically sets recorded_at timestamp.","test_log_event_supports_all_event_types:116:async (self, mock_session:AsyncMock)::AC-T5.1: log_event supports all event types.","test_get_history_returns_entries:141:async (self, mock_session:AsyncMock, sample_history_entries:list[ScoreHistory])::AC-T5.2: get_history returns list of history entries.","test_get_history_respects_limit:158:async (self, mock_session:AsyncMock)::AC-T5.2: get_history respects limit parameter.","test_get_history_default_limit:174:async (self, mock_session:AsyncMock)::AC-T5.2: get_history uses default limit of 50.","test_get_history_returns_empty_for_new_user:192:async (self, mock_session:AsyncMock)::AC-T5.2: get_history returns empty list for user with no history.","test_get_daily_stats_returns_stats:209:async (self, mock_session:AsyncMock)::AC-T5.3: get_daily_stats returns aggregated stats.","test_get_daily_stats_returns_empty_for_no_events:245:async (self, mock_session:AsyncMock)::AC-T5.3: get_daily_stats returns empty stats for no events.","test_get_daily_stats_handles_unknown_event_type:269:async (self, mock_session:AsyncMock)::AC-T5.3: get_daily_stats handles events without event_type."]],"TestScoreHistoryRepositoryExtras":["290",["mock_session:294:(self)>AsyncMock::Create a mock AsyncSession.","test_get_events_by_type:304:async (self, mock_session:AsyncMock)::Verify get_events_by_type filters by event type."]]}],"t/db/repositories/test_summary_repository.py":["p",{"TestDailySummaryRepository":["24",["mock_session:28:(self)>AsyncMock::Create a mock AsyncSession.","sample_summaries:39:(self)>list[DailySummary]::Create sample DailySummary entries.","test_create_summary_basic:63:async (self, mock_session:AsyncMock)::AC-T6.4: create_summary creates a new summary record.","test_create_summary_with_all_fields:82:async (self, mock_session:AsyncMock)::AC-T6.4: create_summary with all optional fields.","test_create_summary_sets_created_at:112:async (self, mock_session:AsyncMock)::AC-T6.4: create_summary sets created_at timestamp.","test_get_by_date_returns_summary:134:async (self, mock_session:AsyncMock, sample_summaries:list[DailySummary])::AC-T6.5: get_by_date returns summary for specific date.","test_get_by_date_returns_none_if_not_found:152:async (self, mock_session:AsyncMock)::AC-T6.5: get_by_date returns None if no summary for date.","test_get_range_returns_summaries:169:async (self, mock_session:AsyncMock, sample_summaries:list[DailySummary])::AC-T6.6: get_range returns list of summaries in range.","test_get_range_returns_empty_for_no_summaries:190:async (self, mock_session:AsyncMock)::AC-T6.6: get_range returns empty list if no summaries in range.","test_get_range_single_day:208:async (self, mock_session:AsyncMock)::AC-T6.6: get_range works for single day range."]],"TestDailySummaryRepositoryExtras":["225",["mock_session:229:(self)>AsyncMock::Create a mock AsyncSession.","test_update_summary_updates_fields:240:async (self, mock_session:AsyncMock):__init__:Verify update_summary updates specified fields.","__init__:274:(self)::","test_update_summary_partial_update:269:async (self, mock_session:AsyncMock):__init__:Verify update_summary allows partial updates.","test_update_summary_raises_if_not_found:295:async (self, mock_session:AsyncMock)::Verify update_summary raises ValueError if not found.","test_get_recent_returns_summaries:305:async (self, mock_session:AsyncMock)::Verify get_recent returns recent summaries.","test_get_recent_default_limit:323:async (self, mock_session:AsyncMock)::Verify get_recent uses default limit of 7."]]}],"t/db/repositories/test_vice_repository.py":["p",{"TestVicePreferenceRepository":["23",["mock_session:27:(self)>AsyncMock::Create a mock AsyncSession.","sample_preferences:38:(self)>list[UserVicePreference]::Create sample UserVicePreference entries.","test_get_active_returns_preferences:60:async (self, mock_session:AsyncMock, sample_preferences:list[UserVicePreference])::AC-T6.1: get_active returns list of active preferences.","test_get_active_returns_empty_for_new_user:79:async (self, mock_session:AsyncMock)::AC-T6.1: get_active returns empty list for user with no preferences.","test_get_by_category_returns_preference:95:async (self, mock_session:AsyncMock, sample_preferences:list[UserVicePreference])::AC-T6.1: get_by_category returns preference for category.","test_get_by_category_returns_none_if_not_found:113:async (self, mock_session:AsyncMock)::AC-T6.1: get_by_category returns None if not found.","test_update_intensity_applies_positive_delta:130:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity applies positive delta.","__init__:197:(self)::","test_update_intensity_applies_negative_delta:152:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity applies negative delta.","test_update_intensity_clamps_to_max_5:172:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity clamps to maximum of 5.","test_update_intensity_clamps_to_min_1:192:async (self, mock_session:AsyncMock):__init__:AC-T6.2: update_intensity clamps to minimum of 1.","test_update_intensity_raises_if_not_found:212:async (self, mock_session:AsyncMock)::AC-T6.2: update_intensity raises ValueError if not found.","test_discover_creates_new_preference:227:async (self, mock_session:AsyncMock)::AC-T6.3: discover creates new preference if not exists.","test_discover_returns_existing_preference:250:async (self, mock_session:AsyncMock, sample_preferences:list[UserVicePreference])::AC-T6.3: discover returns existing preference if already exists.","test_discover_with_custom_intensity:269:async (self, mock_session:AsyncMock)::AC-T6.3: discover with custom initial_intensity."]],"TestVicePreferenceRepositoryExtras":["284",["mock_session:288:(self)>AsyncMock::Create a mock AsyncSession.","test_update_engagement_applies_delta:299:async (self, mock_session:AsyncMock):__init__:Verify update_engagement applies delta to engagement_score.","__init__:325:(self)::","test_update_engagement_clamps_to_zero:320:async (self, mock_session:AsyncMock):__init__:Verify update_engagement doesn't go below zero.","test_update_engagement_raises_if_not_found:340:async (self, mock_session:AsyncMock)::Verify update_engagement raises ValueError if not found."]]}],"t/platforms/telegram/test_auth.py":["p",{"TestTelegramAuth":["14",["mock_supabase_client:18:(self)::Mock Supabase client for testing.","mock_user_repository:25:(self)::Mock UserRepository for testing.","mock_pending_repo:31:(self)::Mock PendingRegistrationRepository for testing.","auth:37:(self, mock_supabase_client, mock_user_repository, mock_pending_repo)::Create TelegramAuth instance with mocked dependencies.","test_ac_fr004_001_valid_email_sends_magic_link:48:async (self, auth, mock_supabase_client, mock_user_repository)::","test_ac_t008_1_register_user_creates_pending_registration:83:async (self, auth, mock_supabase_client, mock_user_repository, mock_pending_repo)::","test_ac_t008_2_sends_magic_link_via_supabase:111:async (self, auth, mock_supabase_client, mock_user_repository)::","test_ac_fr004_002_valid_link_creates_account:140:async (self, auth, mock_supabase_client, mock_user_repository, mock_pending_repo)::","test_ac_t008_3_verify_magic_link_completes_registration:193:async (self, auth, mock_supabase_client, mock_user_repository, mock_pending_repo)::","test_ac_t008_4_link_telegram_updates_user_record:229:async (self, auth, mock_user_repository)::","test_register_user_already_linked:253:async (self, auth, mock_user_repository)::","test_verify_otp_invalid_token:276:async (self, auth, mock_supabase_client, mock_pending_repo)::","test_verify_without_pending_registration:301:async (self, auth, mock_pending_repo)::","test_invalid_email_format:320:async (self, auth)::","test_link_telegram_user_not_found:335:async (self, auth, mock_user_repository)::","test_ac_t046_6_persistence_across_restarts:354:async (self, mock_supabase_client, mock_user_repository, mock_pending_repo):get_email_impl,store_impl:","store_impl:368:async (tid, em)::","get_email_impl:372:async (tid)::"]]}],"t/platforms/telegram/test_bot.py":["p",{"TestTelegramBot":["12",["mock_settings:16:(self)::Mock settings for testing.","bot:23:(self, mock_settings)::Create TelegramBot instance with mocked settings.","test_ac_t004_1_send_message_with_parse_mode:29:async (self, bot)::","test_ac_t004_2_send_chat_action_typing:69:async (self, bot)::","test_ac_t004_3_set_webhook:100:async (self, bot)::","test_ac_t004_4_uses_httpx_async_client:133:async (self, bot)::","test_ac_t004_5_handles_telegram_api_errors_gracefully:146:async (self, bot)::"]]}],"t/platforms/telegram/test_commands.py":["p",{"TestCommandHandler":["15",["mock_user_repository:19:(self)::Mock UserRepository for testing.","mock_telegram_auth:25:(self)::Mock TelegramAuth for testing.","mock_bot:31:(self)::Mock TelegramBot for testing.","handler:38:(self, mock_user_repository, mock_telegram_auth, mock_bot)::Create CommandHandler instance with mocked dependencies.","test_ac_t009_1_routes_commands_by_name:47:async (self, handler)::","test_ac_fr003_001_start_command_new_user:85:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t009_2_handle_start_existing_user:120:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t009_3_handle_help_returns_commands:155:async (self, handler, mock_bot)::","test_ac_t009_4_handle_status_returns_chapter_score:185:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t009_5_unknown_commands_handled_gracefully:228:async (self, handler, mock_bot)::","test_command_with_bot_username:256:async (self, handler)::","test_status_command_unregistered_user:280:async (self, handler, mock_user_repository, mock_bot)::"]]}],"t/platforms/telegram/test_delivery.py":["p",{"TestResponseDelivery":["14",["mock_bot:18:(self)::Mock TelegramBot for testing.","delivery:24:(self, mock_bot)::Create ResponseDelivery instance with mocked bot.","test_ac_fr002_002_response_delivered_via_telegram:31:async (self, delivery, mock_bot)::","test_ac_fr007_001_long_response_split_intelligently:61:async (self, delivery, mock_bot)::","test_ac_t016_1_queue_stores_for_delivery:99:async (self, delivery, mock_bot)::","test_ac_t016_3_send_now_sends_with_typing_indicator:125:async (self, delivery, mock_bot)::","test_ac_t016_4_splits_messages_intelligently_not_mid_word:154:async (self, delivery, mock_bot)::","test_short_message_not_split:191:async (self, delivery, mock_bot)::","test_exactly_4096_chars_not_split:213:async (self, delivery, mock_bot)::","test_one_char_over_limit_triggers_split:234:async (self, delivery, mock_bot)::","test_multiple_chunks_all_under_limit:255:async (self, delivery, mock_bot)::","test_empty_response_handled_gracefully:279:async (self, delivery, mock_bot)::"]],"TestTypingIndicators":["300",["mock_bot:309:(self)::Mock TelegramBot for testing.","delivery:315:(self, mock_bot)::Create ResponseDelivery instance with mocked bot.","test_ac_fr009_001_typing_indicator_appears_before_response:322:async (self, delivery, mock_bot)::","test_ac_fr009_002_periodic_typing_during_delay:365:async (self, delivery, mock_bot, monkeypatch):mock_sleep:","mock_sleep:440:async (seconds)::","test_ac_fr009_003_typing_stops_when_message_sent:403:async (self, delivery, mock_bot)::","test_no_periodic_typing_for_short_delays:429:async (self, delivery, mock_bot, monkeypatch):mock_sleep:","test_typing_indicator_sent_for_each_chunk:463:async (self, delivery, mock_bot)::"]]}],"t/platforms/telegram/test_errors.py":["p",{"TestErrorRecovery":["19",["mock_user_repository:28:(self)::Mock UserRepository.","mock_text_agent_handler:39:(self)::Mock TextAgentMessageHandler.","mock_response_delivery:50:(self)::Mock ResponseDelivery.","mock_bot:55:(self)::Mock TelegramBot.","sample_message:60:(self)::Create a sample TelegramMessage.","handler:77:(self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot,)::Create MessageHandler with mocked dependencies.","test_ac_fr008_001_agent_unavailable_user_notified:93:async (self, handler, mock_text_agent_handler, mock_bot, sample_message,)::","test_ac_fr008_001_agent_unavailable_no_crash:124:async (self, handler, mock_text_agent_handler, sample_message,)::","test_ac_fr008_002_delivery_failure_handled_gracefully:146:async (self, handler, mock_response_delivery, mock_bot, sample_message,)::","test_ac_fr008_003_auth_failure_prompts_reauth:170:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message,)::","test_ac_t035_1_try_catch_around_agent_invocation:202:async (self, handler, mock_text_agent_handler, mock_bot, sample_message,)::","test_ac_t035_3_notify_user_in_character:236:async (self, handler, mock_text_agent_handler, mock_bot, sample_message,)::","test_normal_flow_still_works:267:async (self, handler, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message,)::"]]}],"t/platforms/telegram/test_message_handler.py":["p",{"TestMessageHandler":["21",["mock_user_repository:25:(self)::Mock UserRepository for testing.","mock_text_agent_handler:31:(self)::Mock text agent MessageHandler.","mock_response_delivery:37:(self)::Mock ResponseDelivery for testing.","mock_bot:43:(self)::Mock TelegramBot for testing.","handler:55:(self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot,)::Create MessageHandler instance with mocked dependencies.","sample_message:65:(self)::Create sample Telegram message for testing.","test_ac_fr002_001_authenticated_user_message_routed_to_text_agent:77:async (self, handler, mock_user_repository, mock_text_agent_handler, sample_message)::","test_ac_t015_1_handle_processes_text_messages:109:async (self, handler, mock_user_repository, mock_text_agent_handler, sample_message)::","test_ac_t015_2_checks_authentication_prompts_registration:137:async (self, handler, mock_user_repository, mock_bot, sample_message)::","test_ac_t015_4_routes_to_text_agent_with_user_context:160:async (self, handler, mock_user_repository, mock_text_agent_handler, sample_message)::","test_ac_t015_5_queues_response_for_delivery:190:async (self, handler, mock_user_repository, mock_text_agent_handler, mock_response_delivery, sample_message)::","test_skip_response_not_queued:225:async (self, handler, mock_user_repository, mock_text_agent_handler, mock_response_delivery, sample_message)::","test_typing_indicator_sent_before_processing:255:async (self, handler, mock_user_repository, mock_text_agent_handler, mock_bot, sample_message)::","test_empty_message_handled_gracefully:281:async (self, handler, mock_user_repository, mock_bot)::","test_ac_t025_1_minute_limit_sends_in_character_response:311:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_ac_t025_1_daily_limit_sends_in_character_response:354:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_ac_t025_2_warning_when_approaching_daily_limit:397:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_ac_t025_3_no_harsh_technical_error_messages:446:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::","test_rate_limiting_disabled_when_no_limiter_configured:484:async (self, mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot, sample_message)::"]]}],"t/platforms/telegram/test_rate_limiter.py":["p",["mock_cache:21:()::Mock cache client for rate limit tracking.","rate_limiter:31:(mock_cache)::Create RateLimiter with mocked cache."],{"TestRateLimiter":["36",["test_ac_fr006_001_rate_limit_hit_after_20_messages_per_minute:44:async (self, rate_limiter, mock_cache,)::","test_ac_t024_1_check_returns_rate_limit_status:72:async (self, rate_limiter, mock_cache,)::","test_ac_t024_2_tracks_per_minute_and_per_day_limits:93:async (self, rate_limiter, mock_cache,):mock_incr:","mock_incr:272:async (key)::","test_ac_fr006_002_warning_when_approaching_daily_limit:127:async (self, rate_limiter, mock_cache,):mock_incr:","test_daily_limit_exceeded_blocks_message:156:async (self, rate_limiter, mock_cache,):mock_incr:","test_ac_t024_4_keys_expire_appropriately:183:async (self, rate_limiter, mock_cache,)::","test_ac_fr006_003_rate_limit_resets_after_cooldown:208:async (self, rate_limiter, mock_cache,)::","test_ac_t024_3_get_remaining_returns_quota_info:234:async (self, rate_limiter, mock_cache,):mock_get:","mock_get:241:async (key)::","test_multiple_users_isolated:262:async (self, rate_limiter, mock_cache,):mock_incr:","test_edge_case_exactly_20_messages_allowed:299:async (self, rate_limiter, mock_cache,)::"]]}],"t/platforms/telegram/test_session_integration.py":["p",["mock_user_repository:24:()::Mock UserRepository for authentication checks.","mock_text_agent_handler:32:()::Mock text agent handler that simulates context awareness.","mock_response_delivery:40:()::Mock ResponseDelivery for message sending.","mock_bot:48:()::Mock TelegramBot for typing indicators.","message_handler:62:(mock_user_repository, mock_text_agent_handler, mock_response_delivery, mock_bot,)::Create MessageHandler with mocked dependencies."],{"TestSessionPersistence":["72",["test_ac_fr005_001_context_maintained_across_multiple_messages:86:async (self, message_handler, mock_user_repository, mock_text_agent_handler,)::","test_ac_fr005_002_context_restored_after_time_gap:173:async (self, message_handler, mock_user_repository, mock_text_agent_handler,)::","test_ac_fr005_003_no_cross_user_contamination:223:async (self, message_handler, mock_user_repository, mock_text_agent_handler,):get_user_by_telegram_id,handle_message:","get_user_by_telegram_id:239:async (telegram_id:int)::","handle_message:251:async (user_id, text)::","test_session_isolation_via_user_id_scoping:314:async (self, message_handler, mock_user_repository, mock_text_agent_handler,)::"]]}],"nikita/agents/text/__init__.py":["p",["get_memory_client:18:async (user_id:str)>\"NikitaMemory\"::Lazy wrapper for get_memory_client to avoid import-time errors.","get_user_by_id:32:async (user_id:UUID)>\"User | None\"::","get_nikita_agent_for_user:53:async (user_id:UUID)>tuple[Agent[NikitaDeps, str], NikitaDeps]:get_memory_client,get_user_by_id:"],{"UserNotFoundError":["24",["__init__:27:(self, user_id:UUID):__init__:"]]}],"nikita/agents/text/agent.py":["p",["_create_nikita_agent:29:()>Agent[NikitaDeps, str]:note_user_fact,recall_memory:","get_nikita_agent:94:()>Agent[NikitaDeps, str]:_create_nikita_agent:","build_system_prompt:130:async (memory:\"NikitaMemory\", user:\"User\", user_message:str,)>str::","generate_response:168:async (deps:NikitaDeps, user_message:str,)>str:build_system_prompt:"],{"_AgentProxy":["107",["_real_agent:113:(self)>Agent[NikitaDeps, str]:get_nikita_agent:","__getattr__:118:(self, name:str)::"]]}],"nikita/agents/text/deps.py":["p",{"NikitaDeps":["17",["chapter:37:(self)>int::"]]}],"nikita/agents/text/facts.py":["p",{"ExtractedFact":["15",[]],"FactExtractor":["67",["__init__:85:(self, min_confidence:float = 0.5)::","extract_facts:99:async (self, user_message:str, nikita_response:str, existing_facts:list[str],)>list[ExtractedFact]:_call_llm_for_extraction,_deduplicate_facts:","_call_llm_for_extraction:132:async (self, user_message:str, nikita_response:str, existing_facts:list[str],)>list[ExtractedFact]::","_deduplicate_facts:156:(self, new_facts:list[ExtractedFact], existing_facts:list[str],)>list[ExtractedFact]::"]]}],"nikita/agents/text/handler.py":["p",["_get_nikita_agent_for_user:26:()::Lazy import to avoid triggering pydantic_ai import at module load.","_generate_response:32:()::Lazy import to avoid triggering pydantic_ai import at module load.","get_nikita_agent_for_user:39:async (user_id:UUID):_get_nikita_agent_for_user:Wrapper for lazy import.","generate_response:45:async (deps, message:str):_generate_response:Wrapper for lazy import.","store_pending_response:85:async (user_id:UUID, response:str, scheduled_at:datetime, response_id:UUID,)>None::"],{"ResponseDecision":["54",[]],"MessageHandler":["106",["__init__:135:(self, timer:Optional[ResponseTimer] = None, skip_decision:Optional[SkipDecision] = None, fact_extractor:Optional[FactExtractor] = None,)::","handle:148:async (self, user_id:UUID, message:str)>ResponseDecision:generate_response,get_nikita_agent_for_user,store_pending_response:"]]}],"nikita/agents/text/skip.py":["p",{"SkipDecision":["32",["__init__:53:(self)::Initialize the SkipDecision tracker.","should_skip:57:(self, chapter:int)>bool::","reset:89:(self)>None::Reset the skip tracker state."]]}],"nikita/agents/text/timing.py":["p",{"ResponseTimer":["33",["__init__:49:(self, jitter_factor:float = 0.1)::","calculate_delay:58:(self, chapter:int)>int::","calculate_delay_human_readable:95:(self, chapter:int)>str:calculate_delay:"]]}],"nikita/agents/text/tools.py":["p",["format_memory_results:17:(results:list[dict[str, Any]])>str::","recall_memory:57:async (ctx:RunContext[NikitaDeps], query:str)>str:format_memory_results:","note_user_fact:79:async (ctx:RunContext[NikitaDeps], fact:str, confidence:float)>str::"]],"nikita/api/main.py":["p",["lifespan:19:async (app:FastAPI)>AsyncGenerator[None, None]::Application lifespan handler with proper DB initialization.","create_app:65:()>FastAPI:health,root:Create and configure the FastAPI application."]],"nikita/api/schemas/conversation.py":["p",{"MessageRequest":["11",[]],"MessageResponse":["18",[]],"ConversationMessage":["27",[]],"ConversationResponse":["36",[]],"ConversationSummary":["52",[]]}],"nikita/api/schemas/game.py":["p",{"ScoreHistoryResponse":["11",[]],"DailySummaryResponse":["24",[]],"GameStateResponse":["40",[]],"BossEncounterResponse":["62",[]],"VicePreferenceResponse":["73",[]]}],"nikita/api/schemas/user.py":["p",{"UserCreate":["10",[]],"UserResponse":["18",[]],"UserStatsResponse":["32",[]],"ScorePointResponse":["44",[]],"UserMetricsResponse":["51",[]]}],"nikita/config/elevenlabs.py":["p",["get_elevenlabs_config:55:()>ElevenLabsConfig::Get cached ElevenLabs config instance.","get_agent_id:74:(chapter:int = 1, mood:str | None = None, is_boss:bool = False,)>str:get_agents_dict,get_elevenlabs_config:"],{"ElevenLabsConfig":["9",["get_agents_dict:38:(self)>dict[str, str]::Get all agent IDs as a dictionary."]]}],"nikita/config/settings.py":["p",["get_settings:81:()>Settings::Get cached settings instance."],{"Settings":["10",[]]}],"nikita/db/database.py":["p",["get_async_engine:21:()::","get_session_maker:53:()>async_sessionmaker[AsyncSession]:get_async_engine:","get_async_session:67:async ()>AsyncGenerator[AsyncSession, None]:get_session_maker:","_get_supabase_sync_client:84:()::Get cached Supabase sync client (for module-level use).","get_supabase_client:90:async ()>AsyncClient:_get_supabase_sync_client:Get Supabase async client.","get_pool_status:96:()>dict:get_async_engine:"]],"nikita/db/dependencies.py":["p",["get_user_repo:32:async (session:AsyncSessionDep,)>AsyncGenerator[UserRepository, None]::","get_metrics_repo:46:async (session:AsyncSessionDep,)>AsyncGenerator[UserMetricsRepository, None]::","get_conversation_repo:60:async (session:AsyncSessionDep,)>AsyncGenerator[ConversationRepository, None]::","get_score_history_repo:74:async (session:AsyncSessionDep,)>AsyncGenerator[ScoreHistoryRepository, None]::","get_vice_repo:88:async (session:AsyncSessionDep,)>AsyncGenerator[VicePreferenceRepository, None]::","get_summary_repo:102:async (session:AsyncSessionDep,)>AsyncGenerator[DailySummaryRepository, None]::","get_pending_registration_repo:116:async (session:AsyncSessionDep,)>AsyncGenerator[PendingRegistrationRepository, None]::"]],"nikita/db/migrations/env.py":["p",["get_url:36:()>str::Get database URL from settings.","run_migrations_offline:42:()>None:get_url:","do_run_migrations:65:(connection:Connection)>None::Run migrations with given connection.","run_async_migrations:73:async ()>None:get_url:","run_migrations_online:98:()>None:run_async_migrations:Run migrations in 'online' mode."]],"nikita/db/migrations/versions/20251128_0001_initial_schema.py":["p",["upgrade:28:()>None::Create initial schema.","downgrade:300:()>None::Drop all tables in reverse order (AC-T9.7: Reversible)."]],"nikita/db/migrations/versions/20251128_0002_rls_policies.py":["p",["upgrade:25:()>None::Enable RLS and create policies.","downgrade:125:()>None::Drop RLS policies and disable RLS."]],"nikita/db/models/base.py":["p",["utc_now:45:()>datetime::Get current UTC datetime."],{"Base":["11",[]],"TimestampMixin":["19",[]],"UUIDMixin":["35",[]]}],"nikita/db/models/conversation.py":["p",{"Conversation":["28",["add_message:92:(self, role:str, content:str, analysis:dict[str, Any] | None = None,)>None::Add a message to the conversation.","message_count:104:(self)>int::Get total number of messages."]],"MessageEmbedding":["109",[]]}],"nikita/db/models/game.py":["p",{"ScoreHistory":["19",[]],"DailySummary":["69",["score_change:111:(self)>Decimal | None::Calculate net score change for the day."]]}],"nikita/db/models/user.py":["p",{"User":["28",[]],"UserMetrics":["121",["calculate_composite_score:164:(self)>Decimal::"]],"UserVicePreference":["178",[]]}],"nikita/db/repositories/base.py":["p",{"BaseRepository":["18",["__init__:37:(self, session:AsyncSession, model_class:type[ModelT])>None::","get_by_telegram_id:32:async (self, telegram_id:int)>User | None::","session:48:(self)>AsyncSession:session:","get:58:async (self, id:UUID)>ModelT | None:get:","create:69:async (self, entity:ModelT)>ModelT::","update:83:async (self, entity:ModelT)>ModelT:create,get,session:","delete:99:async (self, entity:ModelT)>None:delete:","delete_by_id:108:async (self, id:UUID)>bool:delete,get:"]]}],"nikita/db/repositories/conversation_repository.py":["p",{"ConversationRepository":["18",["__init__:25:(self, session:AsyncSession)>None:__init__:Initialize ConversationRepository.","create_conversation:36:async (self, user_id:UUID, platform:str, started_at:datetime | None = None, is_boss_fight:bool = False, chapter_at_time:int | None = None,)>Conversation::","append_message:65:async (self, conversation_id:UUID, role:str, content:str, analysis:dict[str, Any] | None = None,)>Conversation::","get_recent:95:async (self, user_id:UUID, limit:int = 10,)>list[Conversation]::","search:118:async (self, user_id:UUID, query:str,)>list[Conversation]:search:","close_conversation:150:async (self, conversation_id:UUID, score_delta:Decimal | None = None,)>Conversation::"]]}],"nikita/db/repositories/metrics_repository.py":["p",{"UserMetricsRepository":["16",["__init__:22:(self, session:AsyncSession)>None:__init__:Initialize UserMetricsRepository.","get_by_user_id:26:async (self, user_id:UUID)>UserMetrics | None::","update_metrics:46:async (self, user_id:UUID, intimacy_delta:Decimal = Decimal(\"0\"), passion_delta:Decimal = Decimal(\"0\"), trust_delta:Decimal = Decimal(\"0\"), secureness_delta:Decimal = Decimal(\"0\"),)>UserMetrics:_clamp,get_by_user_id:","calculate_composite:77:async (self, user_id:UUID)>Decimal:get_by_user_id:","_clamp:96:(value:Decimal)>Decimal::Clamp value between 0 and 100."]]}],"nikita/db/repositories/score_history_repository.py":["p",{"ScoreHistoryRepository":["18",["__init__:24:(self, session:AsyncSession)>None:__init__:Initialize ScoreHistoryRepository.","log_event:35:async (self, user_id:UUID, score:Decimal, chapter:int, event_type:str | None = None, event_details:dict[str, Any] | None = None,)>ScoreHistory::","get_history:63:async (self, user_id:UUID, limit:int = 50,)>list[ScoreHistory]::","get_daily_stats:86:async (self, user_id:UUID, target_date:date,)>dict[str, Any]::","get_events_by_type:140:async (self, user_id:UUID, event_type:str, limit:int = 50,)>list[ScoreHistory]::"]]}],"nikita/db/repositories/summary_repository.py":["p",{"DailySummaryRepository":["18",["__init__:24:(self, session:AsyncSession)>None:__init__:Initialize DailySummaryRepository.","create_summary:38:async (self, user_id:UUID, summary_date:date, score_start:Decimal | None = None, score_end:Decimal | None = None, decay_applied:Decimal | None = None, conversations_count:int = 0, nikita_summary_text:str | None = None, key_events:list[dict[str, Any]] | None = None,)>DailySummary::","get_by_date:72:async (self, user_id:UUID, summary_date:date,)>DailySummary | None::","get_range:95:async (self, user_id:UUID, start_date:date, end_date:date,)>list[DailySummary]::","update_summary:122:async (self, summary_id:UUID, score_end:Decimal | None = None, nikita_summary_text:str | None = None, key_events:list[dict[str, Any]] | None = None,)>DailySummary::","get_recent:157:async (self, user_id:UUID, limit:int = 7,)>list[DailySummary]::"]]}],"nikita/db/repositories/user_repository.py":["p",{"UserRepository":["21",["__init__:30:(self, session:AsyncSession)>None:__init__:","get:38:async (self, user_id:UUID)>User | None::","get_by_telegram_id:55:async (self, telegram_id:int)>User | None::","create_with_metrics:77:async (self, user_id:UUID, telegram_id:int | None = None, phone:str | None = None,)>User::","update_score:126:async (self, user_id:UUID, delta:Decimal, event_type:str | None = None, event_details:dict[str, Any] | None = None,)>User:get:","apply_decay:171:async (self, user_id:UUID, decay_amount:Decimal,)>User:update_score:","advance_chapter:188:async (self, user_id:UUID)>User:get:"]]}],"nikita/db/repositories/vice_repository.py":["p",{"VicePreferenceRepository":["17",["__init__:23:(self, session:AsyncSession)>None:__init__:Initialize VicePreferenceRepository.","get_active:27:async (self, user_id:UUID)>list[UserVicePreference]::","get_by_category:48:async (self, user_id:UUID, category:str,)>UserVicePreference | None::","update_intensity:70:async (self, preference_id:UUID, delta:int,)>UserVicePreference::","discover:101:async (self, user_id:UUID, category:str, initial_intensity:int = 1,)>UserVicePreference:get_by_category:","update_engagement:131:async (self, preference_id:UUID, delta:Decimal,)>UserVicePreference::"]]}],"nikita/db/transactions.py":["p",["is_deadlock_error:40:(error:Exception)>bool::","atomic:67:(isolation_level:IsolationLevel = DEFAULT_ISOLATION_LEVEL, max_retries:int = DEFAULT_MAX_RETRIES, base_delay:float = DEFAULT_BASE_DELAY,)>Callable[[Callable[P, T]], Callable[P, T]]:atomic,decorator,is_deadlock_error,transfer_funds,wrapper:","run_in_transaction:162:async (session:AsyncSession, func:Callable[..., Any], *args:Any, isolation_level:IsolationLevel = DEFAULT_ISOLATION_LEVEL, **kwargs:Any,)>Any:_wrapped,atomic:"]],"nikita/memory/graphiti_client.py":["p",["get_memory_client:289:async (user_id:str)>NikitaMemory:initialize:"],{"NikitaMemory":["25",["__init__:35:(self, user_id:str)::","initialize:62:async (self)>None::","_get_group_id:79:(self, graph_type:str)>str::Get the group ID for a specific graph type.","add_episode:89:async (self, content:str, source:str, graph_type:str = \"relationship\", metadata:dict[str, Any] | None = None,)>None:_get_group_id,add_episode:","search_memory:117:async (self, query:str, graph_types:list[str] | None = None, limit:int = 10,)>list[dict[str, Any]]:_get_group_id:","get_context_for_prompt:155:async (self, user_message:str, max_memories:int = 5,)>str:search_memory:","add_user_fact:202:async (self, fact:str, confidence:float = 0.8, source_message:str | None = None,)>None:add_episode:","get_user_facts:222:async (self, limit:int = 50)>list[str]:_get_group_id:","add_relationship_episode:254:async (self, description:str, episode_type:str = \"general\",)>None:add_episode:","add_nikita_event:273:async (self, description:str, event_type:str = \"life_event\",)>None:add_episode:"]]}],"nikita/prompts/nikita_persona.py":["p",["get_nikita_persona:144:()>str::"]],"t/agents/text/test_agent.py":["p",{"TestNikitaAgentConfiguration":["16",["test_agent_module_importable:19:(self)::Agent module should be importable without API key.","test_ac_1_3_1_model_name_constant:27:(self)::AC-1.3.1: MODEL_NAME is anthropic:claude-sonnet-4-20250514.","test_ac_1_3_2_uses_nikita_deps:38:(self)::AC-1.3.2: Agent has deps_type=NikitaDeps."]],"TestNikitaAgentSystemPrompt":["47",["test_ac_1_3_3_system_prompt_includes_persona:51:async (self)::AC-1.3.3: System prompt includes NIKITA_PERSONA.","test_ac_1_3_3_system_prompt_includes_chapter_behavior:69:async (self)::AC-1.3.3: System prompt includes CHAPTER_BEHAVIORS.","test_ac_1_3_3_system_prompt_includes_memory_context:86:async (self)::AC-1.3.3: System prompt includes memory context.","test_system_prompt_varies_by_chapter:102:async (self)::System prompt should change based on chapter."]],"TestNikitaAgentInvocation":["122",["test_ac_1_3_4_agent_has_run_method:129:(self)::AC-1.3.4: Agent should have a run method.","test_agent_run_is_async:141:(self)::Agent.run should be an async method."]],"TestGenerateResponse":["151",["test_generate_response_exists:154:(self)::generate_response function should exist.","test_generate_response_is_async:161:async (self)::generate_response should be async."]]}],"t/agents/text/test_chapter_behavior.py":["p",{"TestChapterBehaviorInjection":["14",["test_ac_3_2_1_ch1_prompt_contains_skeptical_behavior:18:async (self)::AC-3.2.1: Ch1 prompts should contain skeptical/evaluating behaviors.","test_ac_3_2_1_ch1_response_rate_in_prompt:37:async (self)::AC-3.2.1: Ch1 prompt should mention 60-75% response rate.","test_ac_3_2_2_ch3_prompt_contains_vulnerable_behavior:52:async (self)::AC-3.2.2: Ch3 prompts should contain emotionally vulnerable behaviors.","test_ac_3_2_2_ch3_response_rate_in_prompt:71:async (self)::AC-3.2.2: Ch3 prompt should mention 85-95% response rate.","test_ac_3_2_3_ch5_prompt_contains_authentic_behavior:86:async (self)::AC-3.2.3: Ch5 prompts should contain consistent/authentic behaviors.","test_ac_3_2_3_ch5_response_rate_in_prompt:105:async (self)::AC-3.2.3: Ch5 prompt should mention 95-100% response rate.","test_ac_3_2_4_prompts_differ_by_chapter:120:async (self)::AC-3.2.4: Different chapters should produce different prompts.","test_ac_3_2_4_prompt_has_current_chapter_behavior_label:138:async (self)::AC-3.2.4: Prompt should have labeled CURRENT CHAPTER BEHAVIOR section.","test_chapter_names_match_constants:153:async (self)::Chapter names in behavior should match CHAPTER_NAMES constant."]],"TestChapterBehaviorProgression":["171",["test_response_rate_increases_through_chapters:175:async (self)::Response rate should generally increase through chapters.","test_emotional_openness_increases_through_chapters:199:async (self)::Emotional openness indicators should increase through chapters.","test_ch1_has_testing_evaluation_keywords:224:async (self)::Chapter 1 should focus on testing/evaluation.","test_ch5_has_stability_keywords:243:async (self)::Chapter 5 should focus on stability/consistency."]],"TestDefaultChapterBehavior":["262",["test_invalid_chapter_falls_back_to_ch1:266:async (self)::Invalid chapter numbers should fall back to Chapter 1 behavior.","test_chapter_6_falls_back_to_ch1:283:async (self)::Chapter 6 (non-existent) should fall back to default behavior."]]}],"t/agents/text/test_deps.py":["p",{"TestNikitaDepsStructure":["16",["test_is_dataclass:19:(self)::NikitaDeps should be a dataclass.","test_ac_1_2_1_has_memory_field:25:(self)::AC-1.2.1: NikitaDeps contains memory: NikitaMemory.","test_ac_1_2_2_has_user_field:32:(self)::AC-1.2.2: NikitaDeps contains user: User.","test_ac_1_2_3_has_settings_field:39:(self)::AC-1.2.3: NikitaDeps contains settings: Settings.","test_ac_1_2_5_type_hints_complete:46:(self)::AC-1.2.5: Type hints complete for Pydantic AI compatibility."]],"TestNikitaDepsProperties":["54",["test_ac_1_2_4_chapter_property:57:(self)::AC-1.2.4: chapter property returns user.chapter.","test_chapter_property_follows_user_changes:75:(self)::Chapter property should reflect user.chapter changes."]],"TestNikitaDepsInstantiation":["96",["test_can_instantiate_with_mocks:99:(self)::Should be able to create NikitaDeps with mock objects.","test_requires_all_fields:117:(self)::Should require all fields to instantiate."]]}],"t/agents/text/test_factory.py":["p",{"TestGetNikitaAgentForUser":["16",["test_function_exists:19:(self)::Factory function should exist and be importable.","test_ac_1_4_1_accepts_user_id:26:async (self)::AC-1.4.1: Function accepts user_id: UUID parameter.","test_function_is_async:35:async (self)::Factory function should be async.","test_ac_1_4_4_returns_tuple_with_deps:43:async (self)::AC-1.4.4: Function returns tuple (Agent, NikitaDeps).","test_ac_1_4_2_loads_user:77:async (self)::AC-1.4.2: Function loads user from database.","test_ac_1_4_3_initializes_memory:98:async (self)::AC-1.4.3: Function initializes NikitaMemory for user.","test_ac_1_4_5_handles_user_not_found:119:async (self)::AC-1.4.5: Function handles user not found with appropriate error."]]}],"t/agents/text/test_facts.py":["p",{"TestFactsModule":["17",["test_facts_module_importable:20:(self)::Facts module should be importable.","test_extracted_fact_dataclass:27:(self)::ExtractedFact should be a dataclass with required fields.","test_extracted_fact_has_fact_type:41:(self)::ExtractedFact should have fact_type field (explicit/implicit)."]],"TestFactExtractor":["63",["test_fact_extractor_class_exists:66:(self)::FactExtractor class should exist.","test_ac_6_1_1_extract_facts_method_exists:72:(self)::AC-6.1.1: extract_facts async method should exist.","test_extract_facts_signature:83:(self)::extract_facts should accept user_message, nikita_response, existing_facts.","test_ac_6_1_4_returns_list_of_extracted_facts:97:async (self)::AC-6.1.4: Should return list[ExtractedFact].","test_extracted_fact_has_required_fields:125:async (self)::Each ExtractedFact should have fact, confidence, source."]],"TestExplicitFacts":["153",["test_ac_6_1_2_extracts_explicit_facts:157:async (self)::AC-6.1.2: Should identify explicit facts user states directly.","test_explicit_facts_have_high_confidence:189:async (self)::Explicit facts should have high confidence (>0.8)."]],"TestImplicitFacts":["216",["test_ac_6_1_3_extracts_implicit_facts:220:async (self)::AC-6.1.3: Should identify implicit facts inferred from context.","test_implicit_facts_have_lower_confidence:246:async (self)::Implicit facts should have lower confidence (<0.9)."]],"TestFactDeduplication":["273",["test_ac_6_1_5_avoids_extracting_known_facts:277:async (self)::AC-6.1.5: Should not extract facts that already exist.","test_deduplication_is_case_insensitive:315:async (self)::Deduplication should work regardless of case."]],"TestEmptyResults":["343",["test_returns_empty_list_when_no_facts:347:async (self)::Should return empty list when no facts found.","test_handles_small_talk_gracefully:363:async (self)::Small talk should not generate facts."]]}],"t/agents/text/test_handler.py":["p",{"TestMessageHandlerStructure":["18",["test_handler_module_importable:21:(self)::Handler module should be importable.","test_ac_4_2_5_response_decision_exists:28:(self)::AC-4.2.5: ResponseDecision dataclass should exist.","test_response_decision_has_delay_seconds:34:(self)::ResponseDecision should have delay_seconds field.","test_response_decision_has_scheduled_at:48:(self)::ResponseDecision should have scheduled_at field."]],"TestMessageHandler":["63",["test_message_handler_class_exists:66:(self)::MessageHandler class should exist.","test_ac_4_2_1_handle_method_exists:72:(self)::AC-4.2.1: MessageHandler.handle(user_id, message) should exist.","test_handle_method_signature:83:(self)::Handle method should accept user_id and message parameters.","test_ac_4_2_2_handler_generates_response:96:async (self)::AC-4.2.2: Handler should generate response via agent.","test_ac_4_2_3_handler_calculates_delay:133:async (self)::AC-4.2.3: Handler should calculate delay via ResponseTimer.","test_ac_4_2_5_handler_returns_response_decision:171:async (self)::AC-4.2.5: Handler should return ResponseDecision with delay_seconds."]],"TestResponseDecisionScheduling":["215",["test_scheduled_at_is_future:218:(self)::scheduled_at should be in the future based on delay.","test_handler_calculates_correct_scheduled_time:235:async (self)::Handler should calculate scheduled_at based on now + delay."]],"TestPendingResponseStorage":["281",["test_ac_4_2_4_handler_stores_pending_response:285:async (self)::AC-4.2.4: Handler should store pending response with scheduled delivery time.","test_response_decision_has_response_id:329:(self)::ResponseDecision should have response_id for tracking."]]}],"t/agents/text/test_handler_facts.py":["p",{"TestResponseDecisionFacts":["16",["test_ac_6_3_4_response_decision_has_facts_extracted:19:(self)::AC-6.3.4: ResponseDecision should have facts_extracted list.","test_facts_extracted_default_empty_list:31:(self)::facts_extracted should default to empty list.","test_facts_extracted_can_contain_facts:43:(self)::facts_extracted should be able to contain ExtractedFact objects."]],"TestHandlerFactExtraction":["68",["test_ac_6_3_1_handler_calls_fact_extractor:72:async (self)::AC-6.3.1: Handler calls FactExtractor after agent generates response.","test_fact_extractor_receives_correct_arguments:118:async (self)::FactExtractor should receive user_message, nikita_response, and existing_facts.","test_ac_6_3_2_extracted_facts_stored_via_memory:169:async (self)::AC-6.3.2: Extracted facts stored via memory.add_user_fact().","test_ac_6_3_4_response_includes_extracted_facts:234:async (self)::AC-6.3.4: ResponseDecision includes facts_extracted list.","test_no_fact_extraction_when_skipped:290:async (self)::Should not extract facts when message is skipped."]],"TestHandlerWithDefaultFactExtractor":["327",["test_handler_creates_fact_extractor_if_none:330:(self)::Handler should create FactExtractor if none provided.","test_handler_uses_provided_fact_extractor:340:(self)::Handler should use provided FactExtractor."]],"TestFactExtractionWithEmptyResults":["351",["test_empty_facts_handled_gracefully:355:async (self)::Handler should handle empty fact extraction results gracefully."]]}],"t/agents/text/test_handler_skip.py":["p",{"TestSkipDecisionIntegration":["20",["test_response_decision_has_should_respond:23:(self)::ResponseDecision should have should_respond field.","test_response_decision_should_respond_default_true:38:(self)::ResponseDecision.should_respond should default to True.","test_ac_5_2_5_response_decision_false_when_skipped:51:(self)::AC-5.2.5: ResponseDecision.should_respond = False when skipped.","test_response_decision_has_skip_reason:66:(self)::ResponseDecision should have skip_reason field."]],"TestHandlerSkipDecision":["82",["test_ac_5_2_1_handler_checks_skip_before_agent:86:async (self)::AC-5.2.1: Handler checks SkipDecision.should_skip() before agent.run().","test_handler_skips_agent_when_should_skip_true:128:async (self)::When should_skip returns True, handler should not call agent.","test_ac_5_2_5_skipped_response_decision:165:async (self)::AC-5.2.5: When skipped, ResponseDecision.should_respond = False."]],"TestSkipLogging":["196",["test_ac_5_2_2_skipped_messages_logged:200:async (self, caplog)::AC-5.2.2: Skipped messages should be logged with reason.","test_skip_reason_in_response_decision:231:async (self)::Skip reason should be included in ResponseDecision."]],"TestConsecutiveSkipState":["261",["test_ac_5_2_3_skip_state_stored:265:async (self)::AC-5.2.3: Skip state stored so consecutive messages don't all skip.","test_ac_5_2_4_next_message_after_skip_processes:292:async (self)::AC-5.2.4: Next message after skip processes normally."]],"TestSkipDoesNotStore":["345",["test_skipped_message_not_stored:349:async (self)::Skipped messages should not call store_pending_response."]],"TestHandlerWithDefaultSkip":["380",["test_handler_creates_skip_decision_if_none:383:(self)::Handler should create SkipDecision if none provided.","test_handler_uses_provided_skip_decision:393:(self)::Handler should use provided SkipDecision."]]}],"t/agents/text/test_nikita_persona.py":["p",{"TestNikitaPersona":["15",["test_ac_1_1_1_backstory_elements:18:(self)::AC-1.1.1: Persona includes complete backstory.","test_ac_1_1_2_communication_style_rules:32:(self)::AC-1.1.2: Communication style rules defined.","test_ac_1_1_3_interests_listed:43:(self)::AC-1.1.3: Interests listed.","test_ac_1_1_4_values_defined:53:(self)::AC-1.1.4: Values defined.","test_ac_1_1_5_negative_examples_section:63:(self)::AC-1.1.5: Negative examples section exists.","test_ac_1_1_6_at_least_10_example_responses:72:(self)::AC-1.1.6: At least 10 example responses.","test_persona_is_string:84:(self)::Persona should be a string for prompt injection.","test_persona_has_prompt_format_markers:91:(self)::Persona should be structured for LLM consumption."]],"TestGetPersonaPrompt":["101",["test_get_persona_returns_string:104:(self)::Function should return the persona string.","test_get_persona_matches_constant:112:(self)::Function should return the NIKITA_PERSONA constant."]]}],"t/agents/text/test_skip.py":["p",{"TestSkipRates":["15",["test_skip_module_importable:18:(self)::Skip module should be importable.","test_ac_5_1_1_skip_rates_is_dict:25:(self)::AC-5.1.1: SKIP_RATES should be a dict mapping chapter to (min, max).","test_ac_5_1_2_ch1_skip_rate:44:(self)::AC-5.1.2: Ch1 rate should be 25-40% skip.","test_ac_5_1_3_ch5_skip_rate:54:(self)::AC-5.1.3: Ch5 rate should be 0-5% skip.","test_skip_rates_decrease_through_chapters:64:(self)::Skip rates should generally decrease as chapters progress."]],"TestSkipDecision":["76",["test_skip_decision_class_exists:79:(self)::SkipDecision class should exist.","test_ac_5_1_4_should_skip_returns_bool:85:(self)::AC-5.1.4: should_skip(chapter) should return bool.","test_should_skip_accepts_chapter_parameter:94:(self)::should_skip should accept chapter parameter.","test_ac_5_1_5_skip_is_randomized:104:(self)::AC-5.1.5: Skip probability should be randomized within range.","test_ch1_skip_rate_within_expected_range:117:(self)::Ch1 should skip 25-40% of messages.","test_ch5_skip_rate_within_expected_range:130:(self)::Ch5 should skip 0-5% of messages.","test_skip_rate_varies_by_chapter:143:(self)::Skip rates should vary significantly between chapters.","test_invalid_chapter_uses_default:159:(self)::Invalid chapter should use a default skip rate."]],"TestSkipRatesByChapter":["173",["test_ch2_skip_rate:176:(self)::Ch2 should have rate 15-25%.","test_ch3_skip_rate:184:(self)::Ch3 should have rate 5-15%.","test_ch4_skip_rate:192:(self)::Ch4 should have rate 2-10%."]],"TestSkipConsecutiveMessages":["201",["test_skip_decision_tracks_last_skip:204:(self)::SkipDecision should track if last message was skipped.","test_consecutive_skips_less_likely:213:(self)::After a skip, next message should be less likely to skip."]]}],"t/agents/text/test_timing.py":["p",{"TestTimingRanges":["16",["test_timing_module_importable:19:(self)::Timing module should be importable.","test_ac_4_1_1_timing_ranges_is_dict:26:(self)::AC-4.1.1: TIMING_RANGES should be a dict mapping chapter to (min, max).","test_ac_4_1_2_ch1_range:45:(self)::AC-4.1.2: Ch1 range should be 600-28800s (10min-8h).","test_ac_4_1_3_ch5_range:56:(self)::AC-4.1.3: Ch5 range should be 300-1800s (5min-30min).","test_ranges_for_all_chapters:67:(self)::All 5 chapters should have timing ranges defined."]],"TestResponseTimer":["75",["test_response_timer_class_exists:78:(self)::ResponseTimer class should exist.","test_ac_4_1_4_calculate_delay_returns_int:84:(self)::AC-4.1.4: calculate_delay(chapter) should return int seconds.","test_calculate_delay_within_chapter_range:94:(self)::calculate_delay should return values within the chapter's range.","test_ac_4_1_5_distribution_not_uniform:109:(self)::AC-4.1.5: Distribution should be gaussian (clustered around mean).","test_ac_4_1_6_jitter_prevents_exact_patterns:134:(self)::AC-4.1.6: Random jitter should prevent exact repetition.","test_invalid_chapter_uses_default:147:(self)::Invalid chapter should fall back to a default range."]],"TestTimingProgression":["163",["test_timing_reduces_through_chapters:166:(self)::Response timing ranges should reduce as chapters progress.","test_average_delay_decreases_through_chapters:177:(self)::Average delays should decrease through chapters."]],"TestTimingRangesByChapter":["195",["test_ch2_timing_range:198:(self)::Ch2 should have range 300-14400s (5min-4h).","test_ch3_timing_range:209:(self)::Ch3 should have range 300-7200s (5min-2h).","test_ch4_timing_range:220:(self)::Ch4 should have range 300-3600s (5min-1h)."]]}],"t/agents/text/test_tools.py":["p",{"TestRecallMemoryTool":["23",["test_tools_module_importable:26:(self)::Tools module should be importable.","test_ac_2_2_1_tool_is_decorated:32:(self)::AC-2.2.1: Tool should be decorated with @agent.tool(retries=2).","test_ac_2_2_1_tool_registered_with_agent:45:(self)::AC-2.2.1: Tool is registered with the agent with retries=2.","test_ac_2_2_2_accepts_query_parameter:60:(self)::AC-2.2.2: Tool accepts query: str parameter.","test_ac_2_2_3_calls_search_memory:73:async (self)::AC-2.2.3: Tool calls memory.search_memory(query, limit=5).","test_ac_2_2_4_returns_formatted_results:98:async (self)::AC-2.2.4: Tool returns formatted string of results.","test_ac_2_2_5_handles_empty_results:141:async (self)::AC-2.2.5: Tool handles empty results gracefully."]],"TestFormatMemoryResults":["164",["test_format_function_exists:167:(self)::format_memory_results helper should exist.","test_format_with_multiple_results:173:(self)::Should format multiple memory results nicely.","test_format_empty_results:202:(self)::Should return appropriate message for empty results.","test_format_single_result:211:(self)::Should format a single result correctly.","test_format_handles_missing_created_at:230:(self)::Should handle results with missing created_at."]],"TestNoteUserFactTool":["250",["test_note_user_fact_exists:253:(self)::note_user_fact function should exist in tools module.","test_ac_6_2_1_tool_is_callable:259:(self)::AC-6.2.1: Tool should be callable (decorated with @agent.tool).","test_ac_6_2_1_tool_registered_with_agent:270:(self)::AC-6.2.1: Tool is registered with the agent.","test_ac_6_2_2_accepts_fact_and_confidence_parameters:285:(self)::AC-6.2.2: Tool accepts fact: str and confidence: float parameters.","test_ac_6_2_3_calls_add_user_fact:299:async (self)::AC-6.2.3: Tool calls memory.add_user_fact(fact, confidence).","test_ac_6_2_4_returns_confirmation_string:324:async (self)::AC-6.2.4: Tool returns confirmation string.","test_tool_handles_high_confidence_fact:347:async (self)::Tool should handle high confidence facts (explicit).","test_tool_handles_low_confidence_fact:367:async (self)::Tool should handle lower confidence facts (implicit)."]]}],"t/db/repositories/test_base.py":["p",{"MockModel":["21",[]],"TestBaseRepository":["33",["mock_session:37:(self)>AsyncMock::Create a mock AsyncSession.","test_base_repository_accepts_async_session:51:(self, mock_session:AsyncMock)::AC-T1.1: BaseRepository class accepts AsyncSession in __init__.","test_base_repository_requires_session:61:(self)::AC-T1.1: BaseRepository requires session parameter.","test_base_repository_session_property:71:(self, mock_session:AsyncMock)::AC-T1.2: BaseRepository exposes session property for subclasses.","test_session_property_readonly:80:(self, mock_session:AsyncMock)::AC-T1.2: Session property should be read-only.","test_get_method_returns_entity:94:async (self, mock_session:AsyncMock)::AC-T1.3: get(id) returns entity by primary key.","test_get_method_returns_none_for_missing:109:async (self, mock_session:AsyncMock)::AC-T1.3: get(id) returns None if entity not found.","test_create_method_adds_entity:121:async (self, mock_session:AsyncMock)::AC-T1.3: create(entity) adds and returns entity.","test_update_method_flushes_changes:136:async (self, mock_session:AsyncMock)::AC-T1.3: update(entity) flushes entity changes.","test_delete_method_removes_entity:150:async (self, mock_session:AsyncMock)::AC-T1.3: delete(entity) removes entity from session.","test_delete_by_id_method:163:async (self, mock_session:AsyncMock)::AC-T1.3: delete_by_id(id) gets and deletes entity.","test_delete_by_id_returns_false_for_missing:181:async (self, mock_session:AsyncMock)::AC-T1.3: delete_by_id(id) returns False if entity not found."]],"TestBaseRepositorySubclassing":["194",["mock_session:198:(self)>AsyncMock::Create a mock AsyncSession.","test_subclass_can_access_session:202:(self, mock_session:AsyncMock):custom_method:Verify subclasses can access session via property.","custom_method:207:(self)::","test_subclass_inherits_crud:214:(self, mock_session:AsyncMock)::Verify subclasses inherit CRUD methods."]]}],"t/db/repositories/test_user_repository.py":["p",{"TestUserRepository":["22",["mock_session:26:(self)>AsyncMock::Create a mock AsyncSession.","test_get_returns_user_with_metrics:43:async (self, mock_session:AsyncMock)::AC-T2.1: get(user_id) returns User with eager-loaded metrics.","test_get_returns_none_for_missing:64:async (self, mock_session:AsyncMock)::AC-T2.1: get(user_id) returns None if user not found.","test_get_by_telegram_id_returns_user:81:async (self, mock_session:AsyncMock)::AC-T2.2: get_by_telegram_id(telegram_id) returns User.","test_get_by_telegram_id_returns_none:100:async (self, mock_session:AsyncMock)::AC-T2.2: get_by_telegram_id returns None if not found.","test_create_creates_user_and_metrics:117:async (self, mock_session:AsyncMock)::AC-T2.3: create() creates User + UserMetrics atomically.","test_create_sets_default_metrics:135:async (self, mock_session:AsyncMock)::AC-T2.3: create() sets default metrics values (50.00).","test_update_score_updates_user_and_logs:152:async (self, mock_session:AsyncMock)::AC-T2.4: update_score updates user score and logs to history.","test_update_score_clamps_to_100:179:async (self, mock_session:AsyncMock)::AC-T2.4: update_score clamps score to max 100.","test_update_score_clamps_to_0:197:async (self, mock_session:AsyncMock)::AC-T2.4: update_score clamps score to min 0.","test_apply_decay_reduces_score:218:async (self, mock_session:AsyncMock)::AC-T2.5: apply_decay reduces score by decay amount.","test_apply_decay_logs_event:236:async (self, mock_session:AsyncMock)::AC-T2.5: apply_decay logs decay event to score_history.","test_advance_chapter_increments:264:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter increments chapter by 1.","test_advance_chapter_caps_at_5:282:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter does not exceed chapter 5.","test_advance_chapter_logs_event:300:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter logs chapter_advance event.","test_advance_chapter_resets_boss_attempts:319:async (self, mock_session:AsyncMock)::AC-T2.6: advance_chapter resets boss_attempts to 0."]]}]},"g":[["TestTypingIndicators.test_no_periodic_typing_for_short_delays","TestTypingIndicators.mock_sleep"],["UserRepository.update_score","PendingRegistrationRepository.get"],["BaseRepository.delete_by_id","PendingRegistrationRepository.delete"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","CommandHandler.__init__"],["ConversationRepository.__init__","DailySummaryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ResponseTimer.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","CommandHandler.__init__"],["VicePreferenceRepository.__init__","CommandHandler.__init__"],["ConversationRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","UserMetricsRepository.__init__"],["get_async_session","get_session_maker"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","RateLimiter.__init__"],["PendingRegistrationRepository.cleanup_expired","PendingRegistrationRepository.delete"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","FactExtractor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TelegramAuth.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","RateLimiter.__init__"],["VicePreferenceRepository.__init__","RateLimiter.__init__"],["UserNotFoundError.__init__","TestDailySummaryRepositoryExtras.__init__"],["UserRepository.__init__","FactExtractor.__init__"],["BaseRepository.delete","BaseRepository.delete"],["NikitaMemory.add_user_fact","add_episode"],["NikitaMemory.get_context_for_prompt","search_memory"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","BaseRepository.__init__"],["FactExtractor.extract_facts","FactExtractor._call_llm_for_extraction"],["ConversationRepository.__init__","MessageHandler.__init__"],["UserRepository.advance_chapter","get"],["get_nikita_agent_for_user","_get_nikita_agent_for_user"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","DailySummaryRepository.__init__"],["UserRepository.apply_decay","update_score"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TelegramBot.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","UserRepository.__init__"],["MessageHandler.handle","CommandHandler.handle"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestDailySummaryRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TelegramAuth.__init__"],["MessageHandler.handle","_send_rate_limit_response"],["MessageHandler.handle","generate_response"],["PendingRegistrationRepository.get_email","PendingRegistrationRepository.get"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestUserMetricsRepository.__init__"],["UserRepository.__init__","TelegramBot.__init__"],["atomic","is_deadlock_error"],["ScoreHistoryRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","UserNotFoundError.__init__"],["ScoreHistoryRepository.__init__","TelegramAuth.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ConversationRepository.__init__"],["DailySummaryRepository.__init__","ResponseTimer.__init__"],["create_telegram_router","receive_webhook"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestVicePreferenceRepositoryExtras.__init__"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","get_user_by_telegram_id"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","MessageHandler.__init__"],["TestTypingIndicators.test_ac_fr009_002_periodic_typing_during_delay","TestTypingIndicators.mock_sleep"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TelegramBot.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestVicePreferenceRepositoryExtras.__init__"],["RateLimiter.get_remaining","_get_minute_key"],["PendingRegistrationRepository.delete","BaseRepository.delete"],["NikitaMemory.add_nikita_event","add_episode"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","NikitaMemory.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ScoreHistoryRepository.__init__"],["RateLimiter.check","RateLimiter._get_minute_key"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","DailySummaryRepository.__init__"],["run_migrations_online","run_async_migrations"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","SkipDecision.__init__"],["MessageHandler.handle","handle"],["_create_nikita_agent","recall_memory"],["NikitaMemory.add_user_fact","NikitaMemory.add_episode"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","FactExtractor.__init__"],["UserRepository.__init__","NikitaMemory.__init__"],["DailySummaryRepository.__init__","BaseRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","FactExtractor.__init__"],["VicePreferenceRepository.__init__","FactExtractor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","__init__"],["UserMetricsRepository.__init__","CommandHandler.__init__"],["TestRateLimiter.test_ac_t024_3_get_remaining_returns_quota_info","TestRateLimiter.mock_get"],["ConversationRepository.__init__","UserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ConversationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","UserMetricsRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","RateLimiter.__init__"],["ResponseDelivery.queue","ResponseDelivery._wait_with_typing"],["UserNotFoundError.__init__","ResponseTimer.__init__"],["UserMetricsRepository.__init__","RateLimiter.__init__"],["get_nikita_agent_for_user","get_memory_client"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestVicePreferenceRepository.__init__"],["ScoreHistoryRepository.__init__","ConversationRepository.__init__"],["UserRepository.update_score","UserRepository.get"],["UserRepository.__init__","UserMetricsRepository.__init__"],["MessageHandler.handle","MessageHandler._send_error_response"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ScoreHistoryRepository.__init__"],["PendingRegistrationRepository.get_email","BaseRepository.get"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","MessageHandler.__init__"],["TestRateLimiter.test_ac_t024_3_get_remaining_returns_quota_info","mock_get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ResponseDelivery.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TelegramBot.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ResponseDelivery.__init__"],["ScoreHistoryRepository.__init__","ScoreHistoryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","VicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TelegramBot.__init__"],["VicePreferenceRepository.__init__","TelegramBot.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","VicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestDailySummaryRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","UserMetricsRepository.__init__"],["UserNotFoundError.__init__","BaseRepository.__init__"],["CommandHandler._handle_status","CommandHandler._get_chapter_name"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ResponseTimer.__init__"],["NikitaMemory.add_nikita_event","NikitaMemory.add_episode"],["VicePreferenceRepository.discover","VicePreferenceRepository.get_by_category"],["ScoreHistoryRepository.__init__","__init__"],["ScoreHistoryRepository.__init__","ResponseTimer.__init__"],["ConversationRepository.__init__","TestUserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestUserMetricsRepository.__init__"],["DailySummaryRepository.__init__","DailySummaryRepository.__init__"],["ConversationRepository.__init__","UserNotFoundError.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","UserNotFoundError.__init__"],["DailySummaryRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","NikitaMemory.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","NikitaMemory.__init__"],["UserRepository.__init__","TestUserMetricsRepository.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","TestTelegramAuth.store_impl"],["VicePreferenceRepository.__init__","NikitaMemory.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","BaseRepository.__init__"],["VicePreferenceRepository.discover","get_by_category"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","handle_message"],["PendingRegistrationRepository.get_email","UserRepository.get"],["ScoreHistoryRepository.__init__","BaseRepository.__init__"],["CommandHandler._handle_status","CommandHandler._get_score_hint"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestUserMetricsRepository.__init__"],["DailySummaryRepository.__init__","MessageHandler.__init__"],["TestRateLimiter.test_daily_limit_exceeded_blocks_message","mock_incr"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","UserNotFoundError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","DailySummaryRepository.__init__"],["DailySummaryRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","FactExtractor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestUserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","UserMetricsRepository.__init__"],["VicePreferenceRepository.__init__","UserMetricsRepository.__init__"],["UserMetricsRepository.__init__","UserRepository.__init__"],["BaseRepository.delete_by_id","delete"],["UserMetricsRepository.__init__","FactExtractor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","UserNotFoundError.__init__"],["UserNotFoundError.__init__","DailySummaryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","PendingRegistrationRepository.__init__"],["create_app","health"],["TestRateLimiter.test_daily_limit_exceeded_blocks_message","TestRateLimiter.mock_incr"],["ConversationRepository.__init__","RateLimiter.__init__"],["UserNotFoundError.__init__","UserRepository.__init__"],["PendingRegistrationRepository.cleanup_expired","delete"],["ConversationRepository.__init__","TestVicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestVicePreferenceRepository.__init__"],["BaseRepository.delete_by_id","get"],["TestRateLimiter.test_ac_fr006_002_warning_when_approaching_daily_limit","mock_incr"],["UserRepository.__init__","ConversationRepository.__init__"],["session","session_maker"],["UserRepository.__init__","TestVicePreferenceRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ResponseDelivery.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ResponseTimer.__init__"],["NikitaMemory.add_relationship_episode","add_episode"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","CommandHandler.__init__"],["TestRateLimiter.test_ac_fr006_002_warning_when_approaching_daily_limit","TestRateLimiter.mock_incr"],["BaseRepository.get","UserRepository.get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","SkipDecision.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","DailySummaryRepository.__init__"],["UserMetricsRepository.__init__","TelegramBot.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","VicePreferenceRepository.__init__"],["UserNotFoundError.__init__","MessageHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TelegramAuth.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","RateLimiter.__init__"],["ScoreHistoryRepository.__init__","DailySummaryRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestVicePreferenceRepository.__init__"],["VicePreferenceRepository.__init__","TestUserMetricsRepository.__init__"],["UserRepository.__init__","SkipDecision.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","RateLimiter.__init__"],["BaseRepository.update","PendingRegistrationRepository.session"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","UserNotFoundError.__init__"],["generate_response","build_system_prompt"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","BaseRepository.__init__"],["run_in_transaction","atomic"],["UserMetricsRepository.update_metrics","UserMetricsRepository._clamp"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","NikitaMemory.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","MessageHandler.__init__"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","TestSessionPersistence.get_user_by_telegram_id"],["UserMetricsRepository.__init__","NikitaMemory.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestVicePreferenceRepositoryExtras.__init__"],["run_async_migrations","get_url"],["RateLimiter.get_remaining","RateLimiter._get_minute_key"],["ScoreHistoryRepository.__init__","MessageHandler.__init__"],["BaseRepository.session","session"],["ScoreHistoryRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["atomic","wrapper"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ConversationRepository.__init__"],["get_agent_id","ElevenLabsConfig.get_agents_dict"],["ConversationRepository.__init__","FactExtractor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestDailySummaryRepositoryExtras.__init__"],["TestTypingIndicators.test_no_periodic_typing_for_short_delays","mock_sleep"],["BaseRepository.get","get"],["BaseRepository.delete_by_id","BaseRepository.delete"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ConversationRepository.__init__"],["VicePreferenceRepository.__init__","ConversationRepository.__init__"],["UserMetricsRepository.__init__","UserMetricsRepository.__init__"],["NikitaMemory.add_relationship_episode","NikitaMemory.add_episode"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestVicePreferenceRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","RateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestVicePreferenceRepository.__init__"],["VicePreferenceRepository.__init__","TestVicePreferenceRepository.__init__"],["BaseRepository.update","get"],["PendingRegistrationRepository.cleanup_expired","BaseRepository.delete"],["UserNotFoundError.__init__","UserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ScoreHistoryRepository.__init__"],["get_supabase_client","_get_supabase_sync_client"],["UserMetricsRepository.calculate_composite","get_by_user_id"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ScoreHistoryRepository.__init__"],["DailySummaryRepository.__init__","TestUserMetricsRepository.__init__"],["DailySummaryRepository.__init__","UserNotFoundError.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","SkipDecision.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","store_impl"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","DailySummaryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","SkipDecision.__init__"],["VicePreferenceRepository.__init__","SkipDecision.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","FactExtractor.__init__"],["ConversationRepository.__init__","ResponseDelivery.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ResponseDelivery.__init__"],["ConversationRepository.__init__","TelegramBot.__init__"],["MessageHandler.handle","MessageHandler.handle"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","__init__"],["VicePreferenceRepository.__init__","__init__"],["ConversationRepository.__init__","VicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","VicePreferenceRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","FactExtractor.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestDailySummaryRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TelegramAuth.__init__"],["ResponseDelivery.queue","_wait_with_typing"],["UserRepository.__init__","ResponseDelivery.__init__"],["BaseRepository.update","BaseRepository.session"],["CommandHandler._handle_status","_get_score_hint"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","PendingRegistrationRepository.__init__"],["UserMetricsRepository.__init__","TestUserMetricsRepository.__init__"],["UserRepository.__init__","VicePreferenceRepository.__init__"],["UserMetricsRepository.__init__","UserNotFoundError.__init__"],["UserMetricsRepository.update_metrics","UserMetricsRepository.get_by_user_id"],["DailySummaryRepository.__init__","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","MessageHandler.__init__"],["UserNotFoundError.__init__","TestUserMetricsRepository.__init__"],["UserRepository.__init__","PendingRegistrationRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ResponseDelivery.__init__"],["UserNotFoundError.__init__","UserNotFoundError.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","VicePreferenceRepository.__init__"],["ConversationRepository.__init__","NikitaMemory.__init__"],["DailySummaryRepository.__init__","RateLimiter.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ResponseDelivery.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TelegramBot.__init__"],["TelegramAuth.verify_magic_link","register_user"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","VicePreferenceRepository.__init__"],["atomic","decorator"],["TestTypingIndicators.test_ac_fr009_002_periodic_typing_during_delay","mock_sleep"],["recall_memory","format_memory_results"],["BaseRepository.update","BaseRepository.create"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","UserRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","FactExtractor.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ResponseTimer.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","CommandHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ConversationRepository.__init__"],["get_session_maker","get_async_engine"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","UserNotFoundError.__init__"],["NikitaMemory.add_episode","_get_group_id"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","NikitaMemory.__init__"],["UserNotFoundError.__init__","CommandHandler.__init__"],["ScoreHistoryRepository.__init__","UserNotFoundError.__init__"],["UserMetricsRepository.__init__","TestVicePreferenceRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","NikitaMemory.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ScoreHistoryRepository.__init__"],["UserNotFoundError.__init__","RateLimiter.__init__"],["create_app","root"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","BaseRepository.__init__"],["VicePreferenceRepository.__init__","ResponseDelivery.__init__"],["clean_session","session_maker"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","SkipDecision.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TelegramBot.__init__"],["UserMetricsRepository.__init__","SkipDecision.__init__"],["VicePreferenceRepository.__init__","VicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","UserMetricsRepository.__init__"],["ResponseDelivery.queue","ResponseDelivery._send_now"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","ResponseTimer.__init__"],["BaseRepository.delete_by_id","BaseRepository.get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","PendingRegistrationRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","CommandHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","UserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","PendingRegistrationRepository.__init__"],["VicePreferenceRepository.__init__","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestDailySummaryRepositoryExtras.__init__"],["ConversationRepository.__init__","TelegramAuth.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TelegramAuth.__init__"],["ScoreHistoryRepository.__init__","CommandHandler.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","RateLimiter.__init__"],["get_nikita_agent","_create_nikita_agent"],["UserRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["UserRepository.__init__","TelegramAuth.__init__"],["ScoreHistoryRepository.__init__","RateLimiter.__init__"],["DailySummaryRepository.__init__","FactExtractor.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestVicePreferenceRepositoryExtras.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","NikitaMemory.__init__"],["UserRepository.advance_chapter","PendingRegistrationRepository.get"],["UserRepository.update_score","get"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestDailySummaryRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TelegramAuth.__init__"],["_create_nikita_agent","note_user_fact"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestUserMetricsRepository.__init__"],["ConversationRepository.search","ConversationRepository.search"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","UserNotFoundError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","UserMetricsRepository.__init__"],["NikitaMemory.add_episode","NikitaMemory.add_episode"],["NikitaMemory.search_memory","_get_group_id"],["DailySummaryRepository.__init__","ResponseDelivery.__init__"],["UserMetricsRepository.update_metrics","_clamp"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","UserRepository.__init__"],["DailySummaryRepository.__init__","TelegramBot.__init__"],["FactExtractor.extract_facts","_deduplicate_facts"],["DailySummaryRepository.__init__","VicePreferenceRepository.__init__"],["generate_response","_generate_response"],["ConversationRepository.__init__","ConversationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ConversationRepository.__init__"],["UserNotFoundError.__init__","FactExtractor.__init__"],["create_telegram_router","set_webhook"],["ConversationRepository.__init__","ScoreHistoryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ScoreHistoryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","MessageHandler.__init__"],["UserMetricsRepository.__init__","ResponseDelivery.__init__"],["ConversationRepository.__init__","SkipDecision.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","DailySummaryRepository.__init__"],["BaseRepository.update","BaseRepository.get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestDailySummaryRepositoryExtras.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TelegramBot.__init__"],["UserRepository.__init__","ScoreHistoryRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ConversationRepository.__init__"],["UserMetricsRepository.__init__","VicePreferenceRepository.__init__"],["DailySummaryRepository.__init__","NikitaMemory.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestDailySummaryRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TelegramAuth.__init__"],["VicePreferenceRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["ConversationRepository.__init__","__init__"],["VicePreferenceRepository.__init__","TelegramAuth.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","__init__"],["PendingRegistrationRepository.get_email","get"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","RateLimiter.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","FactExtractor.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","ResponseTimer.__init__"],["UserNotFoundError.__init__","ResponseDelivery.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ConversationRepository.__init__"],["UserNotFoundError.__init__","TelegramBot.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestUserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TestVicePreferenceRepository.__init__"],["UserRepository.advance_chapter","BaseRepository.get"],["UserMetricsRepository.__init__","PendingRegistrationRepository.__init__"],["UserNotFoundError.__init__","VicePreferenceRepository.__init__"],["ScoreHistoryRepository.__init__","UserRepository.__init__"],["CommandHandler._handle_status","_get_chapter_name"],["ScoreHistoryRepository.__init__","FactExtractor.__init__"],["atomic","atomic"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestVicePreferenceRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ScoreHistoryRepository.__init__"],["UserRepository.__init__","__init__"],["UserRepository.__init__","ResponseTimer.__init__"],["TestRateLimiter.test_ac_t024_2_tracks_per_minute_and_per_day_limits","mock_incr"],["_AgentProxy._real_agent","get_nikita_agent"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ScoreHistoryRepository.__init__"],["DailySummaryRepository.__init__","UserMetricsRepository.__init__"],["NikitaMemory.search_memory","NikitaMemory._get_group_id"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","SkipDecision.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","MessageHandler.__init__"],["RateLimiter.get_remaining","RateLimiter._get_day_key"],["UserMetricsRepository.calculate_composite","UserMetricsRepository.get_by_user_id"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","SkipDecision.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","__init__"],["TestRateLimiter.test_ac_t024_2_tracks_per_minute_and_per_day_limits","TestRateLimiter.mock_incr"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","ResponseTimer.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TelegramBot.__init__"],["MessageHandler.handle","_send_error_response"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","__init__"],["UserNotFoundError.__init__","NikitaMemory.__init__"],["UserRepository.__init__","BaseRepository.__init__"],["ScoreHistoryRepository.__init__","TelegramBot.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","UserMetricsRepository.__init__"],["BaseRepository.session","PendingRegistrationRepository.session"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestVicePreferenceRepository.__init__"],["DailySummaryRepository.__init__","TelegramAuth.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","get_email_impl"],["ResponseTimer.calculate_delay_human_readable","ResponseTimer.calculate_delay"],["VicePreferenceRepository.__init__","ScoreHistoryRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","NikitaMemory.__init__"],["MessageHandler.handle","get_nikita_agent_for_user"],["ScoreHistoryRepository.__init__","NikitaMemory.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","SkipDecision.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","ResponseTimer.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","FactExtractor.__init__"],["get_agent_id","get_elevenlabs_config"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","ResponseTimer.__init__"],["VicePreferenceRepository.__init__","ResponseTimer.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","DailySummaryRepository.__init__"],["get_memory_client","NikitaMemory.initialize"],["UserMetricsRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","UserMetricsRepository.__init__"],["UserMetricsRepository.__init__","TelegramAuth.__init__"],["ConversationRepository.__init__","PendingRegistrationRepository.__init__"],["ResponseDelivery.queue","_send_now"],["BaseRepository.delete","PendingRegistrationRepository.delete"],["UserRepository.__init__","DailySummaryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestUserMetricsRepository.__init__"],["NikitaMemory.get_context_for_prompt","NikitaMemory.search_memory"],["ScoreHistoryRepository.__init__","UserMetricsRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","UserNotFoundError.__init__"],["UserNotFoundError.__init__","TelegramAuth.__init__"],["ResponseTimer.calculate_delay_human_readable","calculate_delay"],["UserRepository.__init__","UserRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","BaseRepository.__init__"],["BaseRepository.delete_by_id","PendingRegistrationRepository.get"],["create_telegram_router","TelegramBot.set_webhook"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","BaseRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ResponseDelivery.__init__"],["DailySummaryRepository.__init__","ConversationRepository.__init__"],["VicePreferenceRepository.__init__","BaseRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TelegramBot.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","DailySummaryRepository.__init__"],["RateLimiter.check","RateLimiter._get_day_key"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","VicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","MessageHandler.__init__"],["RateLimiter.check","_seconds_until_midnight"],["ConversationRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["DailySummaryRepository.__init__","TestVicePreferenceRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","TestVicePreferenceRepositoryExtras.__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","PendingRegistrationRepository.__init__"],["DailySummaryRepository.__init__","ScoreHistoryRepository.__init__"],["UserRepository.__init__","MessageHandler.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","PendingRegistrationRepository.__init__"],["UserRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["BaseRepository.update","create"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestUserMetricsRepository.__init__"],["DailySummaryRepository.__init__","SkipDecision.__init__"],["BaseRepository.session","BaseRepository.session"],["UserMetricsRepository.__init__","ConversationRepository.__init__"],["UserRepository.update_score","BaseRepository.get"],["DailySummaryRepository.__init__","__init__"],["PendingRegistrationRepository.delete","PendingRegistrationRepository.delete"],["ResponseDelivery._send_now","_split_message"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","MessageHandler.__init__"],["ScoreHistoryRepository.__init__","TestUserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","NikitaMemory.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","RateLimiter.__init__"],["ConversationRepository.search","search"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","TestVicePreferenceRepositoryExtras.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","TestVicePreferenceRepository.__init__"],["UserNotFoundError.__init__","ConversationRepository.__init__"],["UserMetricsRepository.__init__","ScoreHistoryRepository.__init__"],["UserNotFoundError.__init__","TestVicePreferenceRepository.__init__"],["NikitaMemory.add_episode","add_episode"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","DailySummaryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ResponseDelivery.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","DailySummaryRepository.__init__"],["VicePreferenceRepository.__init__","DailySummaryRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","VicePreferenceRepository.__init__"],["UserNotFoundError.__init__","ScoreHistoryRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","UserRepository.__init__"],["run_in_transaction","_wrapped"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","UserRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","CommandHandler.__init__"],["VicePreferenceRepository.__init__","UserRepository.__init__"],["UserMetricsRepository.__init__","__init__"],["UserMetricsRepository.__init__","ResponseTimer.__init__"],["ConversationRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["UserNotFoundError.__init__","SkipDecision.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","PendingRegistrationRepository.__init__"],["get_agent_id","get_agents_dict"],["run_migrations_offline","get_url"],["TestRateLimiter.test_multiple_users_isolated","mock_incr"],["MessageHandler.handle","MessageHandler._send_rate_limit_response"],["UserMetricsRepository.update_metrics","get_by_user_id"],["BaseRepository.get","PendingRegistrationRepository.get"],["UserNotFoundError.__init__","__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","TestVicePreferenceRepository.__init__"],["BaseRepository.update","PendingRegistrationRepository.get"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","MessageHandler.__init__"],["ResponseDelivery._send_now","ResponseDelivery._split_message"],["TestRateLimiter.test_multiple_users_isolated","TestRateLimiter.mock_incr"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","MessageHandler.__init__"],["ScoreHistoryRepository.__init__","TestVicePreferenceRepository.__init__"],["VicePreferenceRepository.__init__","MessageHandler.__init__"],["TestSessionPersistence.test_ac_fr005_003_no_cross_user_contamination","TestSessionPersistence.handle_message"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","BaseRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestVicePreferenceRepositoryExtras.__init__"],["NikitaMemory.add_episode","NikitaMemory._get_group_id"],["VicePreferenceRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestTelegramAuth.test_ac_t046_6_persistence_across_restarts","TestTelegramAuth.get_email_impl"],["UserMetricsRepository.__init__","BaseRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","SkipDecision.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","TelegramAuth.__init__"],["RateLimiter.get_remaining","_get_day_key"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TestDailySummaryRepositoryExtras.__init__"],["ScoreHistoryRepository.__init__","SkipDecision.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","TelegramAuth.__init__"],["BaseRepository.delete_by_id","UserRepository.get"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","FactExtractor.__init__"],["DailySummaryRepository.__init__","PendingRegistrationRepository.__init__"],["UserRepository.__init__","UserNotFoundError.__init__"],["RateLimiter.check","_get_minute_key"],["UserRepository.apply_decay","UserRepository.update_score"],["BaseRepository.get","BaseRepository.get"],["TestBaseRepositorySubclassing.test_subclass_can_access_session","TestBaseRepositorySubclassing.custom_method"],["get_pool_status","get_async_engine"],["NikitaMemory.get_user_facts","_get_group_id"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","ResponseDelivery.__init__"],["UserMetricsRepository.__init__","DailySummaryRepository.__init__"],["TestBaseRepositorySubclassing.test_subclass_can_access_session","custom_method"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","UserMetricsRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ConversationRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","VicePreferenceRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TestDailySummaryRepositoryExtras.__init__"],["ConversationRepository.__init__","ResponseTimer.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","UserRepository.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","TelegramAuth.__init__"],["ConversationRepository.__init__","CommandHandler.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","CommandHandler.__init__"],["FactExtractor.extract_facts","_call_llm_for_extraction"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_min_1","RateLimiter.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","ScoreHistoryRepository.__init__"],["get_nikita_agent_for_user","get_user_by_id"],["UserRepository.__init__","CommandHandler.__init__"],["UserNotFoundError.__init__","PendingRegistrationRepository.__init__"],["BaseRepository.delete","delete"],["get_memory_client","initialize"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","SkipDecision.__init__"],["RateLimiter.check","RateLimiter._seconds_until_midnight"],["atomic","transfer_funds"],["MessageHandler.handle","store_pending_response"],["UserRepository.__init__","RateLimiter.__init__"],["UserMetricsRepository.__init__","MessageHandler.__init__"],["ConversationRepository.__init__","BaseRepository.__init__"],["BaseRepository.update","session"],["TestDailySummaryRepositoryExtras.test_update_summary_updates_fields","NikitaMemory.__init__"],["UserMetricsRepository.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_clamps_to_max_5","__init__"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","CommandHandler.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","ResponseDelivery.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_clamps_to_zero","TelegramBot.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","VicePreferenceRepository.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","ResponseTimer.__init__"],["RateLimiter.check","_get_day_key"],["ScoreHistoryRepository.__init__","ResponseDelivery.__init__"],["UserNotFoundError.__init__","TestVicePreferenceRepositoryExtras.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","TestUserMetricsRepository.__init__"],["ScoreHistoryRepository.__init__","VicePreferenceRepository.__init__"],["BaseRepository.update","UserRepository.get"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","TestUserMetricsRepository.__init__"],["TestUserMetricsRepository.test_update_metrics_clamps_to_bounds","PendingRegistrationRepository.__init__"],["TestVicePreferenceRepository.test_update_intensity_applies_negative_delta","UserNotFoundError.__init__"],["NikitaMemory.get_user_facts","NikitaMemory._get_group_id"],["TestVicePreferenceRepository.test_update_intensity_applies_positive_delta","UserNotFoundError.__init__"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ConversationRepository.__init__"],["VicePreferenceRepository.__init__","UserNotFoundError.__init__"],["FactExtractor.extract_facts","FactExtractor._deduplicate_facts"],["ScoreHistoryRepository.__init__","PendingRegistrationRepository.__init__"],["UserRepository.advance_chapter","UserRepository.get"],["TestUserMetricsRepository.test_update_metrics_applies_deltas","BaseRepository.__init__"],["verify_task_secret","_get_task_secret"],["TelegramAuth.verify_magic_link","TelegramAuth.register_user"],["DailySummaryRepository.__init__","TestDailySummaryRepositoryExtras.__init__"],["TestVicePreferenceRepositoryExtras.test_update_engagement_applies_delta","BaseRepository.__init__"],["PendingRegistrationRepository.delete","delete"],["TestDailySummaryRepositoryExtras.test_update_summary_partial_update","ScoreHistoryRepository.__init__"]],"d":{"NIKITA_SYSTEM_OVERVIEW.md":["Nikita: Don't Get Dumped - Complete System Overview","Table of Contents","1. Executive Summary","Core Innovation","Tech Stack","2. System Architecture","2.1 High-Level Architecture"],"docs-to-process/20251129-verification-002-phase1-2.md":["Verification Report: Telegram Integration - Phase 1 & 2","Test Summary","AC Coverage","Phase 1: Setup (T001-T003)","Phase 2: Bot Client Foundation (T004-T005)","Test Execution Commands","Commands Run","Using virtual environment","Install dependencies","Run tests (TDD workflow)"],"docs-to-process/20251129-verification-002-phase3.md":["Verification Report: Telegram Integration - Phase 3 (US-1 Onboarding)","Test Summary","AC Coverage","T006-T007: Tests for US-1 (TDD RED Phase) \u2705","T008: TelegramAuth Implementation (TDD GREEN Phase) \u2705","T009: CommandHandler Implementation (TDD GREEN Phase) \u2705"],"docs-to-process/20251130-verification-002-phase4.md":["Phase 4 Verification Report: US-2 Send Message to Nikita","Executive Summary","Completed Tasks","Tests Written (TDD RED Phase)","Implementation (TDD GREEN Phase)","Verification","Test Results","MessageHandler Tests (8/8 PASSING)","ResponseDelivery Tests (10/10 PASSING)","Acceptance Criteria Verification"],"docs-to-process/20251130-verification-002-phase5.md":["Phase 5 Verification Report: US-3 Session Persistence","Executive Summary","Architectural Decision","Original Plan (spec.md + plan.md)","Actual Implementation","Completed Tasks","T019: Integration Tests \u2705","T020: SessionManager Class \u2705 (SKIPPED)","T021: Run All Tests \u2705","T022: Verify Context Preservation \u2705"],"docs-to-process/20251130-verification-002-phase6.md":["Phase 6 Verification Report: US-4 Rate Limiting","Executive Summary","Implementation Summary","Files Created","Files Modified","Completed Tasks","T023: Rate Limiter Tests \u2705","T024: RateLimiter Class \u2705","T025: Rate Limit Responses \u2705","T026: Run All US-4 Tests \u2705"],"docs-to-process/20251201-analysis-backend-db-audit.md":["Backend & Database Security Investigation Report","Verification Status (2025-12-01)","Executive Summary","1. Authentication Architecture Analysis","1.1 Current Implementation"],"docs-to-process/20251201-report-game-mechanics-audit.md":["Nikita Game Mechanics Comprehensive Audit Report","Executive Summary","Part One: The Chapter System","How Chapters Work","Chapter Progression Triggers","Implementation Status for Chapters","Part Two: The Scoring System","The Four Hidden Metrics","How Scores Are Calculated"],"docs-to-process/20251201-verification-memory-rls.md":["Memory Files RLS Pattern Verification Report","Summary","Files Verified","Verification Criteria","1. Correct RLS Pattern Usage","2. RLS Best Practices Documentation","RLS Best Practices","3. Code Examples Consistency","4. Cross-File Consistency","Detailed Findings"],"docs-to-process/20251202-security-review-001.md":["Security Review Report: Nikita System","Executive Summary","1. AUTHENTICATION","1.1 Telegram Webhook Validation \u26a0\ufe0f CRITICAL","nikita/api/routes/telegram.py:179-227","Add to nikita/platforms/telegram/auth.py","Update nikita/api/routes/telegram.py:179","1.2 Supabase Auth Magic Link Flow \u2705 GOOD","nikita/platforms/telegram/auth.py:86-97"],"docs-to-process/20251202-system-audio-guide.md":["Nikita: Don't Get Dumped - Complete System Audio Guide","Introduction and Overview","Part One: The Technology Stack","Compute Layer","The AI Agents","Memory and Database","Scheduling","Platform Integration","Part Two: System Architecture and Request Flow","Step One: Webhook Reception"],"docs-to-process/20251202-system-audit-final-report.md":["Nikita System Audit - Final Report","Executive Summary","1. Specification Status","1.1 Complete Specs (11/14)","1.2 Newly Completed Specs (3/3)","2. Code-Spec Alignment Fixes Applied","2.1 constants.py Updates","2.2 Model Updates","3. Architecture Review Summary","3.1 Strengths"],"event-stream.md":["Event Stream"],"plans/master-plan.md":["Nikita Game - Technical Architecture & Implementation Plan","SDD Orchestration (Dec 2025 Update)","Implementation Order (by dependency)","Security Issues (Pre-Production Blockers)","Key Values (Updated Dec 2025)","Executive Summary","1. High-Level System Architecture"],"specs/002-telegram-integration/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/002-telegram-integration/plan.md":["Implementation Plan: 002-Telegram-Integration","Overview","Core Components","Message Flow","Infrastructure Dependencies","From 010-api-infrastructure","Webhook endpoint (already defined in infrastructure spec)","From 011-background-tasks","From 009-database-infrastructure","Repositories"],"specs/002-telegram-integration/tasks.md":["Tasks: 002-Telegram-Integration","Phase 1: Setup","Phase 2: Bot Client Foundation","T004: Implement TelegramBot Client","T005: Create TelegramUpdate Model","Phase 3: US-1 New User Onboarding (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T008: Implement TelegramAuth Class","T009: Implement CommandHandler Class"],"specs/003-scoring-engine/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/003-scoring-engine/plan.md":["Implementation Plan: 003-Scoring-Engine","Goal","Summary","Technical Context","Existing Architecture (Intelligence Evidence)","Existing scoring patterns","Found: 20 files with scoring-related code","Constants check","Found: Lines 25-31 (thresholds), 51-57 (weights)","Constitution Check (Article VI)"],"specs/003-scoring-engine/tasks.md":["Tasks: 003-Scoring-Engine","Phase 1: Setup","Phase 2: Foundational Models","T003: Create ResponseAnalysis Model","T004: Create ConversationContext Model","T005: Create ScoreEvent Model","Phase 3: US-1 Exchange Scoring (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T009: Implement ScoreAnalyzer Class"],"specs/004-chapter-boss-system/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Tasks \u2192 Requirements Mapping","Constitution Alignment","Article Compliance Matrix","Constitution Compliance Detail"],"specs/004-chapter-boss-system/plan.md":["Implementation Plan: Chapter & Boss System (004)","Goal","Summary","Technical Context","Existing Architecture (from Explore)","Architecture (CoD^\u03a3)","Component Flow","Module Structure","Dependencies (CoD^\u03a3)","Tasks (By User Story)"],"specs/004-chapter-boss-system/tasks.md":["Tasks: Chapter & Boss System (004)","Get symbols from existing engine code","Check existing user model","Find agent patterns","Phase 1: Setup (Shared Infrastructure)","T1: Create Boss State Machine Module","T2: [P] Create Boss Prompts Module","Phase 2: US-1 - Boss Trigger (Priority: P1)","Intelligence Queries for US-1","Find scoring patterns"],"specs/005-decay-system/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/005-decay-system/plan.md":["Implementation Plan: 005-Decay-System","Goal","Summary","Technical Context","Existing Architecture (Intelligence Evidence)","Existing decay constants","Found: Lines 33-49","User model with last_interaction_at","Found: nikita/db/models/user.py:66","Constitution Check (Article VI)"],"specs/005-decay-system/tasks.md":["Tasks: 005-Decay-System","Phase 1: Setup","Phase 2: Foundational Models","T003: Create DecayResult Model","Phase 3: US-1 Grace Period Protection (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T005: Implement DecayCalculator.is_overdue() Method","Verification for US-1","Phase 4: US-2 Decay Application (P1 - Must-Have)"],"specs/006-vice-personalization/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/006-vice-personalization/plan.md":["Implementation Plan: 006-Vice-Personalization","Overview","Core Components","8 Vice Categories (constitution.md \u00a7II.3)","Existing Infrastructure","VicePreferenceRepository (COMPLETE)","UserVicePreference Model (COMPLETE)","Implementation Tasks","Task 1: Add Vice Constants","Detection confidence thresholds"],"specs/006-vice-personalization/tasks.md":["Tasks: 006-Vice-Personalization","Phase 1: Setup","Phase 2: Vice Detection Models","T005: Create ViceSignal Model","T006: Create ViceAnalysisResult Model","T007: Create ViceProfile Model","Phase 3: US-1 Vice Detection (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T010: Create Vice Analysis Prompt Template"],"specs/007-voice-agent/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/007-voice-agent/plan.md":["Implementation Plan: 007-Voice-Agent","Overview","Architecture (ElevenLabs Server Tools Pattern)","Key Insight: No WebSocket Server Needed","ElevenLabs Integration","Agent Configuration","Server Tool Endpoints","Implementation Tasks","Task 1: Create Voice Module Structure"],"specs/007-voice-agent/tasks.md":["Tasks: 007-Voice-Agent","Phase 1: Setup","Phase 2: Voice Models","T004: Create Voice Data Models","Phase 3: US-1 Start Voice Call (P1 - Must-Have)","Tests for US-1 \u26a0\ufe0f WRITE TESTS FIRST","Implementation for US-1","T006: Implement Call Initiation Logic","T007: Create Call Initiation API Endpoint","Verification for US-1"],"specs/008-player-portal/audit-report.md":["Specification Audit Report","Executive Summary","Findings","Coverage Analysis","Requirements \u2192 Tasks Mapping","User Stories \u2192 Tasks Mapping","Constitution Alignment","Article Compliance Matrix","Specific Constitution References","Implementation Readiness"],"specs/008-player-portal/plan.md":["Implementation Plan: 008-Player-Portal","Overview","Architecture","Key Principle: View Only, No Gameplay","Tech Stack","Implementation Tasks","Task 1: Create Portal Project Structure","Task 2: Implement Authentication","Task 3: Implement Dashboard View","Task 4: Implement Score Chart"],"specs/008-player-portal/tasks.md":["Implementation Tasks: 008-Player-Portal","Phase 1: Project Setup","T001: Initialize Next.js Portal Project","T002: Install UI Dependencies","T003: Create Project Structure","Phase 2: Authentication (US-1 Prerequisite)","\u26a0\ufe0f WRITE TESTS FIRST","T004: Write Authentication Tests","T005: Implement Supabase Client Setup","T006: Implement Login Page"],"specs/009-database-infrastructure/consistency-verification.md":["Spec 009 Consistency Verification Report","Executive Summary","Detailed Verification","1. spec.md RLS Performance Requirements (FR-003)","FR-003: Row-Level Security (RLS)","2. plan.md Phase 6 Security Remediation","Phase 6: Security Remediation (Audit Findings - 2025-12-01)","3. tasks.md Security Remediation Tasks (T15-T18)","User Story: US-004 Security Remediation (Priority: P1)","T15: Fix message_embeddings Schema Drift"],"specs/010-api-infrastructure/audit-report.md":["Audit Report: 010-API-Infrastructure","Summary","Requirement Traceability","Functional Requirements \u2192 Tasks","User Stories \u2192 Tasks","Acceptance Criteria Compliance","Article III Check: \u22652 ACs per Task","Dependency Validation","Upstream Dependencies","Downstream Blocks"],"specs/010-api-infrastructure/plan.md":["Implementation Plan: 010-API-Infrastructure","Overview","Dependency Analysis","Existing Code Analysis","User Story Tasks","US-001: Portal Authentication (P1)","US-002: Webhook Security (P1)"],"specs/010-api-infrastructure/tasks.md":["Tasks: 010-API-Infrastructure","Overview","US-001: Portal Authentication (P1)","T1.1: Create Supabase JWT Verification Module","T1.2: Create get_current_user Dependency","T1.3: Create Portal Router with Protected Routes","T1.4: Update main.py with API v1 Prefix","US-002: Webhook Security (P1)","T2.1: Create Webhook Auth Dependencies","T2.2: Create Telegram Router Stub"],"specs/011-background-tasks/audit-report.md":["Audit Report: 011-Background-Tasks","Summary","Requirement Traceability","Functional Requirements \u2192 Tasks","User Stories \u2192 Tasks","Acceptance Criteria Compliance","Article III Check: \u22652 ACs per Task","Dependency Validation","Upstream Dependencies","Downstream Blocks"],"specs/011-background-tasks/plan.md":["Implementation Plan: 011-Background-Tasks","Overview","Dependency Analysis","Database Schema Required","pending_responses (for FR-002)","job_history (for FR-005)","daily_summaries (for FR-003)","User Story Tasks","US-001: Decay Application (P1)","US-002: Delayed Response Delivery (P1)"],"specs/011-background-tasks/tasks.md":["Tasks: 011-Background-Tasks","Overview","US-001: Decay Application (P1)","T1.1: Create pending_responses Table Migration","T1.2: Create job_history Table Migration","T1.3: Create daily_summaries Table Migration","T1.4: Create apply_daily_decay SQL Function","T1.5: Schedule pg_cron Decay Job","US-002: Delayed Response Delivery (P1)","T2.1: Create deliver-responses Edge Function"],"specs/012-context-engineering/audit-report.md":["012 - Context Engineering System Audit Report","Executive Summary","1. Specification Completeness","1.1 User Stories Coverage","1.2 Technical Completeness","1.3 Token Budget Analysis","2. Plan Coverage","2.1 Spec-to-Plan Mapping","2.2 Dependency Chain","3. Tasks Breakdown"],"specs/012-context-engineering/plan.md":["012 - Context Engineering System Implementation Plan","Executive Summary","User Stories","US-1: State Collection (P1)","US-2: Temporal Context (P1)","US-3: Memory Summarization (P1)","US-4: Mood Computation (P1)","US-5: Prompt Assembly (P1)","US-6: Validation (P2)","US-7: Integration (P1)"],"specs/012-context-engineering/spec.md":["012 - Context Engineering System","1. Overview","1.1 Purpose","1.2 Goals","1.3 Non-Goals","2. Architecture","2.1 Pipeline Overview","2.2 Component Diagram","3. Data Structures","3.1 PlayerProfile"],"specs/012-context-engineering/tasks.md":["012 - Context Engineering System Tasks","User Story Organization","Phase 1: Data Models (2 hours)","T1.1: Create Context Module Structure","T1.2: Implement PlayerProfile Model","T1.3: Implement TemporalContext Model","T1.4: Implement MemoryContext Model","T1.5: Implement NikitaState Model","T1.6: Implement SystemPrompt Model","Phase 2: Stage Implementations (5 hours)"],"specs/013-configuration-system/audit-report.md":["013 - Configuration System Audit Report","Executive Summary","1. Specification Completeness","1.1 User Stories Coverage","1.2 Technical Completeness","2. Plan Coverage","2.1 Spec-to-Plan Mapping","2.2 Dependency Order","3. Tasks Breakdown","3.1 Task Quality"],"specs/013-configuration-system/plan.md":["013 - Configuration System Implementation Plan","Executive Summary","User Stories","US-1: Base Configuration Loading (P1)","US-2: Pydantic Schema Validation (P1)","US-3: ConfigLoader Singleton (P1)","US-4: Prompt File System (P2)","US-5: Experiment Overlays (P2)","US-6: Migration from constants.py (P1)","Technical Architecture"],"specs/013-configuration-system/spec.md":["013 - Configuration System","1. Overview","1.1 Purpose","1.2 Goals","1.3 Design Principles","2. Architecture","2.1 Three-Layer System"],"specs/013-configuration-system/tasks.md":["013 - Configuration System Tasks","User Story Organization","US-1: Base Configuration Loading (P1)","T1.1: Create Directory Structure","T1.2: Create game.yaml","T1.3: Create chapters.yaml","US-2: Pydantic Schema Validation (P1)","T2.1: Create GameConfig Schema","T2.2: Create ChaptersConfig Schema","T2.3: Create EngagementConfig Schema"],"specs/014-engagement-model/audit-report.md":["014 - Engagement Model Audit Report","Executive Summary","1. Specification Completeness","1.1 User Stories Coverage","1.2 Technical Completeness","1.3 Mathematical Model Quality","2. Plan Coverage","2.1 Spec-to-Plan Mapping","2.2 Dependency Order","3. Tasks Breakdown"],"specs/014-engagement-model/plan.md":["014 - Engagement Model Implementation Plan","Executive Summary","User Stories","US-1: Engagement State Machine (P1)","US-2: Calibration Score Computation (P1)","US-3: Clinginess Detection (P1)","US-4: Neglect Detection (P1)","US-5: Recovery Mechanics (P2)","US-6: Chapter Transitions (P2)","Technical Architecture"],"specs/014-engagement-model/spec.md":["014 - Engagement Model","1. Overview","1.1 Purpose","1.2 Core Philosophy","1.3 Key Differences from Old Model","2. Engagement State Machine","2.1 State Diagram"],"specs/014-engagement-model/tasks.md":["014 - Engagement Model Tasks","User Story Organization","Phase 1: Core Models (2 hours)","T1.1: Create Engagement Module Structure","T1.2: Implement EngagementState Enum","T1.3: Create Database Models","T1.4: Create Database Migration","Phase 2: Detection Algorithms (3 hours)","T2.1: Implement ClinginessDetector","T2.2: Implement NeglectDetector"],"specs/CROSS_VALIDATION_REPORT.md":["Cross-Validation Report","Validation Summary","Detailed Validations","1. Calibration Multipliers (003, 013, 014)","2. Boss Thresholds (004, 013)","3. Grace Periods (005, 013)","4. Decay Rates (005, 013)","5. Recovery Penalties and Rates (005, 013, 014)","6. Tolerance Bands (013, 014)","7. Chapter Behavior Profiles (004, 013)"],"CLAUDE.md":["CLAUDE.md","Core Constraints","Start","Repository Hygiene","State File Size Limits","Documentation Rules","Directory Structure"],"README.md":["Nikita: Don't Get Dumped","Overview","Tech Stack","Project Structure","Quick Start","Prerequisites","Installation","Clone repository","Create virtual environment","or: .venv\\Scripts\\activate  # Windows"],"docs-to-process/challenge_conflict_framework (2).md":["Challenge and Conflict Framework for Adult Relationship","Overview","Boss Encounter System","Boss Encounter Structure","Core Boss Encounters"],"docs-to-process/decision_trees_touchpoints.md":["Nikita GFE: Decision Trees & Conditional Touchpoints","Introduction","Core Decision Architecture","Master Decision Flow","Context Evaluation Decision Tree","Action Type Decision Tree"],"docs-to-process/emotional_engagement_mechanisms.md":["Nikita GFE: Emotional Engagement Mechanisms","Emotional System Overview","Emotional State Simulation","Core Emotional Architecture","Emotional State Generation","Mood Variation and Transitions","Mood System Architecture"],"docs-to-process/game_design_analysis (2).md":["Game-Inspired Architecture Analysis for Nikita GFE","Core Game Design Concepts for Adult Relationship Simulation","Chapters & Story Progression","Levels & Progression Mechanics","Relationship Points System","Experience Points & Skill Trees","Challenge & \"Boss\" Encounters","Reward Systems","Adult-Oriented Game Elements","Vice Progression System"],"docs-to-process/game_design_analysis (3).md":["Game-Inspired Architecture Analysis for Nikita GFE","Core Game Design Concepts for Adult Relationship Simulation","Chapters & Story Progression","Levels & Progression Mechanics","Relationship Points System","Experience Points & Skill Trees","Challenge & \"Boss\" Encounters","Reward Systems","Adult-Oriented Game Elements","Vice Progression System"],"docs-to-process/memory_personalization_system.md":["Nikita GFE: Memory & Personalization System","Advanced Memory Architecture","Memory System Overview","Memory Integration System"],"docs-to-process/messaging_platform_integration.md":["Nikita GFE: Messaging Platform Integration","Messaging System Overview","Messaging Patterns and Frequency","Message Initiation Framework","Messaging Frequency C"],"docs-to-process/nikita_gfe_final_concept (1).md":["Nikita GFE: Comprehensive Concept Document","Executive Summary","Core Concept Overview","Vision Statement","Key Experience Principles","Differentiation Factors","Nikita's Character Profile","Core Personality Traits"],"docs-to-process/nikita_personality_profile.md":["Nikita: Personality & Interaction Model","Core Personality Profile","Identity Overview","Key Personality Traits","Communication Style","Detailed Backstory","Personal History","Current Life Circumstances","Relationship History","Interaction Model"],"docs-to-process/personality_model_integration (1) (1).md":["Nikita Personality Model Integration with Vice Aspects","Overview","Personality Model Architecture","1. Core Personality Framework"],"docs-to-process/relationship_game_mechanics_research (2) (1).md":["Research: Adult Relationship and Vice-Oriented Game Mechanics","Key Relationship Mechanics from Game Research","Relationship Value Systems","Progression Mechanics","Vice-Oriented Mechanics","Challenge and Conflict Systems","Technical Implementation Approaches","State Management Systems","Progression Tracking"],"docs-to-process/relationship_journey_flowchart (1).md":["Nikita GFE: Relationship Journey Flowchart & Decision System","Introduction","Relationship Stage Framework","Stage 1: Initial Connection (Days 1-14)","Stage 2: Growing Intrigue (Days 15-35)","Stage 3: Emotional Investment (Days 36-70)"],"docs-to-process/relationship_points_experience_system (2).md":["Relationship Points and Experience System with Vice Elements","Overview","Core Relationship Metrics","1. Intimacy Points","2. Passion Points","3. Trust Points","4. Understanding Points","5. Vice Points"],"docs-to-process/relationship_progression_system.md":["Nikita GFE: Real-Time Relationship Progression System","Relationship System Overview","Relationship Stage Framework","Core Relationship Stages"],"docs-to-process/reward_achievement_system (2).md":["Reward and Achievement System for Adult Milestones","Overview","Reward System Architecture","1. Core Reward Types"],"docs-to-process/stage_based_interaction_framework (1).md":["Nikita GFE: Stage-Based Interaction Framework","Introduction","Stage-Based Behavioral Parameters","Stage 1: Initial Connection (Days 1-14)","Stage 2: Growing Intrigue (Days 15-35)"],"docs-to-process/state_management_progression_logic (2).md":["State Management and Progression Logic for Adult Content","Overview","State Management Core Principles","1. Holistic State Representation","2. Event-Driven State Updates","3. Persistent and Ephemeral State","4. State Access Patterns","Relationship State Management","1. Core Relationship Metrics"],"docs-to-process/system_overview (1).md":["Nikita GFE: System Overview","Introduction","Core System Concept","System Architecture Overview","Core Components","Key Technical Features","Key Experience Elements","Personality & Character"],"docs-to-process/user_experience_documentation (1).md":["Nikita GFE: User Experience Documentation","Introduction","User Journey Overview","First Contact & Onboarding","Relationship Development","Daily Interaction Patterns","Experience Design Elements","Personality Expression","Relationship Dynamics"],"docs-to-process/user_onboarding_customization.md":["Nikita GFE: User Onboarding & Customization Process","Onboarding System Overview","Initial User Interview Process","Interview Framework Design","Interview Content Framework"],"docs-to-process/voice_interaction_capabilities.md":["Nikita GFE: Voice Interaction Capabilities","Voice System Overview","Voice Personality Characteristics","Core Vocal Identity","Voice Personality Integration"],"docs/README.md":["Nikita: Don't Get Dumped","The Game","Documentation Index","Game Design","Technical","Quick Reference","Scoring","Chapters","Key Mechanics","Tech Stack"],"docs/architecture/overview.md":["Nikita: Architecture Overview","Tech Stack","System Architecture","Three Knowledge Graphs","1. Nikita Graph","2. User Graph","3. Relationship Graph"],"docs/game/journey.md":["Nikita: The Player Journey","The First 10 Minutes: The Hook","Her Opening","The Test Begins","Chapter 1: Curiosity (Days 1-14)","What You're Experiencing","Daily Pattern (Chapter 1)","Sample Week 1 Interactions","Chapter 1 Boss: \"Are You Worth My Time?\"","Chapter 2: Intrigue (Days 15-35)"],"docs/game/mechanics.md":["Nikita: Game Mechanics","The Core Loop","Scoring System","Single Composite Score","Hidden Sub-Metrics","Score Visibility","Chapter Progression","5 Chapters","Advancement Gate","Boss Encounters"],"docs/game/nikita.md":["Nikita: Character Profile","Who She Is","Her Voice","Intellectual Mode","Substance References (Authentic)","Fight-Picking Mode","Flirtation Mode","Vulnerability Mode (Earned)","The Disappearance","Emotional States"],"memory/README.md":["Memory Documentation Hub","Documentation Files","Navigation","Critical References","Phase 1 Status (Complete)","Next Steps (Phases 2-5)"],"memory/architecture.md":["System Architecture","Current State","High-Level Architecture (Option 1: Python Game Engine + Supabase Spine)","Component Hierarchy (Phase 1 Complete)"],"memory/backend.md":["Backend Architecture","Current State","Deployment: Google Cloud Run","cloud-run-config (inline or via cloudbuild.yaml)","FastAPI Application Structure","Text Agent Handler (\u2705 COMPLETE)","Database Schema (Supabase PostgreSQL)"],"memory/constitution.md":["Nikita Technical Constitution","Preamble","Article I: Architecture Principles","Section 1.1: Interface Invisibility","Section 1.2: Dual-Agent Architecture","Section 1.3: Platform Agnostic Communication","Article II: Data & Memory Principles","Section 2.1: Temporal Memory Persistence","Section 2.2: Score State Atomicity","Section 2.3: Vice Preference Learning"],"memory/game-mechanics.md":["Game Mechanics","Current State","Scoring System (Defined in Constants)","Composite = intimacy*0.30 + passion*0.25 + trust*0.25 + secureness*0.20","Implemented in: nikita/db/models/user.py:155-166","Chapter System (Constants Defined)","Boss Encounters (Constants Defined)","Decay System (Constants Defined)","Vice Categories (Constants Defined)"],"memory/integrations.md":["External Integrations","Current State","Supabase Integration","Configuration (Phase 1 \u2705)","Usage Patterns (TODO Phase 2)","API/Backend: SQLAlchemy via direct PostgreSQL connection","Portal: Supabase Client SDK (for RLS, Auth)","Portal: OTP sign-in","User receives SMS code \u2192 enters \u2192 JWT token issued","Backend: Verify JWT from portal requests"],"memory/product.md":["Product Definition: Nikita - Don't Get Dumped","Product Overview","Name","Tagline","Vision","Problem Statement","Market Context","Value Proposition","Core Value","\"Our Thing\""],"memory/user-journeys.md":["User Journeys","Current State","Target Specs","Journey 1: New Player Onboarding","Journey 2: Chapter Progression"],"nikita/CLAUDE.md":["nikita/ Package Overview","Purpose","Module Structure","Key Files","Development Patterns","1. Settings Access","2. Memory System","3. Game Constants","Architecture","Next Steps"],"nikita/api/CLAUDE.md":["api/ - FastAPI Application","Purpose","Current State","Target Architecture (Phase 2-5)","Key Endpoints (TODO)","Telegram (Phase 2)","Voice (Phase 4)","Portal (Phase 5)","Patterns","Dependency Injection"],"nikita/db/CLAUDE.md":["db/ - Database Layer","Purpose","Current State","Key Models","User (user.py:19-110)","UserMetrics (user.py:112-167)","UserVicePreference (user.py:169-207)","Repository Pattern \u2705 COMPLETE","Database Schema","Migrations \u2705 COMPLETE (via Supabase MCP)"],"nikita/engine/CLAUDE.md":["engine/ - Game Engine","Purpose","Current State","Key Constants","Scoring Formula (constants.py:51-57)","Composite = intimacy*0.30 + passion*0.25 + trust*0.25 + secureness*0.20","Chapter System (constants.py - updated Dec 2025)","Note: Decay is now HOURLY (compressed game), grace periods compressed too","Chapter Behaviors (constants.py:60-110)","Target Implementation (Phase 3)"],"nikita/memory/CLAUDE.md":["memory/ - Knowledge Graph System","Purpose","Current State","Three-Graph Architecture","Nikita Graph","User Graph","Relationship Graph","Key Methods","add_episode (graphiti_client.py:54-79)","search_memory (graphiti_client.py:81-118)"],"specs/001-nikita-text-agent/audit-report.md":["Audit Report: 001-nikita-text-agent","Executive Summary","1. Requirements Coverage Analysis","Functional Requirements \u2192 Tasks Mapping","2. User Story \u2192 Task Mapping","P1 User Stories (Must-Have)","P2 User Stories (Important)","P3 User Stories (Deferred)","3. Acceptance Criteria Analysis","Spec ACs \u2192 Tasks Mapping"],"specs/001-nikita-text-agent/plan.md":["Implementation Plan: Nikita Text Agent","Executive Summary","Architecture Overview","Research Summary","Pydantic AI Patterns (from plan research)","Existing Infrastructure","User Story Implementation","US-1: Basic Conversation (P1)","US-2: Memory-Enriched Responses (P1)"],"specs/001-nikita-text-agent/spec.md":["Feature Specification: Nikita Text Agent","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Nikita Persona Consistency","FR-002: Chapter-Specific Behavior Adaptation","FR-003: Memory Context Integration","FR-004: Message Skipping Logic","FR-005: Response Timing Variation","FR-006: Conversation Quality Assessment"],"specs/001-nikita-text-agent/tasks.md":["Implementation Tasks: Nikita Text Agent","Overview","US-1: Basic Conversation (Priority: P1 - Must-Have) \u2705","T1.1: Create Nikita Persona Prompt","T1.2: Create NikitaDeps Dataclass","T1.3: Implement NikitaTextAgent","T1.4: Create Agent Factory","US-2: Memory-Enriched Responses (Priority: P1 - Must-Have) \u2705","T2.1: Implement Memory Context Injection","T2.2: Create recall_memory Tool"],"specs/002-telegram-integration/spec.md":["Feature Specification: Telegram Platform Integration","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Bot Command Handling","FR-002: Text Message Routing","FR-003: User Authentication Flow","FR-004: Account Creation","FR-005: Session Management","FR-006: Rate Limiting"],"specs/003-scoring-engine/spec.md":["Feature Specification: Scoring Engine","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Interaction Analysis","FR-002: Metric Delta Calculation","FR-003: Composite Score Calculation","FR-004: Score Bounds Enforcement","FR-005: Score History Logging","FR-006: Context-Aware Analysis"],"specs/004-chapter-boss-system/spec.md":["Feature Specification: Chapter & Boss System","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Boss Threshold Detection","FR-002: Boss Encounter Initiation","FR-003: Five Distinct Boss Challenges","FR-004: Boss Outcome Judgment","FR-005: Boss Pass Handling","FR-006: Boss Fail Handling"],"specs/005-decay-system/spec.md":["Feature Specification: Decay System","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Grace Period Enforcement (UPDATED)","FR-002: Chapter-Specific Decay Rates (UPDATED)","FR-003: Decay Calculation","FR-004: Scheduled Decay Application","FR-005: Decay Floor Protection","FR-006: Interaction Reset"],"specs/006-vice-personalization/spec.md":["Feature Specification: Vice Personalization System","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Vice Category Detection","FR-002: Conversation Analysis for Vice Signals","FR-003: Vice Intensity Scoring","FR-004: Multi-Vice Profiles","FR-005: Vice-Aware Prompt Injection","FR-006: Natural Vice Expression"],"specs/007-voice-agent/spec.md":["Feature Specification: Voice Agent","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Voice Call Initiation","FR-002: Real-Time Speech Processing","FR-003: Natural Voice Response","FR-004: Conversational Latency","FR-005: Same-Agent Personality","FR-006: Voice Call Scoring"],"specs/008-player-portal/spec.md":["Feature Specification: Player Portal","Summary","CoD^\u03a3 Overview","Functional Requirements","FR-001: Authentication","FR-002: Dashboard View","FR-003: Score History Visualization","FR-004: Conversation History","FR-005: Chapter Progress Display","FR-006: Voice Call Access"],"specs/009-database-infrastructure/audit-report.md":["Audit Report: 009 Database Infrastructure","Summary","Requirement Coverage Audit","Functional Requirements","Non-Functional Requirements","User Stories","Acceptance Criteria Audit","AC Count per Task","AC Testability Check","Dependency Audit"],"specs/009-database-infrastructure/plan.md":["Implementation Plan: Database Infrastructure","Goal","Summary","Technical Context","Existing Architecture (Intelligence Evidence)","Database files found","Output: database.py, models/{base,user,conversation,game}.py, repositories/__init__.py","Repository pattern check","Output: nikita/db/CLAUDE.md (docs only, no implementation)","AsyncSession usage"],"specs/009-database-infrastructure/spec.md":["009: Database Infrastructure","Overview","Functional Requirements","FR-001: Repository Pattern Implementation","FR-002: Migration Management","FR-003: Row-Level Security (RLS)","FR-004: Connection Pooling","FR-005: Transaction Management","FR-006: Audit Logging","Non-Functional Requirements"],"specs/009-database-infrastructure/tasks.md":["Tasks: 009 Database Infrastructure","Overview","User Story: US-001 Repository Instantiation (Priority: P1)","T1: Create Base Repository Class","T2: Create UserRepository","T3: Create UserMetricsRepository","T4: Create ConversationRepository","T5: Create ScoreHistoryRepository","T6: Create VicePreferenceRepository and DailySummaryRepository","T7: Create Repository Dependencies"],"specs/010-api-infrastructure/spec.md":["010: API Infrastructure","Overview","Functional Requirements","FR-001: FastAPI Application Structure","FR-002: Authentication Middleware","FR-003: Rate Limiting","FR-004: Request/Response Schemas","Portal Responses","Webhook Payloads","FR-005: Error Handling"],"specs/011-background-tasks/spec.md":["011: Background Tasks Infrastructure","Overview","Functional Requirements","FR-001: Scheduled Decay Processing","FR-002: Delayed Message Delivery","FR-003: Daily Summary Generation","FR-004: Edge Function Execution","FR-005: Job Monitoring","FR-006: Task Idempotency","Non-Functional Requirements"],"specs/SPEC_INVENTORY.md":["Nikita Spec Inventory","Spec Matrix","Implementation Order (Updated 2025-12-02)","Phase A: Infrastructure Foundation","Phase B: Core System Architecture (NEW)","Phase C: Core Game Engine","Phase D: Platform Integration","Phase E: Advanced Features","Infrastructure Coverage","009-database-infrastructure"],"todo/master-todo.md":["Master Todo - Nikita Game","SDD Specification Status \u2705 ALL 14 SPECS AUDITED","Critical Path: 013 \u2192 014 \u2192 012 \u2192 Game Engine \u2192 Voice \u2192 Portal","Phase 1: Core Infrastructure \u2705 COMPLETE","Phase 2: Text Agent \u26a0\ufe0f IN PROGRESS","Text Agent Core \u2705 COMPLETE (specs/001-nikita-text-agent)","Telegram Integration \u26a0\ufe0f 95% COMPLETE (specs/002-telegram-integration)","Database Layer \u2705 COMPLETE","Phase 3: Game Engine \u274c TODO (specs/003-006)","Phase 4: Voice Agent \u274c TODO (specs/007-voice-agent)"]},"deps":{"nikita/api/routes/tasks.py":["fastapi","nikita.config.settings","nikita.db.dependencies","nikita.db.database","nikita.db.repositories.pending_registration_repository"],"nikita/api/routes/telegram.py":["typing","fastapi","pydantic","nikita.agents.text.handler","nikita.db.database","nikita.db.dependencies","nikita.platforms.telegram.auth","nikita.platforms.telegram.bot","nikita.platforms.telegram.commands","nikita.platforms.telegram.delivery","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.models","nikita.platforms.telegram.rate_limiter"],"nikita/db/migrations/versions/20251128_0003_fix_message_embeddings.py":["collections.abc","alembic","sqlalchemy"],"nikita/db/migrations/versions/20251128_0004_rls_performance.py":["collections.abc","alembic"],"nikita/db/migrations/versions/20251128_0005_consolidate_policies.py":["collections.abc","alembic"],"nikita/db/migrations/versions/20251128_0006_extensions_pending_reg.py":["collections.abc","alembic","sqlalchemy"],"nikita/db/models/pending_registration.py":["datetime","datetime","sqlalchemy","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.base"],"nikita/db/repositories/pending_registration_repository.py":["datetime","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.ext.asyncio","nikita.db.models.base","nikita.db.models.pending_registration"],"nikita/platforms/telegram/auth.py":["re","typing","uuid","supabase","nikita.db.repositories.pending_registration_repository","nikita.db.repositories.user_repository"],"nikita/platforms/telegram/bot.py":["httpx","nikita.config.settings"],"nikita/platforms/telegram/commands.py":["nikita.db.repositories.user_repository","nikita.platforms.telegram.auth","nikita.platforms.telegram.bot"],"nikita/platforms/telegram/delivery.py":["asyncio","uuid","nikita.platforms.telegram.bot"],"nikita/platforms/telegram/message_handler.py":["typing","nikita.agents.text.handler","nikita.db.repositories.user_repository","nikita.platforms.telegram.bot","nikita.platforms.telegram.delivery","nikita.platforms.telegram.models","nikita.platforms.telegram.rate_limiter"],"nikita/platforms/telegram/models.py":["pydantic"],"nikita/platforms/telegram/rate_limiter.py":["dataclasses","datetime","typing","uuid","datetime"],"tests/api/routes/test_tasks.py":["pytest","unittest.mock","fastapi","fastapi.testclient","nikita.api.routes.tasks"],"tests/api/routes/test_telegram.py":["pytest","unittest.mock","fastapi","fastapi.testclient","httpx","nikita.platforms.telegram.bot","nikita.platforms.telegram.commands","nikita.platforms.telegram.message_handler","nikita.api.routes.telegram","nikita.api.routes.telegram"],"tests/db/integration/conftest.py":["os","dotenv","collections.abc","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","random"],"tests/db/integration/test_fulltext_search.py":["os","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.conversation_repository","nikita.db.repositories.user_repository"],"tests/db/integration/test_migrations.py":["os","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","os","pathlib","os","pathlib"],"tests/db/integration/test_repositories_integration.py":["os","datetime","decimal","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.models.game","nikita.db.models.user","nikita.db.repositories.conversation_repository","nikita.db.repositories.metrics_repository","nikita.db.repositories.score_history_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository"],"tests/db/integration/test_rls_policies.py":["os","uuid","pytest","pytest_asyncio","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.user_repository"],"tests/db/repositories/test_conversation_repository.py":["datetime","decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.repositories.conversation_repository"],"tests/db/repositories/test_metrics_repository.py":["decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.metrics_repository"],"tests/db/repositories/test_pending_registration_repository.py":["pytest","datetime","unittest.mock","nikita.db.models.pending_registration","nikita.db.repositories.pending_registration_repository"],"tests/db/repositories/test_score_history_repository.py":["datetime","decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.score_history_repository"],"tests/db/repositories/test_summary_repository.py":["datetime","decimal","typing","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.summary_repository"],"tests/db/repositories/test_vice_repository.py":["datetime","decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.vice_repository"],"tests/platforms/telegram/test_auth.py":["pytest","unittest.mock","nikita.platforms.telegram.auth","nikita.db.models.user","uuid"],"tests/platforms/telegram/test_bot.py":["pytest","unittest.mock","nikita.platforms.telegram.bot","httpx"],"tests/platforms/telegram/test_commands.py":["pytest","unittest.mock","nikita.platforms.telegram.commands","nikita.db.models.user","decimal","uuid"],"tests/platforms/telegram/test_delivery.py":["pytest","unittest.mock","uuid","nikita.platforms.telegram.delivery"],"tests/platforms/telegram/test_errors.py":["pytest","unittest.mock","uuid","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.models"],"tests/platforms/telegram/test_message_handler.py":["pytest","unittest.mock","uuid","datetime","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.models","nikita.platforms.telegram.rate_limiter","nikita.agents.text.handler","nikita.db.models.user"],"tests/platforms/telegram/test_rate_limiter.py":["pytest","datetime","uuid","unittest.mock","nikita.platforms.telegram.rate_limiter"],"tests/platforms/telegram/test_session_integration.py":["pytest","datetime","uuid","unittest.mock","nikita.platforms.telegram.message_handler","nikita.platforms.telegram.delivery","nikita.platforms.telegram.models","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler"],"nikita/agents/text/__init__.py":["typing","uuid","pydantic_ai","nikita.agents.text.deps","nikita.agents.text.agent","nikita.config.settings","nikita.db.models.user","nikita.memory.graphiti_client","nikita.memory.graphiti_client"],"nikita/agents/text/agent.py":["functools","typing","pydantic_ai","nikita.agents.text.deps","nikita.engine.constants","nikita.prompts.nikita_persona","nikita.db.models.user","nikita.memory.graphiti_client","nikita.agents.text.tools"],"nikita/agents/text/deps.py":["dataclasses","typing","nikita.config.settings","nikita.db.models.user","nikita.memory.graphiti_client"],"nikita/agents/text/facts.py":["dataclasses","typing"],"nikita/agents/text/handler.py":["logging","dataclasses","datetime","typing","uuid","nikita.agents.text.facts","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text","nikita.agents.text.agent"],"nikita/agents/text/skip.py":["random","typing"],"nikita/agents/text/timing.py":["random","typing"],"nikita/agents/text/tools.py":["typing","pydantic_ai","nikita.agents.text.deps"],"nikita/api/main.py":["contextlib","typing","fastapi","fastapi.middleware.cors","nikita.config.settings","sqlalchemy","nikita.db.database","nikita.platforms.telegram.bot","nikita.api.routes","nikita.api.routes","uvicorn"],"nikita/api/schemas/conversation.py":["datetime","decimal","typing","uuid","pydantic"],"nikita/api/schemas/game.py":["datetime","decimal","typing","uuid","pydantic"],"nikita/api/schemas/user.py":["datetime","decimal","uuid","pydantic"],"nikita/config/elevenlabs.py":["functools","pydantic","pydantic_settings"],"nikita/config/settings.py":["functools","typing","pydantic","pydantic_settings"],"nikita/db/database.py":["collections.abc","functools","sqlalchemy.ext.asyncio","sqlalchemy.pool","supabase","nikita.config.settings"],"nikita/db/dependencies.py":["collections.abc","typing","fastapi","sqlalchemy.ext.asyncio","nikita.db.database","nikita.db.repositories.conversation_repository","nikita.db.repositories.metrics_repository","nikita.db.repositories.pending_registration_repository","nikita.db.repositories.score_history_repository","nikita.db.repositories.summary_repository","nikita.db.repositories.user_repository","nikita.db.repositories.vice_repository"],"nikita/db/migrations/env.py":["asyncio","logging.config","alembic","sqlalchemy","sqlalchemy.engine","sqlalchemy.ext.asyncio","nikita.config.settings","nikita.db.models.base","nikita.db.models.conversation","nikita.db.models.game","nikita.db.models.user"],"nikita/db/migrations/versions/20251128_0001_initial_schema.py":["collections.abc","sqlalchemy","alembic","sqlalchemy.dialects"],"nikita/db/migrations/versions/20251128_0002_rls_policies.py":["collections.abc","alembic"],"nikita/db/models/base.py":["datetime","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm"],"nikita/db/models/conversation.py":["datetime","decimal","typing","uuid","pgvector.sqlalchemy","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.user"],"nikita/db/models/game.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.user"],"nikita/db/models/user.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.dialects.postgresql","sqlalchemy.orm","nikita.db.models.base","nikita.db.models.conversation","nikita.db.models.game"],"nikita/db/repositories/base.py":["typing","uuid","sqlalchemy.ext.asyncio","nikita.db.models.base"],"nikita/db/repositories/conversation_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.conversation","nikita.db.repositories.base","sqlalchemy","sqlalchemy.dialects.postgresql"],"nikita/db/repositories/metrics_repository.py":["decimal","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.base"],"nikita/db/repositories/score_history_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.base"],"nikita/db/repositories/summary_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.game","nikita.db.repositories.base"],"nikita/db/repositories/user_repository.py":["datetime","decimal","typing","uuid","sqlalchemy","sqlalchemy.ext.asyncio","sqlalchemy.orm","nikita.db.models.game","nikita.db.models.user","nikita.db.repositories.base"],"nikita/db/repositories/vice_repository.py":["datetime","decimal","uuid","sqlalchemy","sqlalchemy.ext.asyncio","nikita.db.models.user","nikita.db.repositories.base"],"nikita/db/transactions.py":["asyncio","functools","logging","collections.abc","enum","typing","sqlalchemy.exc","sqlalchemy.ext.asyncio"],"nikita/memory/graphiti_client.py":["datetime","typing","graphiti_core","graphiti_core.llm_client.anthropic_client","graphiti_core.llm_client.config","graphiti_core.embedder","graphiti_core.embedder.openai","graphiti_core.nodes","nikita.config.settings"],"tests/agents/text/test_agent.py":["os","pytest","unittest.mock","nikita.agents.text","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.deps","nikita.agents.text.agent","nikita.prompts.nikita_persona","nikita.agents.text.agent","nikita.engine.constants","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","inspect","nikita.agents.text.agent","nikita.agents.text.agent","inspect"],"tests/agents/text/test_chapter_behavior.py":["pytest","unittest.mock","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.engine.constants","nikita.agents.text.agent","re","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent","nikita.agents.text.agent"],"tests/agents/text/test_deps.py":["pytest","dataclasses","unittest.mock","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps","nikita.agents.text.deps"],"tests/agents/text/test_factory.py":["pytest","uuid","unittest.mock","nikita.agents.text","nikita.agents.text","inspect","nikita.agents.text","inspect","nikita.agents.text","nikita.agents.text.deps","nikita.agents.text","nikita.agents.text","nikita.agents.text"],"tests/agents/text/test_facts.py":["pytest","unittest.mock","nikita.agents.text","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","inspect","nikita.agents.text.facts","inspect","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts","nikita.agents.text.facts"],"tests/agents/text/test_handler.py":["pytest","datetime","uuid","unittest.mock","dataclasses","nikita.agents.text","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","inspect","nikita.agents.text.handler","inspect","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler"],"tests/agents/text/test_handler_facts.py":["pytest","datetime","uuid","unittest.mock","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.timing","nikita.agents.text.skip","nikita.agents.text.facts"],"tests/agents/text/test_handler_skip.py":["pytest","datetime","uuid","unittest.mock","logging","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.timing","nikita.agents.text.facts","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip","nikita.agents.text.handler","nikita.agents.text.skip"],"tests/agents/text/test_nikita_persona.py":["pytest","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona","nikita.prompts.nikita_persona"],"tests/agents/text/test_skip.py":["pytest","statistics","nikita.agents.text","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","inspect","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip","nikita.agents.text.skip"],"tests/agents/text/test_timing.py":["pytest","statistics","nikita.agents.text","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing","nikita.agents.text.timing"],"tests/agents/text/test_tools.py":["os","pytest","datetime","unittest.mock","nikita.agents.text","nikita.agents.text.tools","nikita.agents.text.agent","nikita.agents.text.tools","inspect","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text","nikita.agents.text.tools","nikita.agents.text.agent","nikita.agents.text.tools","inspect","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools","nikita.agents.text.tools"],"tests/db/repositories/test_base.py":["unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.models.base","sqlalchemy","sqlalchemy.dialects.postgresql","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base","nikita.db.repositories.base"],"tests/db/repositories/test_user_repository.py":["decimal","unittest.mock","uuid","pytest","sqlalchemy.ext.asyncio","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.models.game","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user","nikita.db.repositories.user_repository","nikita.db.models.user"]},"dir_purposes":{"docs-to-process":"Project documentation","nikita/api":"API endpoints and route handlers","nikita/db/migrations":"Database migration files","nikita/db/models":"Data models and database schemas","nikita/platforms/telegram":"Data models and schemas","specs/002-telegram-integration":"Test files and test utilities","specs":"Test specifications","specs/003-scoring-engine":"Test files and test utilities","specs/004-chapter-boss-system":"Test files and test utilities","specs/005-decay-system":"Test files and test utilities","specs/006-vice-personalization":"Test files and test utilities","specs/007-voice-agent":"Test files and test utilities","specs/008-player-portal":"Test files and test utilities","specs/009-database-infrastructure":"Test files and test utilities","specs/010-api-infrastructure":"API endpoints and route handlers","specs/011-background-tasks":"Test files and test utilities","specs/012-context-engineering":"Test files and test utilities","specs/013-configuration-system":"Configuration files and settings","specs/014-engagement-model":"Test files and test utilities","tests/api/routes":"Test files and test utilities","tests/db/integration":"Test files and test utilities","tests/db/repositories":"Test files and test utilities","tests/platforms/telegram":"Test files and test utilities","docs":"Project documentation","nikita/api/middleware":"Middleware functions and handlers","nikita/config":"Configuration files and settings","specs/001-nikita-text-agent":"Test files and test utilities","tests/agents/text":"Test files and test utilities"},"staleness":1764090204.257556}